

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/logo.png">
  <link rel="icon" href="/img/logo.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Dr.626">
  <meta name="keywords" content="">
  
    <meta name="description" content="ğŸ° PyTestæ˜¯Pythonçš„ä¸€ç§å•å…ƒæµ‹è¯•æ¡†æ¶ï¼Œä¸Pythonè‡ªå¸¦çš„UnitTestæµ‹è¯•æ¡†æ¶ç±»ä¼¼ï¼Œä½†ä½¿ç”¨æ¯”UnitTestæ›´ç®€æ´ï¼Œæ•ˆç‡æ›´é«˜ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="Pytest æµ‹è¯•æ¡†æ¶">
<meta property="og:url" content="https://stitch-top.github.io/2023/03/03/ce-shi-kuang-jia/tf02-pytest/tf01-pytest-ce-shi-kuang-jia/index.html">
<meta property="og:site_name" content="Dr.626">
<meta property="og:description" content="ğŸ° PyTestæ˜¯Pythonçš„ä¸€ç§å•å…ƒæµ‹è¯•æ¡†æ¶ï¼Œä¸Pythonè‡ªå¸¦çš„UnitTestæµ‹è¯•æ¡†æ¶ç±»ä¼¼ï¼Œä½†ä½¿ç”¨æ¯”UnitTestæ›´ç®€æ´ï¼Œæ•ˆç‡æ›´é«˜ã€‚">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://stitch-top.github.io/img/ThemeMap/5921739409.jpg">
<meta property="article:published_time" content="2023-03-03T15:03:27.000Z">
<meta property="article:modified_time" content="2024-07-19T08:54:02.471Z">
<meta property="article:author" content="Dr.626">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="Pytest">
<meta property="article:tag" content="Assertions">
<meta property="article:tag" content="Decorators">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://stitch-top.github.io/img/ThemeMap/5921739409.jpg">
  
  
  
  <title>Pytest æµ‹è¯•æ¡†æ¶ - Dr.626</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/my.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"stitch-top.github.io","root":"/","version":"1.9.0","typing":{"enable":true,"typeSpeed":70,"cursorChar":"|","loop":true,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":"âœ"},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"left","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":1},"lazyload":{"enable":true,"loading_img":"/img/load.gif","onlypost":true,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"Jg3BjUa3RtnEFSREy3wsmUR5-MdYXbMMI","app_key":"DwsEb5BeMxwdz0CEJ6MUBdu3","server_url":null,"path":"window.location.pathname","ignore_local":true}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>

  
  
<meta name="generator" content="Hexo 6.2.0"></head>


<body>
  
  

  <header>
    

<div class="header-inner" style="height: 100vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Dr.626</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                é¦–é¡µ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                å½’æ¡£
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                åˆ†ç±»
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                æ ‡ç­¾
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                å…³äº
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                å‹é“¾
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-code"></i>
                å®éªŒå®¤
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="/tagsnet">
                    <i class="iconfont icon-bookmark"></i>
                    æ–‡ç« å…³ç³»ç½‘
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/laboratory/plugin">
                    <i class="iconfont icon-bug"></i>
                    Hexoå°ç»„ä»¶
                  </a>
                
              </div>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/back-1.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Pytest æµ‹è¯•æ¡†æ¶"></span>
          
        </div>

        
          
  <div class="mt-3">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-author" aria-hidden="true"></i>
        Dr.626
      </span>
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-03-03 23:03" pubdate>
          2023å¹´3æœˆ3æ—¥ 23:03:27
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          60k å­—
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          502 åˆ†é’Ÿ
        
      </span>
    

    
    
      
        <span id="leancloud-page-views-container" class="post-meta" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="leancloud-page-views"></span> æ¬¡
        </span>
        
      
    
  </div>


        
      </div>

      
        <div class="scroll-down-bar">
          <i class="iconfont icon-arrowdown"></i>
        </div>
      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
  
  <!-- åŠ¨æ€çº¿æ¡èƒŒæ™¯
  <script type="text/javascript"
  color="0 0 255" opacity='1' zIndex="-2" count="200" src="../js/canvas-nest.js">
  </script> -->
  
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="padding-left: 2rem; margin-right: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ç›®å½•</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Pytest æµ‹è¯•æ¡†æ¶</h1>
            
            <div class="markdown-body">
              
              <p>ğŸ° PyTestæ˜¯Pythonçš„ä¸€ç§å•å…ƒæµ‹è¯•æ¡†æ¶ï¼Œä¸Pythonè‡ªå¸¦çš„UnitTestæµ‹è¯•æ¡†æ¶ç±»ä¼¼ï¼Œä½†ä½¿ç”¨æ¯”UnitTestæ›´ç®€æ´ï¼Œæ•ˆç‡æ›´é«˜ã€‚</p>
<span id="more"></span>



<h1 id="1-è§„åˆ™è¯´æ˜"><a href="#1-è§„åˆ™è¯´æ˜" class="headerlink" title="1 è§„åˆ™è¯´æ˜"></a>1 è§„åˆ™è¯´æ˜</h1><ul>
<li>è§„åˆ™è¯´æ˜<ul>
<li>PyTestæ˜¯Python2é»˜è®¤è‡ªå¸¦çš„ï¼Œåœ¨Python3ä¸­åˆ™æ˜¯ç‹¬ç«‹çš„ï¼Œéœ€ä½¿ç”¨<code>pip install pytest</code>è¿›è¡Œå®‰è£…ã€‚</li>
<li>è¿è¡Œè§„åˆ™<ul>
<li>æŸ¥æ‰¾å½“å‰ç›®å½•åŠå­ç›®å½•ä¸­<code>test_*.py</code>æˆ–<code>*_test.py</code>æ–‡ä»¶ã€‚</li>
<li>æ‰¾åˆ°æ‰€æœ‰çš„æ–‡ä»¶åï¼Œæ‰§è¡Œæ–‡ä»¶ä¸­ä»¥<code>test</code>å¼€å¤´çš„æ‰€æœ‰å‡½æ•°ã€‚</li>
</ul>
</li>
<li>ç”¨ä¾‹è®¾è®¡è§„åˆ™<ul>
<li>æµ‹è¯•æ–‡ä»¶ä»¥<code>test_</code>å¼€å¤´ï¼Œæˆ–ä»¥<code>_test</code>ç»“å°¾ï¼Œæµ‹è¯•ç±»ä»¥<code>Test</code>å¼€å¤´ï¼Œå¹¶ä¸”ä¸èƒ½å¸¦æœ‰<code>init</code>æ–¹æ³•ã€‚</li>
<li>æµ‹è¯•å‡½æ•°å’Œæ–¹æ³•ä»¥<code>test_</code>å¼€å¤´ï¼Œæ–­è¨€ç”¨<code>assert</code>ï¼Œæ‰€æœ‰çš„packageåŒ…å¿…é¡»å¸¦<code>__init__.py</code>æ–‡ä»¶ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Powershell">pip install pytest                                       <span class="hljs-comment"># å®‰è£…PyTest</span><br>pip show pytest                                          <span class="hljs-comment"># æŸ¥çœ‹PyTestç‰ˆæœ¬çš„è¯¦ç»†ä¿¡æ¯</span><br>pytest <span class="hljs-literal">--version</span>                                         <span class="hljs-comment"># ç®€å•æŸ¥çœ‹PyTestçš„å®‰è£…ç‰ˆæœ¬</span><br>pytest <span class="hljs-literal">-h</span>                                                <span class="hljs-comment"># PyTestæŸ¥çœ‹å¸®åŠ©</span><br>pytest <span class="hljs-literal">--help</span>                                            <span class="hljs-comment"># PyTestæŸ¥çœ‹å¸®åŠ©</span><br></code></pre></td></tr></table></figure>



<h2 id="1-1-ç”¨ä¾‹æ‰§è¡Œè§„åˆ™"><a href="#1-1-ç”¨ä¾‹æ‰§è¡Œè§„åˆ™" class="headerlink" title="1-1 ç”¨ä¾‹æ‰§è¡Œè§„åˆ™"></a>1-1 ç”¨ä¾‹æ‰§è¡Œè§„åˆ™</h2><ul>
<li>ç”¨ä¾‹æ‰§è¡Œè§„åˆ™<ul>
<li>æ‰§è¡ŒæŸä¸ªç›®å½•ä¸‹æ‰€æœ‰çš„ç”¨ä¾‹ï¼š<code>pytest FolderName/</code>ã€‚</li>
<li>æ‰§è¡ŒæŸä¸ªæ–‡ä»¶ä¸­çš„æ‰€æœ‰ç”¨ä¾‹ï¼š<code>pytest FileName.py</code>ã€‚</li>
<li>é‡åˆ°é”™è¯¯æ—¶ï¼Œåœæ­¢æ­£åœ¨æ‰§è¡Œçš„æµ‹è¯•ç”¨ä¾‹ï¼š<code>pytest -x FileName.py</code>ã€‚</li>
<li>ç”¨ä¾‹é”™è¯¯ä¸ªæ•°è¾¾åˆ°æŒ‡å®šæ•°é‡æ—¶ï¼Œåœæ­¢æµ‹è¯•ï¼š<code>pytest --maxfail=num</code>ã€‚</li>
<li>æŒ‰ç…§å…³é”®å­—è¿›è¡Œæ¨¡ç³ŠåŒ¹é…ï¼ŒåŒ¹é…åç§°ä¸åŒºåˆ†å¤§å°å†™ï¼š<code>pytest -k &quot;xxx&quot;</code>ã€‚</li>
<li>ç®€å•ç»“æœï¼š<code>pytest -q FileName.py</code>ï¼Œ<code>--quiet decrease verbosity</code>ã€‚</li>
<li>æŒ‰èŠ‚ç‚¹è¿è¡Œ<ul>
<li>æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹éƒ½åˆ†é…äº†å”¯ä¸€çš„nodeidï¼Œnodeidç”±æ¨¡å—åå’Œè¯´æ˜ç¬¦ç»„æˆã€‚</li>
<li>æ¨¡å—åå’Œè¯´æ˜ç¬¦ä»¥<code>::</code>é—´éš”ï¼Œè¯´æ˜ç¬¦å¯ä»¥åŒ…å«ç±»åã€å‡½æ•°åå’Œæ ‡è®°å‚æ•°ã€‚</li>
</ul>
</li>
<li>æ ‡è®°è¡¨è¾¾å¼è¿è¡Œç”¨<code>@pytest.mark.slow</code>ä¿®é¥°å™¨ä¿®é¥°çš„æ‰€æœ‰ç”¨ä¾‹ï¼š<code>pytest -m slow</code>ã€‚</li>
</ul>
</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs Powershell">pytest                                                  <span class="hljs-comment"># æ‰§è¡ŒPyTestç”¨ä¾‹çš„å‘½ä»¤ï¼Œæ¨èä½¿ç”¨</span><br>py.test                                                 <span class="hljs-comment"># æ‰§è¡Œè¯¥æ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„ç”¨ä¾‹</span><br>python <span class="hljs-literal">-m</span> pytest<br><br>pytest <span class="hljs-literal">-k</span> <span class="hljs-string">&quot;ClassName&quot;</span>                                   <span class="hljs-comment"># è¿è¡ŒClassNameç±»ä¸‹çš„æ‰€æœ‰æ–¹æ³•</span><br>pytest <span class="hljs-literal">-k</span> <span class="hljs-string">&quot;MethodName&quot;</span>                                  <span class="hljs-comment"># è¿è¡Œæ‰€æœ‰åä¸ºMethodNameçš„æ–¹æ³•</span><br>pytest <span class="hljs-literal">-k</span> <span class="hljs-string">&quot;ClassName and not MethodName&quot;</span>                <span class="hljs-comment"># è¿è¡ŒClassNameç±»ä¸‹çš„é™¤MethodNameå¤–çš„æ‰€æœ‰æ–¹æ³•</span><br><br>pytest FileName.py::FunctionName                        <span class="hljs-comment"># å‡½æ•°å</span><br>pytest FileName.py::ClassName::FunctionName             <span class="hljs-comment"># ç±»å+å‡½æ•°å</span><br>pytest FileName.py::ClassName::FunctionName[<span class="hljs-type">num1</span>-<span class="hljs-type">num2</span>]  <span class="hljs-comment"># ç±»å+å‡½æ•°å+æ ‡è®°å‚æ•°</span><br>pytest FileName.py <span class="hljs-literal">-vv</span>                                  <span class="hljs-comment"># FileName.pyæ–‡ä»¶ä¸‹çš„æ‰€æœ‰ç”¨ä¾‹èŠ‚ç‚¹æ‰§è¡Œç»“æœ</span><br></code></pre></td></tr></table></figure>



<h2 id="1-2-PyCharmè¿è¡Œæ–¹å¼"><a href="#1-2-PyCharmè¿è¡Œæ–¹å¼" class="headerlink" title="1-2 PyCharmè¿è¡Œæ–¹å¼"></a>1-2 PyCharmè¿è¡Œæ–¹å¼</h2><ul>
<li>PyCharmè¿è¡Œæ–¹å¼<ul>
<li>é»˜è®¤ä»¥Autodetectå½¢å¼è¿è¡Œï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹PyCharmè®¾ç½®æ¥æ”¹å˜è¿è¡Œæ–¹å¼ã€‚</li>
<li>Fileâ€”&gt;Settingâ€”&gt;Toolsâ€”&gt;Python Integrated Toolsâ€”&gt;Default test runnerã€‚</li>
<li>PyTestå…¼å®¹UnitTestï¼Œç”¨UnitTestæ¡†æ¶ç¼–å†™çš„æµ‹è¯•ç”¨ä¾‹ä¹Ÿèƒ½ç”¨PyTestæ¡†æ¶è¿è¡Œã€‚</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_node.py</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_one</span>():<br>    <span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">TestNode</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_one</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">pass</span><br>    <br><span class="hljs-meta">    @pytest.mark.parametrize(<span class="hljs-params"><span class="hljs-string">&quot;x, y&quot;</span>,[(<span class="hljs-params"><span class="hljs-number">1</span>, <span class="hljs-number">3</span></span>), (<span class="hljs-params"><span class="hljs-number">3</span>, <span class="hljs-number">5</span></span>)]</span>)</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_two</span>(<span class="hljs-params">self, x, y</span>):<br>        <span class="hljs-keyword">assert</span> x + <span class="hljs-number">2</span> == y<br><br><span class="hljs-comment"># pytest test_node.py::test_one                         # å‡½æ•°å</span><br><span class="hljs-comment"># pytest test_node.py::TestNode::test_one               # ç±»å+å‡½æ•°å</span><br><span class="hljs-comment"># pytest test_node.py::TestNode::test_two[1-3]          # ç±»å+å‡½æ•°å+æ ‡è®°å‚æ•°</span><br><span class="hljs-comment"># pytest test_node.py::TestNode::test_two[3-5]          # ç±»å+å‡½æ•°å+æ ‡è®°å‚æ•°</span><br><span class="hljs-comment"># pytest test_node.py -vv                               # è¯¥æ–‡ä»¶ä¸‹çš„æ‰€æœ‰ç”¨ä¾‹èŠ‚ç‚¹æ‰§è¡Œç»“æœ</span><br></code></pre></td></tr></table></figure>



<h1 id="2-è·³è¿‡ç”¨ä¾‹"><a href="#2-è·³è¿‡ç”¨ä¾‹" class="headerlink" title="2 è·³è¿‡ç”¨ä¾‹"></a>2 è·³è¿‡ç”¨ä¾‹</h1><ul>
<li>è·³è¿‡ç”¨ä¾‹<ul>
<li>è£…é¥°å™¨<code>@pytest.mark.skip()</code>ï¼šæ ‡è®°æµ‹è¯•ç”¨ä¾‹ä¸ºè·³è¿‡çŠ¶æ€ï¼Œå¹¶æä¾›è·³è¿‡åŸå› ã€‚</li>
<li>è£…é¥°å™¨<code>@pytest.mark.skipif()</code>ï¼šå½“æŒ‡å®šçš„æ¡ä»¶æ»¡è¶³æ—¶ï¼Œå³ä¸ºTrueï¼Œè·³è¿‡æµ‹è¯•ç”¨ä¾‹å¹¶æä¾›è·³è¿‡åŸå› ã€‚</li>
<li>è£…é¥°å™¨<code>@pytest.mark.xfail()</code>ï¼šæ ‡è®°æµ‹è¯•ç”¨ä¾‹ä¸ºé¢„è®¡å¤±è´¥ï¼Œå®é™…è¿è¡Œæ—¶ä¼šè¢«å¿½ç•¥ï¼Œä¸å½±å“æµ‹è¯•ç»“æœã€‚</li>
<li>å‡½æ•°<code>pytest.skip()</code>ï¼šåœ¨æµ‹è¯•ç”¨ä¾‹æ‰§è¡ŒæœŸé—´ï¼Œå¼ºåˆ¶è·³è¿‡å½“å‰æµ‹è¯•ç”¨ä¾‹å¹¶æä¾›è·³è¿‡åŸå› ï¼Œç±»ä¼¼äºbreakè·³å‡ºå¾ªç¯ã€‚</li>
<li>å‡½æ•°<code>pytest.xfail()</code>ï¼šæ ‡è®°å·²çŸ¥å­˜åœ¨é—®é¢˜ä½†å°šæœªä¿®å¤çš„ç”¨ä¾‹ï¼Œä¾èµ–äºè¢«æ ‡è®°æˆxfailç”¨ä¾‹çš„å…¶ä»–ç”¨ä¾‹ä¹Ÿä¼šè·³è¿‡ã€‚</li>
<li>è‡ªå®šä¹‰è·³è¿‡æ ‡è¯†<ul>
<li>å°†<code>pytest.mark.skip()</code>æˆ–<code>pytest.mark.skipif()</code>èµ‹å€¼ç»™ä¸€ä¸ªè‡ªå®šä¹‰æ ‡è¯†å˜é‡ï¼Œä¸åŒæ¨¡å—ä¹‹é—´è¿›è¡Œå…±äº«ã€‚</li>
<li>è‹¥æœ‰å¤šä¸ªæ¨¡å—çš„ç”¨ä¾‹éœ€è¦ç”¨åˆ°åŒä¸ªæ ‡è¯†å˜é‡ï¼Œå¯å•ç‹¬æ–‡ä»¶ç®¡ç†é€šç”¨çš„æ ‡è¯†å˜é‡ï¼Œé€‚ç”¨äºæ•´ä¸ªæµ‹è¯•ç”¨ä¾‹é›†ã€‚</li>
</ul>
</li>
<li>å‡½æ•°<code>pytest.importorskip()</code>ï¼šæŸç”¨ä¾‹ä¾èµ–äºç‰¹å®šæ¨¡å—ï¼Œä½†å½“å‰ç¯å¢ƒä¸­è¯¥æ¨¡å—ä¸å¯å¯¼å…¥æ—¶ä½¿ç”¨è¯¥å‡½æ•°è·³è¿‡ç”¨ä¾‹ã€‚</li>
</ul>
</li>
</ul>
<h2 id="2-1-pytest-mark-skip"><a href="#2-1-pytest-mark-skip" class="headerlink" title="2-1 @pytest.mark.skip()"></a>2-1 @pytest.mark.skip()</h2><ul>
<li>@pytest.mark.skip()<ul>
<li>ç”¨åœ¨è·³è¿‡å•ä¸ªç”¨ä¾‹(å‡½æ•°ç”¨ä¾‹)ã€ç±»ç”¨ä¾‹ã€ç±»æ–¹æ³•ç”¨ä¾‹ä¸Šï¼Œå¦‚æœåŠ åœ¨ç±»ç”¨ä¾‹ä¸Šï¼Œç±»é‡Œé¢çš„æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹éƒ½ä¸ä¼šè¢«æ‰§è¡Œã€‚</li>
<li>å¯é€‰å‚æ•°reasonï¼Œä»£è¡¨è·³è¿‡åŸå› ï¼Œä¼šåœ¨æ‰§è¡Œç»“æœä¸­æ‰“å°ï¼Œå¯é€‰å‚æ•°conditionï¼Œç”¨äºå®šä¹‰åœ¨ç‰¹å®šæ¡ä»¶ä¸‹è·³è¿‡æµ‹è¯•ç”¨ä¾‹ã€‚</li>
<li><code>pytestmark=pytest.mark.skip()</code>ï¼Œpytestmarkæ˜¯pytestä¸­ä¸€ä¸ªç‰¹æ®Šçš„ä¸å¯æ›´æ”¹å˜é‡åï¼Œç”¨äºè®¾ç½®æ¨¡å—çº§åˆ«çš„æ ‡è®°ã€‚</li>
<li>å¦‚æœæƒ³åœ¨æ¨¡å—çº§åˆ«è·³è¿‡æµ‹è¯•ç”¨ä¾‹ï¼Œä½†ä¸ä½¿ç”¨pytestmarkï¼Œåˆ™å¯ä»¥ä½¿ç”¨å…¶ä»–å˜é‡åï¼Œæ³¨æ„éœ€è¦ä½¿ç”¨è£…é¥°å™¨æ¥è¿›è¡Œæ ‡è®°ã€‚</li>
</ul>
</li>
</ul>
<h3 id="1-test-mark-skip-py"><a href="#1-test-mark-skip-py" class="headerlink" title="(1) test_mark_skip.py"></a>(1) test_mark_skip.py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_mark_skip.py</span><br><br><br><span class="hljs-meta">@pytest.mark.skip(<span class="hljs-params">reason=<span class="hljs-string">&quot;è·³è¿‡å•ä¸ªæµ‹è¯•ç”¨ä¾‹&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_a</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---test case a---&quot;</span>)<br><br><br><span class="hljs-meta">@pytest.mark.skip(<span class="hljs-params">reason=<span class="hljs-string">&quot;è·³è¿‡å•ä¸ªç±»çš„ç”¨ä¾‹&quot;</span></span>)</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">TestCaseA</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_b</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---test case b---&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_c</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---test case c---&quot;</span>)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">TestCaseB</span>:<br><span class="hljs-meta">    @pytest.mark.skip(<span class="hljs-params">reason=<span class="hljs-string">&quot;è·³è¿‡ç±»çš„æ–¹æ³•ç”¨ä¾‹&quot;</span></span>)</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_d</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---test case d---&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_e</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---test case e---&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_mark_skip.py&quot;</span>])<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">pytest test_mark_skip.py                                # test_mark_skip.py ssss.</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 5 items</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_mark_skip.py::test_a                               [ 20%]</span><br><span class="hljs-string">SKIPPED (è·³è¿‡å•ä¸ªæµ‹è¯•ç”¨ä¾‹)</span><br><span class="hljs-string">Skipped: è·³è¿‡å•ä¸ªæµ‹è¯•ç”¨ä¾‹</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_mark_skip.py::TestCaseA::test_b                    [ 40%]</span><br><span class="hljs-string">SKIPPED (è·³è¿‡å•ä¸ªç±»çš„ç”¨ä¾‹)</span><br><span class="hljs-string">Skipped: è·³è¿‡å•ä¸ªç±»çš„ç”¨ä¾‹</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_mark_skip.py::TestCaseA::test_c                    [ 60%]</span><br><span class="hljs-string">SKIPPED (è·³è¿‡å•ä¸ªç±»çš„ç”¨ä¾‹)</span><br><span class="hljs-string">Skipped: è·³è¿‡å•ä¸ªç±»çš„ç”¨ä¾‹</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_mark_skip.py::TestCaseB::test_d                    [ 80%]</span><br><span class="hljs-string">SKIPPED (è·³è¿‡ç±»çš„æ–¹æ³•ç”¨ä¾‹)</span><br><span class="hljs-string">Skipped: è·³è¿‡ç±»çš„æ–¹æ³•ç”¨ä¾‹</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_mark_skip.py::TestCaseB::test_e </span><br><span class="hljs-string">PASSED                                                  [100%]---test case e---</span><br><span class="hljs-string">======================== 1 passed, 4 skipped in 0.16s =========================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h3 id="2-test-skip-module-py"><a href="#2-test-skip-module-py" class="headerlink" title="(2) test_skip_module.py*"></a>(2) test_skip_module.py*</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_skip_module.py</span><br><br>pytestmark = pytest.mark.skip(reason=<span class="hljs-string">&quot;è·³è¿‡å½“å‰æ¨¡å—&quot;</span>)<br><span class="hljs-comment"># skip_module = pytest.mark.skip(reason=&quot;è·³è¿‡å½“å‰æ¨¡å—&quot;)</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_a</span>():                                           <span class="hljs-comment"># å¥‡æ€ªï¼Œpytestmarkè¿™é‡Œä¹Ÿè·³è¿‡äº†</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case a---&quot;</span>)                           <span class="hljs-comment"># skip_moduleåªè·³è¿‡TestCase</span><br><br><br><span class="hljs-comment"># @skip_module</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">TestCase</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_b</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case b---&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_c</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case c---&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_skip_module.py&quot;</span>])<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">pytest test_skip_module.py                              # test_skip_module.py sss</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 3 items</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_skip_module.py::test_a                             [ 33%]</span><br><span class="hljs-string">SKIPPED (è·³è¿‡å½“å‰æ¨¡å—)</span><br><span class="hljs-string">Skipped: è·³è¿‡å½“å‰æ¨¡å—</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_skip_module.py::TestCase::test_b                   [ 66%]</span><br><span class="hljs-string">SKIPPED (è·³è¿‡å½“å‰æ¨¡å—)</span><br><span class="hljs-string">Skipped: è·³è¿‡å½“å‰æ¨¡å—</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_skip_module.py::TestCase::test_c                   [100%]</span><br><span class="hljs-string">SKIPPED (è·³è¿‡å½“å‰æ¨¡å—)</span><br><span class="hljs-string">Skipped: è·³è¿‡å½“å‰æ¨¡å—</span><br><span class="hljs-string">============================= 3 skipped in 0.05s ==============================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h2 id="2-2-pytest-mark-skipif"><a href="#2-2-pytest-mark-skipif" class="headerlink" title="2-2 @pytest.mark.skipif()"></a>2-2 @pytest.mark.skipif()</h2><ul>
<li>@pytest.mark.skipif()<ul>
<li>å¯é€‰å‚æ•°reasonï¼Œç”¨äºæ·»åŠ å…³äºè·³è¿‡æµ‹è¯•ç”¨ä¾‹çš„åŸå› è¯´æ˜ã€‚</li>
<li>å¯é€‰å‚æ•°conditionï¼Œå®šä¹‰ç‰¹å®šæ¡ä»¶ä¸‹æ˜¯å¦è·³è¿‡ç”¨ä¾‹çš„è¡¨è¾¾å¼ã€‚</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_mark_skipif.py</span><br><br><br><span class="hljs-meta">@pytest.mark.skipif(<span class="hljs-params">sys.version_info &lt; (<span class="hljs-params"><span class="hljs-number">3</span>, <span class="hljs-number">10</span></span>), reason=<span class="hljs-string">&quot;pythonç‰ˆæœ¬å°äº3.10&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_a</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case a---&quot;</span>)<br><br><br><span class="hljs-meta">@pytest.mark.skipif(<span class="hljs-params">condition=sys.version_info &lt; (<span class="hljs-params"><span class="hljs-number">3</span>, <span class="hljs-number">10</span></span>), reason=<span class="hljs-string">&quot;pythonç‰ˆæœ¬å°äº3.10&quot;</span></span>)</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">TestCaseA</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_b</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case b---&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_c</span>(<span class="hljs-params">self, </span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case c---&quot;</span>)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">TestCaseB</span>:<br><span class="hljs-meta">    @pytest.mark.skipif(<span class="hljs-params">condition=sys.version_info &lt; (<span class="hljs-params"><span class="hljs-number">3</span>, <span class="hljs-number">10</span></span>), reason=<span class="hljs-string">&quot;pythonç‰ˆæœ¬å°äº3.10&quot;</span></span>)</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_d</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case d---&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_e</span>(<span class="hljs-params">self, </span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case e---&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_mark_skipif.py&quot;</span>])<br><br><span class="hljs-string">&quot;&quot;&quot;                         ï¼ï¼ï¼è¿™é‡Œç”¨çš„Python3.9ç‰ˆæœ¬</span><br><span class="hljs-string">pytest test_mark_skipif.py                              # test_mark_skipif.py ssss.</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 5 items</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_mark_skipif.py::test_a                             [ 20%]</span><br><span class="hljs-string">SKIPPED (pythonç‰ˆæœ¬å°äº3.10)</span><br><span class="hljs-string">Skipped: pythonç‰ˆæœ¬å°äº3.10</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_mark_skipif.py::TestCaseA::test_b                  [ 40%]</span><br><span class="hljs-string">SKIPPED (pythonç‰ˆæœ¬å°äº3.10)</span><br><span class="hljs-string">Skipped: pythonç‰ˆæœ¬å°äº3.10</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_mark_skipif.py::TestCaseA::test_c                  [ 60%]</span><br><span class="hljs-string">SKIPPED (pythonç‰ˆæœ¬å°äº3.10)</span><br><span class="hljs-string">Skipped: pythonç‰ˆæœ¬å°äº3.10</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_mark_skipif.py::TestCaseB::test_d                  [ 80%]</span><br><span class="hljs-string">SKIPPED (pythonç‰ˆæœ¬å°äº3.10)</span><br><span class="hljs-string">Skipped: pythonç‰ˆæœ¬å°äº3.10</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_mark_skipif.py::TestCaseB::test_e </span><br><span class="hljs-string">PASSED                                                  [100%]---use case e---</span><br><span class="hljs-string">======================== 1 passed, 4 skipped in 0.06s =========================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h2 id="2-3-pytest-mark-xfail"><a href="#2-3-pytest-mark-xfail" class="headerlink" title="2-3 @pytest.mark.xfail()"></a>2-3 @pytest.mark.xfail()</h2><ul>
<li>@pytest.mark.xfail()<ul>
<li>æ ‡è®°æµ‹è¯•ç”¨ä¾‹ä¸ºé¢„æœŸå¤±è´¥çŠ¶æ€ï¼Œé¢„æœŸå¤±è´¥å³è¯¥ç”¨ä¾‹çš„ç›®æ ‡æ˜¯å¤±è´¥çš„ã€‚</li>
<li>å‚æ•°runç”¨äºæ§åˆ¶åœ¨ç‰¹å®šçš„æ¡ä»¶ä¸‹ï¼Œæ˜¯å¦æ‰§è¡Œæ ‡è®°ä¸ºxfailçš„æµ‹è¯•ç”¨ä¾‹ã€‚</li>
<li>å‚æ•°reasonç”¨äºæä¾›é¢„æœŸå¤±è´¥çš„åŸå› è¯´æ˜ï¼Œå‚æ•°raisesåˆ™æŒ‡å®šé¢„æœŸæŠ›å‡ºçš„å¼‚å¸¸ç±»å‹ã€‚</li>
<li>å‚æ•°strictç”¨äºæ§åˆ¶æµ‹è¯•ç”¨ä¾‹åœ¨é¢„æœŸå¤±è´¥æ—¶ï¼Œæ˜¯å¦ä»¥å¤±è´¥çš„æ ‡è®°æ˜¾ç¤ºåœ¨æµ‹è¯•æŠ¥å‘Šä¸­ã€‚</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest  <span class="hljs-comment"># test_mark_xfail.py</span><br><br><br><span class="hljs-meta">@pytest.mark.xfail(<span class="hljs-params">reason=<span class="hljs-string">&quot;æµ‹è¯•ç”¨ä¾‹é¢„æœŸå¤±è´¥&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_a</span>():<br>    <span class="hljs-keyword">assert</span> <span class="hljs-number">2</span> + <span class="hljs-number">2</span> == <span class="hljs-number">5</span><br><br><br><span class="hljs-meta">@pytest.mark.xfail(<span class="hljs-params">raises=ZeroDivisionError</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_b</span>():<br>    <span class="hljs-keyword">assert</span> <span class="hljs-number">10</span> / <span class="hljs-number">0</span> == <span class="hljs-number">5</span><br><br><br><span class="hljs-meta">@pytest.mark.xfail(<span class="hljs-params">run=<span class="hljs-literal">False</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_c</span>():<br>    <span class="hljs-keyword">assert</span> <span class="hljs-number">2</span> + <span class="hljs-number">1</span> == <span class="hljs-number">5</span><br><br><br><span class="hljs-meta">@pytest.mark.xfail(<span class="hljs-params">strict=<span class="hljs-literal">True</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_d</span>():<br>    <span class="hljs-keyword">assert</span> <span class="hljs-literal">False</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_mark_xfail.py&quot;</span>])<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">pytest test_mark_xfail.py                              # test_mark_xfail.py xxxx</span><br><span class="hljs-string">============================= test session starts ============================</span><br><span class="hljs-string">collecting ... collected 4 items</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_mark_xfail.py::test_a                             [ 25%]</span><br><span class="hljs-string">XFAIL (æµ‹è¯•ç”¨ä¾‹é¢„æœŸå¤±è´¥)</span><br><span class="hljs-string">@pytest.mark.xfail(reason=&quot;æµ‹è¯•ç”¨ä¾‹é¢„æœŸå¤±è´¥&quot;)</span><br><span class="hljs-string">    def test_a():</span><br><span class="hljs-string">&gt;       assert 2 + 2 == 5</span><br><span class="hljs-string">E       assert 4 == 5</span><br><span class="hljs-string">E         +4</span><br><span class="hljs-string">E         -5</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_mark_xfail.py:6: AssertionError</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_mark_xfail.py::test_b </span><br><span class="hljs-string">XFAIL                                                  [ 50%]</span><br><span class="hljs-string">@pytest.mark.xfail(raises=ZeroDivisionError)</span><br><span class="hljs-string">    def test_b():</span><br><span class="hljs-string">&gt;       assert 10 / 0 == 5</span><br><span class="hljs-string">E       ZeroDivisionError: division by zero</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_mark_xfail.py:11: ZeroDivisionError</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_mark_xfail.py::test_c </span><br><span class="hljs-string">XFAIL ([NOTRUN] )                                      [ 75%]</span><br><span class="hljs-string">cls = &lt;class &#x27;_pytest.runner.CallInfo&#x27;&gt;</span><br><span class="hljs-string">func = &lt;function call_runtest_hook.&lt;locals&gt;.&lt;lambda&gt; at 0x0000015C2E6DA5E0&gt;</span><br><span class="hljs-string">when = &#x27;setup&#x27;</span><br><span class="hljs-string">reraise = (&lt;class &#x27;_pytest.outcomes.Exit&#x27;&gt;, &lt;class &#x27;KeyboardInterrupt&#x27;&gt;)</span><br><span class="hljs-string"></span><br><span class="hljs-string">    @classmethod</span><br><span class="hljs-string">    def from_call(</span><br><span class="hljs-string">        cls,</span><br><span class="hljs-string">        func: &quot;Callable[[], TResult]&quot;,</span><br><span class="hljs-string">        when: &quot;Literal[&#x27;collect&#x27;, &#x27;setup&#x27;, &#x27;call&#x27;, &#x27;teardown&#x27;]&quot;,</span><br><span class="hljs-string">        reraise: Optional[</span><br><span class="hljs-string">            Union[Type[BaseException], Tuple[Type[BaseException], ...]]</span><br><span class="hljs-string">        ] = None,</span><br><span class="hljs-string">    ) -&gt; &quot;CallInfo[TResult]&quot;:</span><br><span class="hljs-string">        excinfo = None</span><br><span class="hljs-string">        start = timing.time()</span><br><span class="hljs-string">        precise_start = timing.perf_counter()</span><br><span class="hljs-string">        try:</span><br><span class="hljs-string">&gt;           result: Optional[TResult] = func()</span><br><span class="hljs-string"></span><br><span class="hljs-string">D:\A3\lib\site-packages\_pytest\runner.py:311: </span><br><span class="hljs-string">_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ </span><br><span class="hljs-string">D:\A3\lib\site-packages\_pytest\runner.py:255: in &lt;lambda&gt;</span><br><span class="hljs-string">    lambda: ihook(item=item, **kwds), when=when, reraise=reraise</span><br><span class="hljs-string">D:\A3\lib\site-packages\pluggy\hooks.py:286: in __call__</span><br><span class="hljs-string">    return self._hookexec(self, self.get_hookimpls(), kwargs)</span><br><span class="hljs-string">D:\A3\lib\site-packages\pluggy\manager.py:93: in _hookexec</span><br><span class="hljs-string">    return self._inner_hookexec(hook, methods, kwargs)</span><br><span class="hljs-string">D:\A3\lib\site-packages\pluggy\manager.py:84: in &lt;lambda&gt;</span><br><span class="hljs-string">    self._inner_hookexec = lambda hook, methods, kwargs: hook.multicall(</span><br><span class="hljs-string">_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ </span><br><span class="hljs-string"></span><br><span class="hljs-string">item = &lt;Function test_c&gt;</span><br><span class="hljs-string"></span><br><span class="hljs-string">    @hookimpl(tryfirst=True)</span><br><span class="hljs-string">    def pytest_runtest_setup(item: Item) -&gt; None:</span><br><span class="hljs-string">        skipped = evaluate_skip_marks(item)</span><br><span class="hljs-string">        item._store[skipped_by_mark_key] = skipped is not None</span><br><span class="hljs-string">        if skipped:</span><br><span class="hljs-string">            skip(skipped.reason)</span><br><span class="hljs-string"></span><br><span class="hljs-string">        item._store[xfailed_key] = xfailed = evaluate_xfail_marks(item)</span><br><span class="hljs-string">        if xfailed and not item.config.option.runxfail and not xfailed.run:</span><br><span class="hljs-string">&gt;           xfail(&quot;[NOTRUN] &quot; + xfailed.reason)</span><br><span class="hljs-string">E           _pytest.outcomes.XFailed: [NOTRUN]</span><br><span class="hljs-string"></span><br><span class="hljs-string">D:\A3\lib\site-packages\_pytest\skipping.py:249: XFailed</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_mark_xfail.py::test_d </span><br><span class="hljs-string">XFAIL                                                  [100%]</span><br><span class="hljs-string">@pytest.mark.xfail(strict=True)</span><br><span class="hljs-string">    def test_d():</span><br><span class="hljs-string">&gt;       assert False</span><br><span class="hljs-string">E       assert False</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_mark_xfail.py:21: AssertionError</span><br><span class="hljs-string">============================= 4 xfailed in 0.47s =============================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h2 id="2-4-pytest-skip"><a href="#2-4-pytest-skip" class="headerlink" title="2-4 pytest.skip()"></a>2-4 pytest.skip()</h2><ul>
<li>pytest.skip()<ul>
<li>ç”¨äºè·³è¿‡ç‰¹å®šæµ‹è¯•ç”¨ä¾‹çš„æ‰§è¡Œï¼Œå¯ä»¥åœ¨æµ‹è¯•å‡½æ•°ã€æ–¹æ³•æˆ–ç±»ä¸Šä½¿ç”¨ã€‚</li>
<li>é€šå¸¸ç”¨äºæŸåŠŸèƒ½å°šæœªå®ç°ï¼Œä½†å·²ç¼–å†™äº†æµ‹è¯•ç”¨ä¾‹ï¼Œæš‚æ—¶è·³è¿‡è¿™äº›ç”¨ä¾‹çš„æƒ…å†µã€‚</li>
<li>æˆ–è€…æµ‹è¯•ç”¨ä¾‹ä¾èµ–äºæŸäº›æ¡ä»¶ï¼Œä½†è¿™äº›æ¡ä»¶å½“å‰ä¸æ»¡è¶³ï¼Œå› æ­¤è·³è¿‡è¿™äº›ç”¨ä¾‹ã€‚</li>
</ul>
</li>
</ul>
<h3 id="1-test-skip-msg-py"><a href="#1-test-skip-msg-py" class="headerlink" title="(1) test_skip_msg.py"></a>(1) test_skip_msg.py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_skip_msg.py</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_case</span>():<br>    n = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;---use case <span class="hljs-subst">&#123;n&#125;</span> execution---&quot;</span>)<br>        n += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> n == <span class="hljs-number">5</span>:                                      <span class="hljs-comment"># pytest.skip(msg=&quot;&quot;)</span><br>            pytest.skip(<span class="hljs-string">&quot;---use case 5 exit---&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_skip_msg.py&quot;</span>])<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">pytest test_skip_msg.py                                 # test_skip_msg.py s</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 1 item</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_skip_msg.py::test_case </span><br><span class="hljs-string">SKIPPED (---use case 5 exit---)                         [100%]---use case 0 execution---</span><br><span class="hljs-string">---use case 1 execution---</span><br><span class="hljs-string">---use case 2 execution---</span><br><span class="hljs-string">---use case 3 execution---</span><br><span class="hljs-string">---use case 4 execution---</span><br><span class="hljs-string"></span><br><span class="hljs-string">Skipped: ---use case 5 exit---</span><br><span class="hljs-string">============================= 1 skipped in 0.15s ==============================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h3 id="2-test-skip-allow-py"><a href="#2-test-skip-allow-py" class="headerlink" title="(2) test_skip_allow.py"></a>(2) test_skip_allow.py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_skip_allow.py</span><br><br><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> sys.platform.startswith(<span class="hljs-string">&quot;darwin&quot;</span>):               <span class="hljs-comment"># allow_module_level=Trueï¼Œè®¾ç½®è·³è¿‡æ•´ä¸ªæ¨¡å—</span><br>    pytest.skip(<span class="hljs-string">&quot;æµ‹è¯•ç”¨ä¾‹åªåœ¨Macå¹³å°ä¸Šæ‰§è¡Œ&quot;</span>, allow_module_level=<span class="hljs-literal">True</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_a</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case a---&quot;</span>)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">TestCase</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_b</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case b---&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_c</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case c---&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_skip_allow.py&quot;</span>])<br><br><span class="hljs-string">&quot;&quot;&quot;            ï¼ï¼ï¼winæ˜¯Windowså¹³å°ï¼Œdarwinæ˜¯Macå¹³å°ï¼ŒLinuxæ˜¯Linuxå¹³å°            </span><br><span class="hljs-string">pytest test_skip_allow.py                               # collected 0 items / 1 skipped</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... </span><br><span class="hljs-string">Skipped: æµ‹è¯•ç”¨ä¾‹åªåœ¨Macå¹³å°ä¸Šæ‰§è¡Œ</span><br><span class="hljs-string">collected 0 items / 1 skipped</span><br><span class="hljs-string">============================= 1 skipped in 0.04s ==============================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h2 id="2-5-pytest-xfail"><a href="#2-5-pytest-xfail" class="headerlink" title="2-5 pytest.xfail()"></a>2-5 pytest.xfail()</h2><ul>
<li>pytest.xfail()<ul>
<li>ç”¨äºæ ‡è®°æµ‹è¯•ç”¨ä¾‹ä¸ºé¢„æœŸå¤±è´¥çŠ¶æ€ï¼Œé¢„æœŸå¤±è´¥å³è¯¥æµ‹è¯•ç”¨ä¾‹çš„ç›®æ ‡æ˜¯å¤±è´¥çš„ã€‚</li>
<li>å‚æ•°reasonæä¾›é¢„æœŸå¤±è´¥çš„åŸå› è¯´æ˜ï¼Œå‚æ•°raisesåˆ™æŒ‡å®šé¢„æœŸæŠ›å‡ºçš„å¼‚å¸¸ç±»å‹ã€‚</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_xfail.py</span><br><br><br><span class="hljs-meta">@pytest.xfail(<span class="hljs-params">reason=<span class="hljs-string">&quot;æµ‹è¯•ç”¨ä¾‹é¢„æœŸå¤±è´¥&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_a</span>():<br>    <span class="hljs-keyword">assert</span> <span class="hljs-number">2</span> + <span class="hljs-number">2</span> == <span class="hljs-number">5</span><br><br><br><span class="hljs-meta">@pytest.xfail(<span class="hljs-params">raises=ZeroDivisionError</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_b</span>():<br>    <span class="hljs-keyword">assert</span> <span class="hljs-number">10</span> / <span class="hljs-number">0</span> == <span class="hljs-number">5</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_xfail.py&quot;</span>])<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">pytest test_xfail.py                                    # collected 0 items / 1 error</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... </span><br><span class="hljs-string">test_xfail.py:None (test_xfail.py)</span><br><span class="hljs-string">test_xfail.py:4: in &lt;module&gt;</span><br><span class="hljs-string">    @pytest.xfail(reason=&quot;æµ‹è¯•ç”¨ä¾‹é¢„æœŸå¤±è´¥&quot;)</span><br><span class="hljs-string">E   _pytest.outcomes.XFailed: æµ‹è¯•ç”¨ä¾‹é¢„æœŸå¤±è´¥</span><br><span class="hljs-string">collected 0 items / 1 error</span><br><span class="hljs-string"></span><br><span class="hljs-string">!!!!!!!!!!!!!!!!!!! Interrupted: 1 error during collection !!!!!!!!!!!!!!!!!!!!</span><br><span class="hljs-string">============================== 1 error in 0.34s ===============================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h2 id="2-6-è‡ªå®šä¹‰è·³è¿‡æ ‡è¯†"><a href="#2-6-è‡ªå®šä¹‰è·³è¿‡æ ‡è¯†" class="headerlink" title="2-6 è‡ªå®šä¹‰è·³è¿‡æ ‡è¯†"></a>2-6 è‡ªå®šä¹‰è·³è¿‡æ ‡è¯†</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_skip_tag.py</span><br><br><span class="hljs-comment"># mark_version = pytest.mark.skip(reason=&quot;ä¸åœ¨Winä¸‹æ‰§è¡Œ&quot;)</span><br>mark_version = pytest.mark.skipif(sys.platform != <span class="hljs-string">&quot;win&quot;</span>, reason=<span class="hljs-string">&quot;ä¸åœ¨Winä¸‹æ‰§è¡Œ&quot;</span>)<br><br><br><span class="hljs-meta">@mark_version</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_a</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case a---&quot;</span>)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">TestCase</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_b</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case b---&quot;</span>)<br><br><span class="hljs-meta">    @mark_version</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_c</span>(<span class="hljs-params">self, </span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case c---&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_skip_tag.py&quot;</span>])<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">pytest test_skip_tag.py                                 # test_skip_tag.py s.s</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 3 items</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_skip_tag.py::test_a                                [ 33%]</span><br><span class="hljs-string">SKIPPED (ä¸åœ¨Winä¸‹æ‰§è¡Œ)</span><br><span class="hljs-string">Skipped: ä¸åœ¨Winä¸‹æ‰§è¡Œ</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_skip_tag.py::TestCase::test_b                      [ 66%]---use case b---</span><br><span class="hljs-string">PASSED</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_skip_tag.py::TestCase::test_c                      [100%]</span><br><span class="hljs-string">SKIPPED (ä¸åœ¨Winä¸‹æ‰§è¡Œ)</span><br><span class="hljs-string">Skipped: ä¸åœ¨Winä¸‹æ‰§è¡Œ</span><br><span class="hljs-string">======================== 1 passed, 2 skipped in 0.05s =========================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h2 id="2-7-pytest-importorskip"><a href="#2-7-pytest-importorskip" class="headerlink" title="2-7 pytest.importorskip()"></a>2-7 pytest.importorskip()</h2><ul>
<li>pytest.importorskip()<ul>
<li><code>pytest.importorskip(modname: str, minversion: Optional[str] = None, reason: Optional[str] = None)</code></li>
<li>å‚æ•°åˆ—è¡¨ï¼šmodname-æ¨¡å—åã€minversion-ç‰ˆæœ¬å·ã€reason-è·³è¿‡åŸå› ï¼Œæ¨¡å—åå¿…é€‰ï¼Œç‰ˆæœ¬å·å’Œè·³è¿‡åŸå› éƒ½æ˜¯å¯é€‰çš„ã€‚</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_importorskip.py</span><br><br>sys = pytest.importorskip(<span class="hljs-string">&quot;sys&quot;</span>, minversion=<span class="hljs-string">&quot;1.0&quot;</span>)<br><br><br><span class="hljs-meta">@sys</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_case</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---test cases---&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_importorskip.py&quot;</span>])<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">pytest test_importorskip.py                             # collected 0 items / 1 skipped</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... </span><br><span class="hljs-string">Skipped: module &#x27;sys&#x27; has __version__ None, required is: &#x27;1.0&#x27;</span><br><span class="hljs-string">collected 0 items / 1 skipped</span><br><span class="hljs-string">============================= 1 skipped in 0.27s ==============================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h1 id="3-assertæ–­è¨€"><a href="#3-assertæ–­è¨€" class="headerlink" title="3 assertæ–­è¨€"></a>3 assertæ–­è¨€</h1><ul>
<li>assertæ–­è¨€<ul>
<li>å³å®é™…ç»“æœå’ŒæœŸæœ›ç»“æœçš„æ¯”å¯¹ï¼Œç¬¦åˆé¢„æœŸå°±passï¼Œä¸ç¬¦åˆåˆ™failedã€‚</li>
<li>PyTestå…è®¸ä½¿ç”¨æ ‡å‡†çš„Pythonæ–­è¨€assertæ¥éªŒè¯æµ‹è¯•ä¸­çš„æœŸæœ›å’Œå€¼ã€‚</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">f</span>():                                                <span class="hljs-comment"># test_assert.py</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">3</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_function</span>():<br>    <span class="hljs-keyword">assert</span> f() == <span class="hljs-number">5</span><br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 1 item</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_assert.py::test_function FAILED                    [100%]</span><br><span class="hljs-string">test_assert.py:4 (test_function)</span><br><span class="hljs-string">3 != 5</span><br><span class="hljs-string"></span><br><span class="hljs-string">Expected :5</span><br><span class="hljs-string">Actual   :3</span><br><span class="hljs-string">&lt;Click to see difference&gt;</span><br><span class="hljs-string"></span><br><span class="hljs-string">def test_function():</span><br><span class="hljs-string">&gt;       assert f() == 5</span><br><span class="hljs-string">E       assert 3 == 5</span><br><span class="hljs-string">E         +3</span><br><span class="hljs-string">E         -5</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_assert.py:6: AssertionError</span><br><span class="hljs-string">============================== 1 failed in 0.33s ==============================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h2 id="3-1-å¼‚å¸¸ä¿¡æ¯"><a href="#3-1-å¼‚å¸¸ä¿¡æ¯" class="headerlink" title="3-1 å¼‚å¸¸ä¿¡æ¯"></a>3-1 å¼‚å¸¸ä¿¡æ¯</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">f</span>():                                                <span class="hljs-comment"># test_exception_message.py</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">3</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_function</span>():<br>    x = f()<br>    <span class="hljs-keyword">assert</span> x % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>, <span class="hljs-string">&quot;ç¡®å®šæ˜¯å¦ä¸ºå¶æ•°ï¼Œå¹¶ä¸”å½“å‰å€¼ä¸º%s&quot;</span> % x<br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 1 item</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_exception_message.py::test_function FAILED         [100%]</span><br><span class="hljs-string">test_exception_message.py:4 (test_function)</span><br><span class="hljs-string">1 != 0</span><br><span class="hljs-string"></span><br><span class="hljs-string">Expected :0</span><br><span class="hljs-string">Actual   :1</span><br><span class="hljs-string">&lt;Click to see difference&gt;</span><br><span class="hljs-string"></span><br><span class="hljs-string">def test_function():</span><br><span class="hljs-string">        x = f()</span><br><span class="hljs-string">&gt;       assert x % 2 == 0, &quot;ç¡®å®šæ˜¯å¦ä¸ºå¶æ•°ï¼Œå¹¶ä¸”å½“å‰å€¼ä¸º%s&quot; % x</span><br><span class="hljs-string">E       AssertionError: ç¡®å®šæ˜¯å¦ä¸ºå¶æ•°ï¼Œå¹¶ä¸”å½“å‰å€¼ä¸º3</span><br><span class="hljs-string">E       assert 1 == 0</span><br><span class="hljs-string">E         +1</span><br><span class="hljs-string">E         -0</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_exception_message.py:7: AssertionError</span><br><span class="hljs-string">============================== 1 failed in 0.45s ==============================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h2 id="3-2-å¼‚å¸¸æ–­è¨€"><a href="#3-2-å¼‚å¸¸æ–­è¨€" class="headerlink" title="3-2 å¼‚å¸¸æ–­è¨€"></a>3-2 å¼‚å¸¸æ–­è¨€</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_anomaly_assertion.py</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_zero_division</span>():<br>    <span class="hljs-keyword">with</span> pytest.raises(ZeroDivisionError):              <span class="hljs-comment"># ä½¿ç”¨pytest.raisesä½œä¸ºä¸Šä¸‹æ–‡ç®¡ç†å™¨</span><br>        <span class="hljs-number">1</span> / <span class="hljs-number">0</span><br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 1 item</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_anomaly_assertion.py::test_zero_division PASSED    [100%]</span><br><span class="hljs-string">============================== 1 passed in 0.14s ==============================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>

<ul>
<li>å¼‚å¸¸ç±»å‹<ul>
<li>è¦åˆ¤æ–­æŠ›å‡ºçš„å¼‚å¸¸æ˜¯å¦é¢„æœŸï¼Œä¾‹å¦‚<code>1/0</code>æŠ›å‡ºçš„å¼‚å¸¸ä¸ºï¼š<code>ZeroDivisionError: division by zero</code>ã€‚</li>
<li>æ–­è¨€è¯¥å¼‚å¸¸ï¼Œé€šå¸¸æ˜¯æ–­è¨€å¼‚å¸¸çš„typeå’Œvalueå€¼ï¼Œtypeæ˜¯ZeroDivisionErrorï¼Œvalueæ˜¯division by zeroã€‚</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_exception_type.py</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_zero_division</span>():                               <span class="hljs-comment"># æ–­è¨€å¼‚å¸¸</span><br>    <span class="hljs-keyword">with</span> pytest.raises(ZeroDivisionError) <span class="hljs-keyword">as</span> excinfo:   <span class="hljs-comment"># ä½¿ç”¨pytest.raisesä½œä¸ºä¸Šä¸‹æ–‡ç®¡ç†å™¨</span><br>        <span class="hljs-number">1</span> / <span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">assert</span> excinfo.<span class="hljs-built_in">type</span> == ZeroDivisionError            <span class="hljs-comment"># æ–­è¨€å¼‚å¸¸typeå€¼</span><br>    <span class="hljs-keyword">assert</span> <span class="hljs-string">&quot;division by zero&quot;</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">str</span>(excinfo.value)     <span class="hljs-comment"># æ–­è¨€å¼‚å¸¸valueå€¼</span><br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 1 item</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_exception_type.py::test_zero_division PASSED       [100%]</span><br><span class="hljs-string">============================== 1 passed in 0.12s ==============================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h2 id="3-3-å¸¸ç”¨æ–­è¨€"><a href="#3-3-å¸¸ç”¨æ–­è¨€" class="headerlink" title="3-3 å¸¸ç”¨æ–­è¨€"></a>3-3 å¸¸ç”¨æ–­è¨€</h2><ul>
<li>å¸¸ç”¨æ–­è¨€<ul>
<li><code>assert xx</code>ï¼šåˆ¤æ–­xxä¸ºçœŸã€‚</li>
<li><code>assert not xx</code>ï¼šåˆ¤æ–­xxä¸ä¸ºçœŸã€‚</li>
<li><code>assert a in b</code>ï¼šåˆ¤æ–­båŒ…å«aã€‚</li>
<li><code>assert a == b</code>ï¼šåˆ¤æ–­aç­‰äºbã€‚</li>
<li><code>assert a != b</code>ï¼šåˆ¤æ–­aä¸ç­‰äºbã€‚</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_common_asserts.py</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">is_true</span>(<span class="hljs-params">a</span>):<br>    <span class="hljs-keyword">if</span> a &gt; <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_01</span>():<br>    a = <span class="hljs-number">5</span><br>    b = -<span class="hljs-number">1</span><br>    <span class="hljs-keyword">assert</span> is_true(a)                                   <span class="hljs-comment"># æ–­è¨€aä¸ºçœŸ</span><br>    <span class="hljs-keyword">assert</span> <span class="hljs-keyword">not</span> is_true(b)                               <span class="hljs-comment"># æ–­è¨€bä¸ä¸ºçœŸ</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_02</span>():<br>    a = <span class="hljs-string">&quot;hello&quot;</span><br>    b = <span class="hljs-string">&quot;hello world&quot;</span><br>    <span class="hljs-keyword">assert</span> a <span class="hljs-keyword">in</span> b                                       <span class="hljs-comment"># æ–­è¨€båŒ…å«a</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_03</span>():<br>    a = <span class="hljs-string">&quot;Yoyo&quot;</span><br>    b = <span class="hljs-string">&quot;Yoyo&quot;</span><br>    <span class="hljs-keyword">assert</span> a == b                                       <span class="hljs-comment"># æ–­è¨€ç›¸ç­‰</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_04</span>():<br>    a = <span class="hljs-number">5</span><br>    b = <span class="hljs-number">6</span><br>    <span class="hljs-keyword">assert</span> a != b                                       <span class="hljs-comment"># æ–­è¨€ä¸ç›¸ç­‰</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_common_asserts.py&quot;</span>])<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 4 items</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_common_asserts.py::test_01 PASSED                  [ 25%]</span><br><span class="hljs-string">test_common_asserts.py::test_02 PASSED                  [ 50%]</span><br><span class="hljs-string">test_common_asserts.py::test_03 PASSED                  [ 75%]</span><br><span class="hljs-string">test_common_asserts.py::test_04 PASSED                  [100%]</span><br><span class="hljs-string">============================== 4 passed in 0.14s ==============================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h1 id="4-ç”¨ä¾‹è¿è¡Œçº§åˆ«"><a href="#4-ç”¨ä¾‹è¿è¡Œçº§åˆ«" class="headerlink" title="4 ç”¨ä¾‹è¿è¡Œçº§åˆ«"></a>4 ç”¨ä¾‹è¿è¡Œçº§åˆ«</h1><ul>
<li>ç”¨ä¾‹è¿è¡Œçº§åˆ«<ul>
<li>æ¨¡å—çº§ï¼šsetup_moduleã€teardown_moduleï¼Œåœ¨æ‰€æœ‰ç”¨ä¾‹å‰ååªæ‰§è¡Œä¸€æ¬¡ã€‚</li>
<li>å‡½æ•°çº§ï¼šsetup_functionã€teardown_functionï¼Œåœ¨æ‰€æœ‰ç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡ã€‚</li>
<li>ç±»çº§åˆ«ï¼šsetup_classã€teardown_classï¼Œåœ¨ç±»ä¸­çš„æ‰€æœ‰ç”¨ä¾‹å‰ååªæ‰§è¡Œä¸€æ¬¡ã€‚</li>
<li>ç±»æ–¹æ³•çº§ï¼šsetup_methodã€teardown_methodï¼Œåœ¨ç±»ä¸­çš„æ‰€æœ‰ç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡ã€‚</li>
<li>ç±»æ–¹æ³•ç»†åŒ–çº§ï¼šsetupã€teardownï¼Œè¿è¡Œè§„åˆ™ä¸ç±»æ–¹æ³•çº§ç›¸åŒï¼Œåœ¨æ¯ä¸ªç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡ã€‚</li>
</ul>
</li>
</ul>
<h2 id="4-1-æ¨¡å—çº§"><a href="#4-1-æ¨¡å—çº§" class="headerlink" title="4-1 æ¨¡å—çº§"></a>4-1 æ¨¡å—çº§</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_module.py</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">setup_module</span>():                                     <span class="hljs-comment"># æ¨¡å—çº§</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---setup_module: åœ¨æ‰€æœ‰ç”¨ä¾‹å‰ååªæ‰§è¡Œä¸€æ¬¡---&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">teardown_module</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---teardown_module: åœ¨æ‰€æœ‰ç”¨ä¾‹å‰ååªæ‰§è¡Œä¸€æ¬¡---&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_one</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---æ‰§è¡Œä¸­---test_one()&quot;</span>)<br>    x = <span class="hljs-string">&quot;this&quot;</span><br>    <span class="hljs-keyword">assert</span> <span class="hljs-string">&quot;h&quot;</span> <span class="hljs-keyword">in</span> x<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_two</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---æ‰§è¡Œä¸­---test_two()&quot;</span>)<br>    x = <span class="hljs-string">&quot;hello&quot;</span><br>    <span class="hljs-keyword">assert</span> <span class="hljs-string">&quot;o&quot;</span> <span class="hljs-keyword">in</span> x<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_module.py&quot;</span>])<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 2 items</span><br><span class="hljs-string"></span><br><span class="hljs-string">---setup_module: åœ¨æ‰€æœ‰ç”¨ä¾‹å‰ååªæ‰§è¡Œä¸€æ¬¡---</span><br><span class="hljs-string">test_module.py::test_one PASSED                         [ 50%]---æ‰§è¡Œä¸­---test_one()</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_module.py::test_two PASSED                         [100%]---æ‰§è¡Œä¸­---test_two()</span><br><span class="hljs-string">---teardown_module: åœ¨æ‰€æœ‰ç”¨ä¾‹å‰ååªæ‰§è¡Œä¸€æ¬¡---</span><br><span class="hljs-string">============================== 2 passed in 0.14s ==============================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h2 id="4-2-å‡½æ•°çº§"><a href="#4-2-å‡½æ•°çº§" class="headerlink" title="4-2 å‡½æ•°çº§"></a>4-2 å‡½æ•°çº§</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_function.py</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">setup_function</span>():                                   <span class="hljs-comment"># å‡½æ•°çº§</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---setup_function: åœ¨æ‰€æœ‰ç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">teardown_function</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---teardown_function: åœ¨æ‰€æœ‰ç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_one</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---æ‰§è¡Œä¸­---test_one()&quot;</span>)<br>    x = <span class="hljs-string">&quot;this&quot;</span><br>    <span class="hljs-keyword">assert</span> <span class="hljs-string">&quot;h&quot;</span> <span class="hljs-keyword">in</span> x<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_two</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---æ‰§è¡Œä¸­---test_two()&quot;</span>)<br>    x = <span class="hljs-string">&quot;hello&quot;</span><br>    <span class="hljs-keyword">assert</span> <span class="hljs-string">&quot;o&quot;</span> <span class="hljs-keyword">in</span> x<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_function.py&quot;</span>])<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 2 items</span><br><span class="hljs-string"></span><br><span class="hljs-string">---setup_function: åœ¨æ‰€æœ‰ç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---</span><br><span class="hljs-string">test_function.py::test_one PASSED                       [ 50%]---æ‰§è¡Œä¸­---test_one()</span><br><span class="hljs-string">---teardown_function: åœ¨æ‰€æœ‰ç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---</span><br><span class="hljs-string"></span><br><span class="hljs-string">---setup_function: åœ¨æ‰€æœ‰ç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---</span><br><span class="hljs-string">test_function.py::test_two PASSED                       [100%]---æ‰§è¡Œä¸­---test_two()</span><br><span class="hljs-string">---teardown_function: åœ¨æ‰€æœ‰ç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---</span><br><span class="hljs-string">============================== 2 passed in 0.04s ==============================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h2 id="4-3-ç±»çº§åˆ«"><a href="#4-3-ç±»çº§åˆ«" class="headerlink" title="4-3 ç±»çº§åˆ«"></a>4-3 ç±»çº§åˆ«</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_class.py</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">TestCase</span>:                                         <span class="hljs-comment"># ç±»çº§åˆ«</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">setup_class</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---setup_class: åœ¨ç±»ä¸­çš„æ‰€æœ‰ç”¨ä¾‹å‰ååªæ‰§è¡Œä¸€æ¬¡---&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">teardown_class</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---teardown_class: åœ¨ç±»ä¸­çš„æ‰€æœ‰ç”¨ä¾‹å‰ååªæ‰§è¡Œä¸€æ¬¡---&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_one</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---æ‰§è¡Œä¸­---test_one()&quot;</span>)<br>        x = <span class="hljs-string">&quot;this&quot;</span><br>        <span class="hljs-keyword">assert</span> <span class="hljs-string">&quot;h&quot;</span> <span class="hljs-keyword">in</span> x<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_two</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---æ‰§è¡Œä¸­---test_two()&quot;</span>)<br>        x = <span class="hljs-string">&quot;hello&quot;</span><br>        <span class="hljs-keyword">assert</span> <span class="hljs-string">&quot;o&quot;</span> <span class="hljs-keyword">in</span> x<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_class.py&quot;</span>])<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 2 items</span><br><span class="hljs-string"></span><br><span class="hljs-string">---setup_class: åœ¨ç±»ä¸­çš„æ‰€æœ‰ç”¨ä¾‹å‰ååªæ‰§è¡Œä¸€æ¬¡---</span><br><span class="hljs-string">test_class.py::TestCase::test_one PASSED                [ 50%]---æ‰§è¡Œä¸­---test_one()</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_class.py::TestCase::test_two PASSED                [100%]---æ‰§è¡Œä¸­---test_two()</span><br><span class="hljs-string">---teardown_class: åœ¨ç±»ä¸­çš„æ‰€æœ‰ç”¨ä¾‹å‰ååªæ‰§è¡Œä¸€æ¬¡---</span><br><span class="hljs-string">============================== 2 passed in 0.02s ==============================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h2 id="4-4-ç±»æ–¹æ³•çº§"><a href="#4-4-ç±»æ–¹æ³•çº§" class="headerlink" title="4-4 ç±»æ–¹æ³•çº§"></a>4-4 ç±»æ–¹æ³•çº§</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_method.py</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">TestCase</span>:                                         <span class="hljs-comment"># ç±»æ–¹æ³•çº§</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">setup_method</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---setup_method: åœ¨ç±»ä¸­çš„æ‰€æœ‰ç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">teardown_method</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---teardown_method: åœ¨ç±»ä¸­çš„æ‰€æœ‰ç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_one</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---æ‰§è¡Œä¸­---test_one()&quot;</span>)<br>        x = <span class="hljs-string">&quot;this&quot;</span><br>        <span class="hljs-keyword">assert</span> <span class="hljs-string">&quot;h&quot;</span> <span class="hljs-keyword">in</span> x<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_two</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---æ‰§è¡Œä¸­---test_two()&quot;</span>)<br>        x = <span class="hljs-string">&quot;hello&quot;</span><br>        <span class="hljs-keyword">assert</span> <span class="hljs-string">&quot;o&quot;</span> <span class="hljs-keyword">in</span> x<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_method.py&quot;</span>])<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 2 items</span><br><span class="hljs-string"></span><br><span class="hljs-string">---setup_method: åœ¨ç±»ä¸­çš„æ‰€æœ‰ç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---</span><br><span class="hljs-string">test_method.py::TestCase::test_one PASSED               [ 50%]---æ‰§è¡Œä¸­---test_one()</span><br><span class="hljs-string">---teardown_method: åœ¨ç±»ä¸­çš„æ‰€æœ‰ç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---</span><br><span class="hljs-string"></span><br><span class="hljs-string">---setup_method: åœ¨ç±»ä¸­çš„æ‰€æœ‰ç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---</span><br><span class="hljs-string">test_method.py::TestCase::test_two PASSED               [100%]---æ‰§è¡Œä¸­---test_two()</span><br><span class="hljs-string">---teardown_method: åœ¨ç±»ä¸­çš„æ‰€æœ‰ç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---</span><br><span class="hljs-string">============================== 2 passed in 0.12s ==============================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h2 id="4-5-ç±»æ–¹æ³•ç»†åŒ–çº§"><a href="#4-5-ç±»æ–¹æ³•ç»†åŒ–çº§" class="headerlink" title="4-5 ç±»æ–¹æ³•ç»†åŒ–çº§"></a>4-5 ç±»æ–¹æ³•ç»†åŒ–çº§</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_fixclass.py</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">TestCase</span>:                                         <span class="hljs-comment"># ç±»æ–¹æ³•ç»†åŒ–çº§</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">setup</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---setup: åœ¨æ¯ä¸ªç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">teardown</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---teardown: åœ¨æ¯ä¸ªç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_one</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---æ‰§è¡Œä¸­---test_one()&quot;</span>)<br>        x = <span class="hljs-string">&quot;this&quot;</span><br>        <span class="hljs-keyword">assert</span> <span class="hljs-string">&quot;h&quot;</span> <span class="hljs-keyword">in</span> x<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_two</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---æ‰§è¡Œä¸­---test_two()&quot;</span>)<br>        x = <span class="hljs-string">&quot;hello&quot;</span><br>        <span class="hljs-keyword">assert</span> <span class="hljs-string">&quot;o&quot;</span> <span class="hljs-keyword">in</span> x<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_fixclass.py&quot;</span>])<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 2 items</span><br><span class="hljs-string"></span><br><span class="hljs-string">---setup: åœ¨æ¯ä¸ªç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---</span><br><span class="hljs-string">test_fixclass.py::TestCase::test_one PASSED             [ 50%]---æ‰§è¡Œä¸­---test_one()</span><br><span class="hljs-string">---teardown: åœ¨æ¯ä¸ªç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---</span><br><span class="hljs-string"></span><br><span class="hljs-string">---setup: åœ¨æ¯ä¸ªç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---</span><br><span class="hljs-string">test_fixclass.py::TestCase::test_two PASSED             [100%]---æ‰§è¡Œä¸­---test_two()</span><br><span class="hljs-string">---teardown: åœ¨æ¯ä¸ªç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---</span><br><span class="hljs-string">============================== 2 passed in 0.14s ==============================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h2 id="4-6-ç±»å’Œæ–¹æ³•æ··åˆ"><a href="#4-6-ç±»å’Œæ–¹æ³•æ··åˆ" class="headerlink" title="4-6 ç±»å’Œæ–¹æ³•æ··åˆ"></a>4-6 ç±»å’Œæ–¹æ³•æ··åˆ</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_mixclass.py</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">TestCase</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">setup_class</span>(<span class="hljs-params">self</span>):                              <span class="hljs-comment"># ç±»çº§</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---setup_class: åœ¨ç±»ä¸­çš„æ‰€æœ‰ç”¨ä¾‹å‰ååªæ‰§è¡Œä¸€æ¬¡---&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">teardown_class</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---teardown_class: åœ¨ç±»ä¸­çš„æ‰€æœ‰ç”¨ä¾‹å‰ååªæ‰§è¡Œä¸€æ¬¡---&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">setup_method</span>(<span class="hljs-params">self</span>):                             <span class="hljs-comment"># æ–¹æ³•çº§</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---setup_method: åœ¨ç±»ä¸­çš„æ‰€æœ‰ç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">teardown_method</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---teardown_method: åœ¨ç±»ä¸­çš„æ‰€æœ‰ç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">setup</span>(<span class="hljs-params">self</span>):                                    <span class="hljs-comment"># ç±»æ–¹æ³•ç»†åŒ–çº§</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---setup: åœ¨æ¯ä¸ªç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">teardown</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---teardown: åœ¨æ¯ä¸ªç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_one</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---æ‰§è¡Œä¸­---test_one()&quot;</span>)<br>        x = <span class="hljs-string">&quot;this&quot;</span><br>        <span class="hljs-keyword">assert</span> <span class="hljs-string">&quot;h&quot;</span> <span class="hljs-keyword">in</span> x<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_two</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---æ‰§è¡Œä¸­---test_two()&quot;</span>)<br>        x = <span class="hljs-string">&quot;hello&quot;</span><br>        <span class="hljs-keyword">assert</span> <span class="hljs-string">&quot;o&quot;</span> <span class="hljs-keyword">in</span> x<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_mixclass.py&quot;</span>])<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 2 items</span><br><span class="hljs-string">---setup_class: åœ¨ç±»ä¸­çš„æ‰€æœ‰ç”¨ä¾‹å‰ååªæ‰§è¡Œä¸€æ¬¡---</span><br><span class="hljs-string">---setup_method: åœ¨ç±»ä¸­çš„æ‰€æœ‰ç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---</span><br><span class="hljs-string">---setup: åœ¨æ¯ä¸ªç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---</span><br><span class="hljs-string">test_mixclass.py::TestCase::test_one PASSED             [ 50%]---æ‰§è¡Œä¸­---test_one()</span><br><span class="hljs-string">---teardown: åœ¨æ¯ä¸ªç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---</span><br><span class="hljs-string">---teardown_method: åœ¨ç±»ä¸­çš„æ‰€æœ‰ç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---</span><br><span class="hljs-string"></span><br><span class="hljs-string">---setup_method: åœ¨ç±»ä¸­çš„æ‰€æœ‰ç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---</span><br><span class="hljs-string">---setup: åœ¨æ¯ä¸ªç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---</span><br><span class="hljs-string">test_mixclass.py::TestCase::test_two PASSED             [100%]---æ‰§è¡Œä¸­---test_two()</span><br><span class="hljs-string">---teardown: åœ¨æ¯ä¸ªç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---</span><br><span class="hljs-string">---teardown_method: åœ¨ç±»ä¸­çš„æ‰€æœ‰ç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---</span><br><span class="hljs-string">---teardown_class: åœ¨ç±»ä¸­çš„æ‰€æœ‰ç”¨ä¾‹å‰ååªæ‰§è¡Œä¸€æ¬¡---</span><br><span class="hljs-string">============================== 2 passed in 0.05s ==============================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h2 id="4-7-æ¨¡å—å’Œç±»æ··åˆ"><a href="#4-7-æ¨¡å—å’Œç±»æ··åˆ" class="headerlink" title="4-7 æ¨¡å—å’Œç±»æ··åˆ"></a>4-7 æ¨¡å—å’Œç±»æ··åˆ</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_mixmodule.py</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">setup_module</span>():                                     <span class="hljs-comment"># æ¨¡å—çº§</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---setup_module: åœ¨æ‰€æœ‰ç”¨ä¾‹å‰ååªæ‰§è¡Œä¸€æ¬¡---&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">teardown_module</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---teardown_module: åœ¨æ‰€æœ‰ç”¨ä¾‹å‰ååªæ‰§è¡Œä¸€æ¬¡---&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">setup_function</span>():                                   <span class="hljs-comment"># å‡½æ•°çº§</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---setup_function: åœ¨æ‰€æœ‰ç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">teardown_function</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---teardown_function: åœ¨æ‰€æœ‰ç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_a</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---æ‰§è¡Œä¸­---test_a()&quot;</span>)<br>    x = <span class="hljs-string">&quot;this&quot;</span><br>    <span class="hljs-keyword">assert</span> <span class="hljs-string">&quot;h&quot;</span> <span class="hljs-keyword">in</span> x<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_b</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---æ‰§è¡Œä¸­---test_b()&quot;</span>)<br>    x = <span class="hljs-string">&quot;hello&quot;</span><br>    <span class="hljs-keyword">assert</span> <span class="hljs-string">&quot;o&quot;</span> <span class="hljs-keyword">in</span> x<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">TestCase</span>:                                         <span class="hljs-comment"># ç±»çº§åˆ«</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">setup_class</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---setup_class: åœ¨ç±»ä¸­çš„æ‰€æœ‰ç”¨ä¾‹å‰ååªæ‰§è¡Œä¸€æ¬¡---&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">teardown_class</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---teardown_class: åœ¨ç±»ä¸­çš„æ‰€æœ‰ç”¨ä¾‹å‰ååªæ‰§è¡Œä¸€æ¬¡---&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_c</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---æ‰§è¡Œä¸­---test_c()&quot;</span>)<br>        x = <span class="hljs-string">&quot;class&quot;</span><br>        <span class="hljs-keyword">assert</span> <span class="hljs-string">&quot;c&quot;</span> <span class="hljs-keyword">in</span> x<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_d</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---æ‰§è¡Œä¸­---test_d()&quot;</span>)<br>        x = <span class="hljs-string">&quot;module&quot;</span><br>        <span class="hljs-keyword">assert</span> <span class="hljs-string">&quot;m&quot;</span> <span class="hljs-keyword">in</span> x<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_mixmodule.py&quot;</span>])<br><br><span class="hljs-string">&quot;&quot;&quot;               ï¼ï¼ï¼æ³¨æ„ï¼šæ¨¡å—çº§ä¼˜å…ˆæƒæœ€å¤§ï¼Œå‡½æ•°çº§å’Œç±»çº§åˆ«äº’ä¸å¹²æ¶‰ã€‚               </span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 4 items</span><br><span class="hljs-string"></span><br><span class="hljs-string">---setup_module: åœ¨æ‰€æœ‰ç”¨ä¾‹å‰ååªæ‰§è¡Œä¸€æ¬¡---</span><br><span class="hljs-string">---setup_function: åœ¨æ‰€æœ‰ç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---</span><br><span class="hljs-string">test_mixmodule.py::test_a PASSED                        [ 25%]---æ‰§è¡Œä¸­---test_a()</span><br><span class="hljs-string">---teardown_function: åœ¨æ‰€æœ‰ç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---</span><br><span class="hljs-string"></span><br><span class="hljs-string">---setup_function: åœ¨æ‰€æœ‰ç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---</span><br><span class="hljs-string">test_mixmodule.py::test_b PASSED                        [ 50%]---æ‰§è¡Œä¸­---test_b()</span><br><span class="hljs-string">---teardown_function: åœ¨æ‰€æœ‰ç”¨ä¾‹å‰åéƒ½æ‰§è¡Œä¸€æ¬¡---</span><br><span class="hljs-string"></span><br><span class="hljs-string">---setup_class: åœ¨ç±»ä¸­çš„æ‰€æœ‰ç”¨ä¾‹å‰ååªæ‰§è¡Œä¸€æ¬¡---</span><br><span class="hljs-string">test_mixmodule.py::TestCase::test_c PASSED              [ 75%]---æ‰§è¡Œä¸­---test_c()</span><br><span class="hljs-string">test_mixmodule.py::TestCase::test_d PASSED              [100%]---æ‰§è¡Œä¸­---test_d()</span><br><span class="hljs-string">---teardown_class: åœ¨ç±»ä¸­çš„æ‰€æœ‰ç”¨ä¾‹å‰ååªæ‰§è¡Œä¸€æ¬¡---</span><br><span class="hljs-string"></span><br><span class="hljs-string">---teardown_module: åœ¨æ‰€æœ‰ç”¨ä¾‹å‰ååªæ‰§è¡Œä¸€æ¬¡---</span><br><span class="hljs-string">============================== 4 passed in 0.14s ==============================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h1 id="5-fixtureé¢„ç½®æ¡ä»¶"><a href="#5-fixtureé¢„ç½®æ¡ä»¶" class="headerlink" title="5 fixtureé¢„ç½®æ¡ä»¶"></a>5 fixtureé¢„ç½®æ¡ä»¶</h1><ul>
<li>fixtureé¢„ç½®æ¡ä»¶<ul>
<li>ç›¸æ¯”ç”¨ä¾‹è¿è¡Œçº§åˆ«çš„setupå’Œteardownï¼Œfixtureçš„å‘½åæ–¹å¼æ›´ä¸ºçµæ´»ã€‚</li>
<li><code>@pytest.fixture(scope=&quot;function&quot;, params=&quot;None&quot;, autouse=False, ids=None, name=None)</code><ul>
<li>scopeï¼šç±»ä¼¼äºä½œç”¨åŸŸï¼Œé»˜è®¤ä¸ºfunctionï¼Œè¿˜å¯ä»¥æ˜¯classã€moduleã€sessionã€packageã€‚</li>
<li>autouseï¼šé»˜è®¤ä¸ºFalseï¼Œç”¨ä¾‹æ‰‹åŠ¨è°ƒç”¨è¯¥fixtureï¼Œè‹¥ä¸ºTrueåˆ™ä½œç”¨åŸŸå†…çš„ç”¨ä¾‹è‡ªåŠ¨è°ƒç”¨ã€‚</li>
<li>nameï¼šé»˜è®¤çš„è£…é¥°å™¨åç§°ï¼ŒåŒä¸€æ¨¡å—çš„fixtureç›¸äº’è°ƒç”¨æ—¶å¯ä»¥ä½¿ç”¨ä¸åŒçš„nameè¿›è¡Œå‘½åã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_fixture.py</span><br><br><br><span class="hljs-meta">@pytest.fixture()                                       </span><span class="hljs-comment"># ä¸å¸¦å‚æ•°æ—¶é»˜è®¤scope=&quot;function&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">login</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è¯·è¾“å…¥è´¦å·å’Œå¯†ç è¿›è¡Œç™»å½•&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_a</span>(<span class="hljs-params">login</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case a---&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_b</span>():                                           <span class="hljs-comment"># ä¸ä¼ å‚login</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case b---&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_c</span>(<span class="hljs-params">login</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case c---&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_fixture.py&quot;</span>])<br><br><span class="hljs-string">&quot;&quot;&quot;      ï¼ï¼ï¼å®ç°åœºæ™¯ï¼šç”¨ä¾‹aéœ€è¦ç™»å½•ï¼Œç”¨ä¾‹bä¸éœ€è¦ç™»å½•ï¼Œç”¨ä¾‹céœ€è¦ç™»å½•ã€‚         </span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 3 items</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_fixture.py::test_a è¯·è¾“å…¥è´¦å·å’Œå¯†ç è¿›è¡Œç™»å½•</span><br><span class="hljs-string">PASSED                                                  [ 33%]---use case a---</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_fixture.py::test_b </span><br><span class="hljs-string">PASSED                                                  [ 66%]---use case b---</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_fixture.py::test_c è¯·è¾“å…¥è´¦å·å’Œå¯†ç è¿›è¡Œç™»å½•</span><br><span class="hljs-string">PASSED                                                  [100%]---use case c---</span><br><span class="hljs-string">============================== 3 passed in 0.04s ==============================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h2 id="5-1-conftest-py"><a href="#5-1-conftest-py" class="headerlink" title="5-1 conftest.py"></a>5-1 conftest.py</h2><ul>
<li>conftest.py<ul>
<li>é…ç½®æ–‡ä»¶é‡Œå¯ä»¥å®ç°æ•°æ®å…±äº«(å¤šä¸ª<code>.py</code>æ–‡ä»¶çš„é¢„ç½®æ“ä½œ)ï¼Œä¸ç”¨importï¼ŒPyTestå°±èƒ½è‡ªåŠ¨æŸ¥æ‰¾é…ç½®ã€‚</li>
<li>æ³¨æ„ï¼š<code>conftest.py</code>é…ç½®è„šæœ¬åç§°å›ºå®šï¼Œä¸è¿è¡Œçš„ç”¨ä¾‹è¦åœ¨åŒä¸ªpackageä¸‹ä¸”æœ‰<code>__init__.py</code>æ–‡ä»¶ã€‚</li>
</ul>
</li>
</ul>
<h3 id="1-conftest-py"><a href="#1-conftest-py" class="headerlink" title="(1) conftest.py"></a>(1) conftest.py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                            <span class="hljs-comment"># conftest.py</span><br><br><br><span class="hljs-meta">@pytest.fixture()</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">login</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è¯·è¾“å…¥è´¦å·å’Œå¯†ç è¿›è¡Œç™»å½•&quot;</span>)<br></code></pre></td></tr></table></figure>



<h3 id="2-test-conftest-py"><a href="#2-test-conftest-py" class="headerlink" title="(2) test_conftest.py"></a>(2) test_conftest.py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_conftest.py</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_a</span>(<span class="hljs-params">login</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case a---&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_b</span>():                                           <span class="hljs-comment"># ä¸ä¼ å‚login</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case b---&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_c</span>(<span class="hljs-params">login</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case c---&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_conftest.py&quot;</span>])<br><br><span class="hljs-string">&quot;&quot;&quot; ï¼å•ç‹¬è¿è¡Œtest_conftest.pyæ—¶å¯ä»¥è°ƒç”¨åˆ°conftest.pyé…ç½®æ–‡ä»¶ä¸­çš„login()æ–¹æ³•ã€‚</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 3 items</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_conftest.py::test_a è¯·è¾“å…¥è´¦å·å’Œå¯†ç è¿›è¡Œç™»å½•</span><br><span class="hljs-string">PASSED                                                  [ 33%]---use case a---</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_conftest.py::test_b </span><br><span class="hljs-string">PASSED                                                  [ 66%]---use case b---</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_conftest.py::test_c è¯·è¾“å…¥è´¦å·å’Œå¯†ç è¿›è¡Œç™»å½•</span><br><span class="hljs-string">PASSED                                                  [100%]---use case c---</span><br><span class="hljs-string">============================== 3 passed in 0.14s ==============================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h2 id="5-2-scopeå®ç°setup"><a href="#5-2-scopeå®ç°setup" class="headerlink" title="5-2 scopeå®ç°setup"></a>5-2 scopeå®ç°setup</h2><ul>
<li>scopeå®ç°setup<ul>
<li>fixtureçš„å‚æ•°<code>scope=&quot;module&quot;</code>å¯ä»¥å®ç°å¤šä¸ª<code>.py</code>è·¨æ–‡ä»¶å…±äº«å‰ç½®ã€‚</li>
<li>moduleä½œç”¨äºæ•´ä¸ª<code>.py</code>æ–‡ä»¶ï¼Œç”¨ä¾‹è°ƒç”¨æ—¶ï¼Œå‚æ•°å†™ä¸Šå‡½æ•°åç§°å³å¯ã€‚</li>
<li><code>scope=&quot;module&quot;</code>å¯ä»¥ç†è§£ä¸ºåœ¨æµ‹è¯•ç”¨ä¾‹ä¸­åŠ ä¸Šå‰ç½®æ¡ä»¶ï¼Œç±»ä¼¼setupã€‚</li>
</ul>
</li>
</ul>
<h3 id="1-ç”¨ä¾‹å…¨å±€è°ƒç”¨"><a href="#1-ç”¨ä¾‹å…¨å±€è°ƒç”¨" class="headerlink" title="(1) ç”¨ä¾‹å…¨å±€è°ƒç”¨"></a>(1) ç”¨ä¾‹å…¨å±€è°ƒç”¨</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_scope_whole.py</span><br><br><br><span class="hljs-meta">@pytest.fixture(<span class="hljs-params">scope=<span class="hljs-string">&quot;module&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">open</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æ‰“å¼€æµè§ˆå™¨å¹¶æ‰“å¼€ç™¾åº¦é¦–é¡µ&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_a</span>(<span class="hljs-params"><span class="hljs-built_in">open</span></span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---test case a: æœç´¢ pytest---&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_b</span>(<span class="hljs-params"><span class="hljs-built_in">open</span></span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---test case b: æœç´¢ pytest---&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_c</span>(<span class="hljs-params"><span class="hljs-built_in">open</span></span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---test case c: æœç´¢ pytest---&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_scope_whole.py&quot;</span>])<br><br><span class="hljs-string">&quot;&quot;&quot;           ï¼ï¼ï¼ä¸‰ä¸ªç”¨ä¾‹éƒ½è°ƒç”¨äº†openå‡½æ•°ï¼Œä½†åªåœ¨ç”¨ä¾‹aå¤„æ‰§è¡Œä¸€æ¬¡ã€‚</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 3 items</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_scope_whole.py::test_a æ‰“å¼€æµè§ˆå™¨å¹¶æ‰“å¼€ç™¾åº¦é¦–é¡µ</span><br><span class="hljs-string">PASSED                                                  [ 33%]---test case a: æœç´¢ pytest---</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_scope_whole.py::test_b </span><br><span class="hljs-string">PASSED                                                  [ 66%]---test case b: æœç´¢ pytest---</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_scope_whole.py::test_c </span><br><span class="hljs-string">PASSED                                                  [100%]---test case c: æœç´¢ pytest---</span><br><span class="hljs-string">============================== 3 passed in 0.04s ==============================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h3 id="2-éƒ¨åˆ†ç”¨ä¾‹è°ƒç”¨"><a href="#2-éƒ¨åˆ†ç”¨ä¾‹è°ƒç”¨" class="headerlink" title="(2) éƒ¨åˆ†ç”¨ä¾‹è°ƒç”¨"></a>(2) éƒ¨åˆ†ç”¨ä¾‹è°ƒç”¨</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_scope_part.py</span><br><br><br><span class="hljs-meta">@pytest.fixture(<span class="hljs-params">scope=<span class="hljs-string">&quot;module&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">open</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æ‰“å¼€æµè§ˆå™¨å¹¶æ‰“å¼€ç™¾åº¦é¦–é¡µ&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_a</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---test case a: æœç´¢ pytest---&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_b</span>(<span class="hljs-params"><span class="hljs-built_in">open</span></span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---test case b: æœç´¢ pytest---&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_c</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---test case c: æœç´¢ pytest---&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_scope_part.py&quot;</span>])<br><br><span class="hljs-string">&quot;&quot;&quot;     ï¼ï¼ï¼ç”¨ä¾‹aå’Œç”¨ä¾‹cä¸è°ƒç”¨openå‡½æ•°ï¼Œç”¨ä¾‹bè°ƒç”¨ï¼Œåªåœ¨ç”¨ä¾‹bå¤„æ‰§è¡Œä¸€æ¬¡ã€‚</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 3 items</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_scope_part.py::test_a </span><br><span class="hljs-string">PASSED                                                  [ 33%]---test case a: æœç´¢ pytest---</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_scope_part.py::test_b æ‰“å¼€æµè§ˆå™¨å¹¶æ‰“å¼€ç™¾åº¦é¦–é¡µ</span><br><span class="hljs-string">PASSED                                                  [ 66%]---test case b: æœç´¢ pytest---</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_scope_part.py::test_c </span><br><span class="hljs-string">PASSED                                                  [100%]---test case c: æœç´¢ pytest---</span><br><span class="hljs-string">============================== 3 passed in 0.14s ==============================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h2 id="5-3-yieldå®ç°teardown"><a href="#5-3-yieldå®ç°teardown" class="headerlink" title="5-3 yieldå®ç°teardown"></a>5-3 yieldå®ç°teardown</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_yield.py</span><br><br><br><span class="hljs-meta">@pytest.fixture(<span class="hljs-params">scope=<span class="hljs-string">&quot;module&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">open</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æ‰“å¼€æµè§ˆå™¨å¹¶æ‰“å¼€ç™¾åº¦é¦–é¡µ&quot;</span>)<br><br>    <span class="hljs-keyword">yield</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æ‰§è¡Œteardown&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;å…³é—­æµè§ˆå™¨&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_a</span>(<span class="hljs-params"><span class="hljs-built_in">open</span></span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---test case a: æœç´¢ pytest---&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_b</span>(<span class="hljs-params"><span class="hljs-built_in">open</span></span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---test case b: æœç´¢ pytest---&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_c</span>(<span class="hljs-params"><span class="hljs-built_in">open</span></span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---test case c: æœç´¢ pytest---&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_yield.py&quot;</span>])<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 3 items</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_yield.py::test_a æ‰“å¼€æµè§ˆå™¨å¹¶æ‰“å¼€ç™¾åº¦é¦–é¡µ</span><br><span class="hljs-string">PASSED                                                  [ 33%]---test case a: æœç´¢ pytest---</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_yield.py::test_b </span><br><span class="hljs-string">PASSED                                                  [ 66%]---test case b: æœç´¢ pytest---</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_yield.py::test_c </span><br><span class="hljs-string">PASSED                                                  [100%]---test case c: æœç´¢ pytest---</span><br><span class="hljs-string">æ‰§è¡Œteardown</span><br><span class="hljs-string">å…³é—­æµè§ˆå™¨</span><br><span class="hljs-string">============================== 3 passed in 0.05s ==============================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h3 id="1-ç”¨ä¾‹å¼‚å¸¸"><a href="#1-ç”¨ä¾‹å¼‚å¸¸" class="headerlink" title="(1) ç”¨ä¾‹å¼‚å¸¸"></a>(1) ç”¨ä¾‹å¼‚å¸¸</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_use_case_exception.py</span><br><br><br><span class="hljs-meta">@pytest.fixture(<span class="hljs-params">scope=<span class="hljs-string">&quot;module&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">open</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æ‰“å¼€æµè§ˆå™¨å¹¶æ‰“å¼€ç™¾åº¦é¦–é¡µ&quot;</span>)<br><br>    <span class="hljs-keyword">yield</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æ‰§è¡Œteardown&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;å…³é—­æµè§ˆå™¨&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_a</span>(<span class="hljs-params"><span class="hljs-built_in">open</span></span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---test case a: æœç´¢ pytest---&quot;</span>)<br>    <span class="hljs-keyword">raise</span> NameError                                     <span class="hljs-comment"># æ¨¡æ‹Ÿå¼‚å¸¸ï¼Œä¸å½±å“å…¶ä»–ç”¨ä¾‹æ‰§è¡Œ</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_b</span>(<span class="hljs-params"><span class="hljs-built_in">open</span></span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---test case b: æœç´¢ pytest---&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_c</span>(<span class="hljs-params"><span class="hljs-built_in">open</span></span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---test case c: æœç´¢ pytest---&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_use_case_exception.py&quot;</span>])<br><br><span class="hljs-string">&quot;&quot;&quot;              ï¼ï¼ï¼ç”¨ä¾‹å¼‚å¸¸æ—¶ï¼Œä¸å½±å“yieldå®ç°teardownçš„æ‰§è¡Œã€‚</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 3 items</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_use_case_exception.py::test_a æ‰“å¼€æµè§ˆå™¨å¹¶æ‰“å¼€ç™¾åº¦é¦–é¡µ</span><br><span class="hljs-string">FAILED                                                  [ 33%]---test case a: æœç´¢ pytest---</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_use_case_exception.py:12 (test_a)</span><br><span class="hljs-string">open = None</span><br><span class="hljs-string"></span><br><span class="hljs-string">    def test_a(open):</span><br><span class="hljs-string">        print(&quot;---test case a: æœç´¢ pytest---&quot;)</span><br><span class="hljs-string">&gt;       raise NameError                                 # æ¨¡æ‹Ÿå¼‚å¸¸ï¼Œä¸å½±å“å…¶ä»–ç”¨ä¾‹æ‰§è¡Œ</span><br><span class="hljs-string">E       NameError</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_use_case_exception.py:15: NameError</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_use_case_exception.py::test_b </span><br><span class="hljs-string">PASSED                                                  [ 66%]---test case b: æœç´¢ pytest---</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_use_case_exception.py::test_c </span><br><span class="hljs-string">PASSED                                                  [100%]---test case c: æœç´¢ pytest---</span><br><span class="hljs-string">æ‰§è¡Œteardown</span><br><span class="hljs-string">å…³é—­æµè§ˆå™¨</span><br><span class="hljs-string">========================= 1 failed, 2 passed in 0.45s =========================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h3 id="2-setupå¼‚å¸¸"><a href="#2-setupå¼‚å¸¸" class="headerlink" title="(2) setupå¼‚å¸¸"></a>(2) setupå¼‚å¸¸</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_setup_exception.py</span><br><br><br><span class="hljs-meta">@pytest.fixture(<span class="hljs-params">scope=<span class="hljs-string">&quot;module&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">open</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æ‰“å¼€æµè§ˆå™¨å¹¶æ‰“å¼€ç™¾åº¦é¦–é¡µ&quot;</span>)<br>    <span class="hljs-keyword">raise</span> NameError                                     <span class="hljs-comment"># æ¨¡æ‹Ÿsetupå¼‚å¸¸</span><br><br>    <span class="hljs-keyword">yield</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æ‰§è¡Œteardown&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;å…³é—­æµè§ˆå™¨&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_a</span>(<span class="hljs-params"><span class="hljs-built_in">open</span></span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---test case a: æœç´¢ pytest---&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_b</span>(<span class="hljs-params"><span class="hljs-built_in">open</span></span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---test case b: æœç´¢ pytest---&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_c</span>(<span class="hljs-params"><span class="hljs-built_in">open</span></span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---test case c: æœç´¢ pytest---&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_setup_exception.py&quot;</span>])<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 3 items</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_setup_exception.py::test_a </span><br><span class="hljs-string">ERROR                                                   [ 33%]æ‰“å¼€æµè§ˆå™¨å¹¶æ‰“å¼€ç™¾åº¦é¦–é¡µ</span><br><span class="hljs-string"></span><br><span class="hljs-string">test setup failed</span><br><span class="hljs-string">@pytest.fixture(scope=&quot;module&quot;)</span><br><span class="hljs-string">    def open():</span><br><span class="hljs-string">        print(&quot;æ‰“å¼€æµè§ˆå™¨å¹¶æ‰“å¼€ç™¾åº¦é¦–é¡µ&quot;)</span><br><span class="hljs-string">&gt;       raise NameError                                 # æ¨¡æ‹Ÿsetupå¼‚å¸¸</span><br><span class="hljs-string">E       NameError</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_setup_exception.py:7: NameError</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_setup_exception.py::test_b </span><br><span class="hljs-string">ERROR                                                   [ 66%]</span><br><span class="hljs-string">test setup failed</span><br><span class="hljs-string">@pytest.fixture(scope=&quot;module&quot;)</span><br><span class="hljs-string">    def open():</span><br><span class="hljs-string">        print(&quot;æ‰“å¼€æµè§ˆå™¨å¹¶æ‰“å¼€ç™¾åº¦é¦–é¡µ&quot;)</span><br><span class="hljs-string">&gt;       raise NameError                                 # æ¨¡æ‹Ÿsetupå¼‚å¸¸</span><br><span class="hljs-string">E       NameError</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_setup_exception.py:7: NameError</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_setup_exception.py::test_c </span><br><span class="hljs-string">ERROR                                                   [100%]</span><br><span class="hljs-string">test setup failed</span><br><span class="hljs-string">@pytest.fixture(scope=&quot;module&quot;)</span><br><span class="hljs-string">    def open():</span><br><span class="hljs-string">        print(&quot;æ‰“å¼€æµè§ˆå™¨å¹¶æ‰“å¼€ç™¾åº¦é¦–é¡µ&quot;)</span><br><span class="hljs-string">&gt;       raise NameError                                 # æ¨¡æ‹Ÿsetupå¼‚å¸¸</span><br><span class="hljs-string">E       NameError</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_setup_exception.py:7: NameError</span><br><span class="hljs-string">============================== 3 errors in 0.37s ==============================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h3 id="3-é…åˆwithä½¿ç”¨"><a href="#3-é…åˆwithä½¿ç”¨" class="headerlink" title="(3) é…åˆwithä½¿ç”¨*"></a>(3) é…åˆwithä½¿ç”¨*</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                            <span class="hljs-comment"># test_with.py</span><br><span class="hljs-keyword">import</span> smtplib<br><br><br><span class="hljs-meta">@pytest.fixture(<span class="hljs-params">scope=<span class="hljs-string">&quot;module&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">smtp</span>():<br>    <span class="hljs-keyword">with</span> smtplib.SMTP(<span class="hljs-string">&quot;smtp.gmail.com&quot;</span>, <span class="hljs-number">587</span>, timeout=<span class="hljs-number">5</span>) <span class="hljs-keyword">as</span> smtp:<br>        <span class="hljs-keyword">yield</span> smtp                                       <span class="hljs-comment"># smtpå¯¹è±¡è‡ªåŠ¨å…³é—­æ—¶ï¼Œwithè¯­å¥ç»“æŸ</span><br></code></pre></td></tr></table></figure>



<h2 id="5-4-addfinalizerç»ˆç»“å‡½æ•°"><a href="#5-4-addfinalizerç»ˆç»“å‡½æ•°" class="headerlink" title="5-4 addfinalizerç»ˆç»“å‡½æ•°"></a>5-4 addfinalizerç»ˆç»“å‡½æ•°</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_addfinalizer.py</span><br><br><br><span class="hljs-meta">@pytest.fixture(<span class="hljs-params">scope=<span class="hljs-string">&quot;module&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_addfinalizer</span>(<span class="hljs-params">request</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æ‰“å¼€æµè§ˆå™¨&quot;</span>)<br>    test = <span class="hljs-string">&quot;test_addfinalizer&quot;</span>                          <span class="hljs-comment"># å‰ç½®æ“ä½œsetup</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">fin</span>():                                          <span class="hljs-comment"># åç½®æ“ä½œteardown</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;å…³é—­æµè§ˆå™¨&quot;</span>)<br><br>    request.addfinalizer(fin)<br>    <span class="hljs-keyword">return</span> test                                         <span class="hljs-comment"># è¿”å›å‰ç½®æ“ä½œçš„å˜é‡</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_case</span>(<span class="hljs-params">test_addfinalizer</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---test cases---&quot;</span>, test_addfinalizer)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 1 item</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_addfinalizer.py::test_case æ‰“å¼€æµè§ˆå™¨</span><br><span class="hljs-string">PASSED                                                  [100%]---test cases--- test_addfinalizer</span><br><span class="hljs-string">å…³é—­æµè§ˆå™¨</span><br><span class="hljs-string">============================== 1 passed in 0.04s ==============================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h2 id="5-5-è°ƒç”¨fixtureçš„3ç§æ–¹æ³•"><a href="#5-5-è°ƒç”¨fixtureçš„3ç§æ–¹æ³•" class="headerlink" title="5-5 è°ƒç”¨fixtureçš„3ç§æ–¹æ³•"></a>5-5 è°ƒç”¨fixtureçš„3ç§æ–¹æ³•</h2><ul>
<li>è°ƒç”¨fixtureçš„3ç§æ–¹æ³•<ul>
<li>å‡½æ•°æˆ–ç±»çš„æ–¹æ³•ä¸­ä¼ fixtureçš„å‡½æ•°å‚æ•°åç§°ã€‚</li>
<li>ç”¨è£…é¥°å™¨<code>@pytest.mark.usefixtures()</code>ä¿®é¥°ã€‚</li>
<li>è®¾ç½®fixtureçš„å‚æ•°ä¸º<code>autouse=True</code>æ¥è‡ªåŠ¨ä½¿ç”¨ã€‚</li>
</ul>
</li>
</ul>
<h3 id="1-ç”¨ä¾‹fixtureä¼ å‚"><a href="#1-ç”¨ä¾‹fixtureä¼ å‚" class="headerlink" title="(1) ç”¨ä¾‹fixtureä¼ å‚"></a>(1) ç”¨ä¾‹fixtureä¼ å‚</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_calling_in_parameter.py</span><br><br><br><span class="hljs-meta">@pytest.fixture(<span class="hljs-params">scope=<span class="hljs-string">&quot;function&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">start</span>(<span class="hljs-params">request</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---å¼€å§‹æ‰§è¡Œå‡½æ•°---&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_a</span>(<span class="hljs-params">start</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case a---&quot;</span>)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">TestCase</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_b</span>(<span class="hljs-params">self, start</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case b---&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_c</span>(<span class="hljs-params">self, start</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case c---&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_calling_in_parameter.py&quot;</span>])<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 3 items</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_calling_in_parameter.py::test_a ---å¼€å§‹æ‰§è¡Œå‡½æ•°---</span><br><span class="hljs-string">PASSED                                                  [ 33%]---use case a---</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_calling_in_parameter.py::TestCase::test_b ---å¼€å§‹æ‰§è¡Œå‡½æ•°---</span><br><span class="hljs-string">PASSED                                                  [ 66%]---use case b---</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_calling_in_parameter.py::TestCase::test_c ---å¼€å§‹æ‰§è¡Œå‡½æ•°---</span><br><span class="hljs-string">PASSED                                                  [100%]---use case c---</span><br><span class="hljs-string">============================== 3 passed in 0.06s ==============================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h3 id="2-è£…é¥°å™¨usefixtures"><a href="#2-è£…é¥°å™¨usefixtures" class="headerlink" title="(2) è£…é¥°å™¨usefixtures"></a>(2) è£…é¥°å™¨usefixtures</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_calling_usefixtures.py</span><br><br><br><span class="hljs-meta">@pytest.fixture(<span class="hljs-params">scope=<span class="hljs-string">&quot;function&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">start</span>(<span class="hljs-params">request</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---å¼€å§‹æ‰§è¡Œå‡½æ•°---&quot;</span>)<br><br><br><span class="hljs-meta">@pytest.mark.usefixtures(<span class="hljs-params"><span class="hljs-string">&quot;start&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_a</span>(<span class="hljs-params">start</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case a---&quot;</span>)<br><br><br><span class="hljs-meta">@pytest.mark.usefixtures(<span class="hljs-params"><span class="hljs-string">&quot;start&quot;</span></span>)</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">TestCase</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_b</span>(<span class="hljs-params">self, start</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case b---&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_c</span>(<span class="hljs-params">self, start</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case c---&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_calling_usefixtures.py&quot;</span>])<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 3 items</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_calling_usefixtures.py::test_a ---å¼€å§‹æ‰§è¡Œå‡½æ•°---</span><br><span class="hljs-string">PASSED                                                  [ 33%]---use case a---</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_calling_usefixtures.py::TestCase::test_b ---å¼€å§‹æ‰§è¡Œå‡½æ•°---</span><br><span class="hljs-string">PASSED                                                  [ 66%]---use case b---</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_calling_usefixtures.py::TestCase::test_c ---å¼€å§‹æ‰§è¡Œå‡½æ•°---</span><br><span class="hljs-string">PASSED                                                  [100%]---use case c---</span><br><span class="hljs-string">============================== 3 passed in 0.10s ==============================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h3 id="3-è®¾ç½®autouse-x3D-True"><a href="#3-è®¾ç½®autouse-x3D-True" class="headerlink" title="(3) è®¾ç½®autouse&#x3D;True"></a>(3) è®¾ç½®autouse&#x3D;True</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_calling_function.py</span><br><br><br><span class="hljs-meta">@pytest.fixture(<span class="hljs-params">scope=<span class="hljs-string">&quot;module&quot;</span>, autouse=<span class="hljs-literal">True</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">start</span>(<span class="hljs-params">request</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n---å¼€å§‹æ‰§è¡Œæ¨¡å—---&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;module: %s&quot;</span> % request.module.__name__)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---æ‰“å¼€æµè§ˆå™¨---&quot;</span>)<br><br>    <span class="hljs-keyword">yield</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---ç»“æŸæµ‹è¯•---&quot;</span>)<br><br><br><span class="hljs-meta">@pytest.fixture(<span class="hljs-params">scope=<span class="hljs-string">&quot;function&quot;</span>, autouse=<span class="hljs-literal">True</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">open_home</span>(<span class="hljs-params">request</span>):                                 <span class="hljs-comment"># å‡½æ•°å®ç°</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;function: %s \n---è¿”å›é¦–é¡µ---&quot;</span> % request.function.__name__)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_a</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case a---&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_b</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case b---&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_calling_function.py&quot;</span>])<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 2 items</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_calling_function.py::test_a </span><br><span class="hljs-string">---å¼€å§‹æ‰§è¡Œæ¨¡å—---</span><br><span class="hljs-string">module: test_calling_function</span><br><span class="hljs-string">---æ‰“å¼€æµè§ˆå™¨---</span><br><span class="hljs-string">function: test_a </span><br><span class="hljs-string">---è¿”å›é¦–é¡µ---</span><br><span class="hljs-string">PASSED                                                  [ 50%]---use case a---</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_calling_function.py::test_b function: test_b </span><br><span class="hljs-string">---è¿”å›é¦–é¡µ---</span><br><span class="hljs-string">PASSED                                                  [100%]---use case b---</span><br><span class="hljs-string">---ç»“æŸæµ‹è¯•---</span><br><span class="hljs-string">============================== 2 passed in 0.06s ==============================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>

<ul>
<li>è®¾ç½®autouse&#x3D;True<ul>
<li>startè®¾ç½®scopeä¸ºmoduleçº§åˆ«ï¼Œåœ¨å½“å‰ç”¨ä¾‹æ¨¡å—ä¸­åªæ‰§è¡Œä¸€æ¬¡ï¼Œ<code>autouse=True</code>è‡ªåŠ¨ä½¿ç”¨ã€‚</li>
<li>open_homeè®¾ç½®scopeä¸ºfunctionçº§åˆ«ï¼Œæ¯ä¸ªç”¨ä¾‹å‰éƒ½è°ƒç”¨ä¸€æ¬¡ï¼Œ<code>autouse=True</code>è‡ªåŠ¨ä½¿ç”¨ã€‚</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_calling_class.py</span><br><br><br><span class="hljs-meta">@pytest.fixture(<span class="hljs-params">scope=<span class="hljs-string">&quot;module&quot;</span>, autouse=<span class="hljs-literal">True</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">start</span>(<span class="hljs-params">request</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n---å¼€å§‹æ‰§è¡Œæ¨¡å—---&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;module: %s&quot;</span> % request.module.__name__)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---æ‰“å¼€æµè§ˆå™¨---&quot;</span>)<br><br>    <span class="hljs-keyword">yield</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---ç»“æŸæµ‹è¯•---&quot;</span>)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">TestCase</span>:<br><span class="hljs-meta">    @pytest.fixture(<span class="hljs-params">scope=<span class="hljs-string">&quot;function&quot;</span>, autouse=<span class="hljs-literal">True</span></span>)</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">open_home</span>(<span class="hljs-params">self, request</span>):                       <span class="hljs-comment"># ç±»å®ç°</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;function: %s \n---è¿”å›é¦–é¡µ---&quot;</span> % request.function.__name__)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_a</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case a---&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_b</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case b---&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_calling_class.py&quot;</span>])<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 2 items</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_calling_class.py::TestCase::test_a </span><br><span class="hljs-string">---å¼€å§‹æ‰§è¡Œæ¨¡å—---</span><br><span class="hljs-string">module: test_calling_class</span><br><span class="hljs-string">---æ‰“å¼€æµè§ˆå™¨---</span><br><span class="hljs-string">function: test_a </span><br><span class="hljs-string">---è¿”å›é¦–é¡µ---</span><br><span class="hljs-string">PASSED                                                  [ 50%]---use case a---</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_calling_class.py::TestCase::test_b function: test_b </span><br><span class="hljs-string">---è¿”å›é¦–é¡µ---</span><br><span class="hljs-string">PASSED                                                  [100%]---use case b---</span><br><span class="hljs-string">---ç»“æŸæµ‹è¯•---</span><br><span class="hljs-string">============================== 2 passed in 0.04s ==============================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h1 id="6-è‡ªå®šä¹‰æ ‡è®°mark"><a href="#6-è‡ªå®šä¹‰æ ‡è®°mark" class="headerlink" title="6 è‡ªå®šä¹‰æ ‡è®°mark"></a>6 è‡ªå®šä¹‰æ ‡è®°mark</h1><ul>
<li>è‡ªå®šä¹‰æ ‡è®°mark<ul>
<li>è‡ªå®šä¹‰æ ‡è®°å¯ä»¥å°†ä¸€ä¸ªWebé¡¹ç›®åˆ’åˆ†ä¸ºå¤šä¸ªæ¨¡å—ï¼Œç„¶åæŒ‡å®šæ¨¡å—åç§°è¿›è¡Œæ‰§è¡Œã€‚</li>
<li>APPè‡ªåŠ¨åŒ–æ—¶ï¼Œè‹¥æƒ³è®©Androidä¸IOSå…±ç”¨ä¸€å¥—ä»£ç ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ ‡è®°æŒ‡å®šåç§°ã€‚</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_mark.py</span><br><br><br><span class="hljs-meta">@pytest.mark.a</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_a</span>():                                           <span class="hljs-comment"># æ ‡è®°test_a()ä¸ºa</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case a---&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_b</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case b---&quot;</span>)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">TestCase</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_c</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case c---&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_mark.py&quot;</span>, <span class="hljs-string">&quot;-m=a&quot;</span>])<br><br><span class="hljs-comment"># pytest -v -m a test_mark.py</span><br><span class="hljs-string">&quot;&quot;&quot; ï¼æ­¤æ—¶aæ ‡ç­¾ä¸ºæœªè¯†åˆ«æ ‡ç­¾ï¼Œæ²¡æ³¨å†Œç›´æ¥ä½¿ç”¨å°†å¼¹å‡ºè­¦å‘Šä¿¡æ¯ï¼Œä¸æ³¨å†Œä»å¯æŒ‘é€‰ç”¨ä¾‹ã€‚</span><br><span class="hljs-string">=========================== test session starts ===============================</span><br><span class="hljs-string">...</span><br><span class="hljs-string">collected 3 items / 2 deselected / 1 selected</span><br><span class="hljs-string">test_mark.py::test_a PASSED                             [100%]</span><br><span class="hljs-string">============================ warnings summary =================================</span><br><span class="hljs-string">...DeprecationWarning: Using or importing the ABCs from &#x27;collections&#x27; instead of from </span><br><span class="hljs-string">&#x27;collections.abc&#x27; is deprecated since Python 3.3, and in 3.10 it will stop working</span><br><span class="hljs-string">    return isinstance(x, collections.Callable)</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_mark.py:4</span><br><span class="hljs-string">  ...\test_mark.py:4: PytestUnknownMarkWarning: Unknown pytest.mark.a - is this a typo?</span><br><span class="hljs-string">  You can register custom marks to avoid this warning - for details, </span><br><span class="hljs-string">  see https://docs.pytest.org/en/stable/mark.html</span><br><span class="hljs-string">    @pytest.mark.a</span><br><span class="hljs-string"></span><br><span class="hljs-string">-- Docs: https://docs.pytest.org/en/stable/warnings.html</span><br><span class="hljs-string">================ 1 passed, 2 deselected, 1 warnings in 0.04s ==================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>

<ul>
<li><a href="https://stitch-top.github.io/2023/03/03/ce-shi-kuang-jia/tf02-pytest-ce-shi-kuang-jia/#1-1-%E7%94%A8%E4%BE%8B%E6%89%A7%E8%A1%8C%E8%A7%84%E5%88%99">ç”¨ä¾‹æ‰§è¡Œè§„åˆ™</a><ul>
<li>å‘½ä»¤çª—å£ä¸‹åªè¿è¡Œç”¨tagnameæ ‡è®°çš„æµ‹è¯•ç”¨ä¾‹æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤ï¼š<code>pytest -v -m tagname</code>ã€‚</li>
<li>è‹¥ä¸æƒ³æ‰§è¡Œtagnameæ ‡è®°çš„ç”¨ä¾‹ï¼Œæ–‡ä»¶å†…å®¹å¯¹åº”ä¿®æ”¹ï¼Œä½¿ç”¨å‘½ä»¤ï¼š<code>pytest -v -m &quot;not tagname&quot;</code>ã€‚</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_mark.py</span><br><br><br><span class="hljs-meta">@pytest.mark.a</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_a</span>():                                           <span class="hljs-comment"># æ ‡è®°test_a()ä¸ºa</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case a---&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_b</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case b---&quot;</span>)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">TestCase</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_c</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case c---&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_mark.py&quot;</span>, <span class="hljs-string">&quot;-m=not a&quot;</span>])<br><br><span class="hljs-comment"># pytest -v -m &quot;not a&quot; test_mark.py</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">============================ test session starts ==============================</span><br><span class="hljs-string">...</span><br><span class="hljs-string">collected 3 items / 1 deselected / 2 selected</span><br><span class="hljs-string">test_mark.py::test_b PASSED                             [ 50%] </span><br><span class="hljs-string">test_mark.py::TestCase::test_c PASSED                   [100%]</span><br><span class="hljs-string">============================= warnings summary ================================</span><br><span class="hljs-string">...DeprecationWarning: Using or importing the ABCs from &#x27;collections&#x27; instead of from </span><br><span class="hljs-string">&#x27;collections.abc&#x27; is deprecated since Python 3.3, and in 3.10 it will stop working</span><br><span class="hljs-string">    return isinstance(x, collections.Callable)</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_mark.py:4</span><br><span class="hljs-string">  ...\test_mark.py:4: PytestUnknownMarkWarning: Unknown pytest.mark.a - is this a typo?  </span><br><span class="hljs-string">  You can register custom marks to avoid this warning - for details, </span><br><span class="hljs-string">  see https://docs.pytest.org/en/stable/mark.html</span><br><span class="hljs-string">    @pytest.mark.a</span><br><span class="hljs-string"></span><br><span class="hljs-string">-- Docs: https://docs.pytest.org/en/stable/warnings.html</span><br><span class="hljs-string">================ 2 passed, 1 deselected, 1 warnings in 0.05s ==================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h2 id="6-1-é‡å†™æ³¨å†Œæ ‡ç­¾"><a href="#6-1-é‡å†™æ³¨å†Œæ ‡ç­¾" class="headerlink" title="6-1 é‡å†™æ³¨å†Œæ ‡ç­¾"></a>6-1 é‡å†™æ³¨å†Œæ ‡ç­¾</h2><ul>
<li>é‡å†™æ³¨å†Œæ ‡ç­¾<ul>
<li>æ ¹ç›®å½•åˆ›å»º<code>conftest.py</code>æ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶ä¸­é‡å†™pytest_configureå‡½æ•°çš„æ–¹å¼å¯ä»¥æ³¨å†Œæ ‡ç­¾ã€‚</li>
<li>å‡½æ•°åpytest_configureå’Œå‚æ•°configæ˜¯å›ºå®šçš„ï¼Œå”¯ä¸€éœ€è¦å˜æ›´çš„æ˜¯æ³¨å†Œæ ‡ç­¾çš„åå­—å’Œæè¿°ã€‚</li>
</ul>
</li>
</ul>
<h3 id="1-conftest-py-1"><a href="#1-conftest-py-1" class="headerlink" title="(1) conftest.py"></a>(1) conftest.py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">pytest_configure</span>(<span class="hljs-params">config</span>):                            <span class="hljs-comment"># conftest.py</span><br>    config.addinivalue_line(<br>        <span class="hljs-string">&quot;markers&quot;</span>, <span class="hljs-string">&quot;a: a test&quot;</span><br>    )<br></code></pre></td></tr></table></figure>



<h3 id="2-test-mark-py"><a href="#2-test-mark-py" class="headerlink" title="(2) test_mark.py"></a>(2) test_mark.py</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs Powershell">pytest <span class="hljs-literal">-v</span> <span class="hljs-literal">-m</span> a test_mark.py                              <span class="hljs-comment"># test_mark.pyå†…å®¹ä¸å˜</span><br><span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;</span><br><span class="hljs-string">=========================== test session starts ===============================</span><br><span class="hljs-string">...</span><br><span class="hljs-string">collected 3 items / 2 deselected / 1 selected</span><br><span class="hljs-string">test_mark.py::test_a PASSED                              [100%]</span><br><span class="hljs-string">===================== 1 passed, 2 deselected in 0.04s =========================</span><br><span class="hljs-string">&quot;</span><span class="hljs-string">&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h2 id="6-2-é…ç½®æ³¨å†Œæ ‡ç­¾"><a href="#6-2-é…ç½®æ³¨å†Œæ ‡ç­¾" class="headerlink" title="6-2 é…ç½®æ³¨å†Œæ ‡ç­¾"></a>6-2 é…ç½®æ³¨å†Œæ ‡ç­¾</h2><ul>
<li>é…ç½®æ³¨å†Œæ ‡ç­¾<ul>
<li>è¿˜æœ‰ä¸€ç§æ›´åŠ ä¾¿æ·çš„æ³¨å†Œæ ‡ç­¾çš„æ–¹å¼ï¼Œå³åœ¨<code>pytest.ini</code>é…ç½®æ–‡ä»¶ä¸­è¿›è¡Œè¯­æ³•é…ç½®ã€‚</li>
<li>åŒæ ·åœ¨æ ¹ç›®å½•åˆ›å»º<code>pytest.ini</code>æ–‡ä»¶ï¼Œåªéœ€è¦åœ¨æ–‡ä»¶ä¸­ç¼–å†™å¦‚ä¸‹é…ç½®å†…å®¹å°±å¯ä»¥äº†ã€‚</li>
</ul>
</li>
</ul>
<h3 id="1-pytest-ini"><a href="#1-pytest-ini" class="headerlink" title="(1) pytest.ini"></a>(1) pytest.ini</h3><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Ini"><span class="hljs-section">[pytest]</span>                                                 <span class="hljs-comment"># pytest.ini</span><br><br><br><span class="hljs-attr">markers</span> =<br>    a: a tests<br></code></pre></td></tr></table></figure>



<h3 id="2-test-mark-py-1"><a href="#2-test-mark-py-1" class="headerlink" title="(2) test_mark.py"></a>(2) test_mark.py</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs Powershell">pytest <span class="hljs-literal">-v</span> <span class="hljs-literal">-m</span> <span class="hljs-string">&quot;not a&quot;</span> test_mark.py                        <span class="hljs-comment"># test_mark.pyå†…å®¹ä¸å˜</span><br><span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;         ï¼ï¼ï¼è¯¥æ–¹æ³•ä¾¿æ·ç®€å•ï¼Œå®é™…è‡ªåŠ¨åŒ–è„šæœ¬å¼€å‘æ—¶ï¼Œæ›´æ¨èä½¿ç”¨ã€‚               </span><br><span class="hljs-string">============================ test session starts ==============================</span><br><span class="hljs-string">...</span><br><span class="hljs-string">collected 3 items / 1 deselected / 2 selected</span><br><span class="hljs-string">test_mark.py::test_b PASSED                              [ 50%] </span><br><span class="hljs-string">test_mark.py::TestCase::test_c PASSED                    [100%]</span><br><span class="hljs-string">===================== 2 passed, 1 deselected in 0.03s =========================</span><br><span class="hljs-string">&quot;</span><span class="hljs-string">&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h2 id="6-3-çµæ´»æŒ‘é€‰ç”¨ä¾‹"><a href="#6-3-çµæ´»æŒ‘é€‰ç”¨ä¾‹" class="headerlink" title="6-3 çµæ´»æŒ‘é€‰ç”¨ä¾‹"></a>6-3 çµæ´»æŒ‘é€‰ç”¨ä¾‹</h2><h3 id="1-pytest-ini-1"><a href="#1-pytest-ini-1" class="headerlink" title="(1) pytest.ini"></a>(1) pytest.ini</h3><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs Ini"><span class="hljs-section">[pytest]</span>                                                 <span class="hljs-comment"># pytest.ini</span><br><br><br><span class="hljs-attr">markers</span> =<br>    a: a tests<br>    b: b tests<br>    function: function tests<br></code></pre></td></tr></table></figure>



<h3 id="2-test-mark-flexible-py"><a href="#2-test-mark-flexible-py" class="headerlink" title="(2) test_mark_flexible.py"></a>(2) test_mark_flexible.py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_mark_flexible.py</span><br><br><br><span class="hljs-meta">@pytest.mark.a                                          </span><span class="hljs-comment"># æ¯ä¸ªæµ‹è¯•å‡½æ•°å¯ä»¥è‡ªå®šä¹‰å¤šä¸ªæ ‡ç­¾</span><br><span class="hljs-meta">@pytest.mark.function                                   </span><span class="hljs-comment"># å®é™…å¼€å‘ä¸­æŸäº›ç”¨ä¾‹æ—¢å¯ç”¨ä½œåŠŸèƒ½ç”¨ä¾‹</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_a</span>():                                           <span class="hljs-comment"># ä¹Ÿå¯ä»¥ç”¨ä½œå†’çƒŸæµ‹è¯•ç”¨ä¾‹</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case a---&quot;</span>)<br><br><br><span class="hljs-meta">@pytest.mark.b</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_b</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case b---&quot;</span>)<br><br><br><span class="hljs-meta">@pytest.mark.function</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">TestCase</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_c</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case c---&quot;</span>)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">pytest -v -m a test_mark_flexible.py</span><br><span class="hljs-string">pytest -v -m &quot;not a&quot; test_mark_flexible.py</span><br><span class="hljs-string">pytest -v -m &quot;a and b&quot; test_mark_flexible.py</span><br><span class="hljs-string">pytest -v -m &quot;a or function&quot; test_mark_flexible.py</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h1 id="7-ç”¨ä¾‹çš„å‚æ•°åŒ–è®¾ç½®"><a href="#7-ç”¨ä¾‹çš„å‚æ•°åŒ–è®¾ç½®" class="headerlink" title="7 ç”¨ä¾‹çš„å‚æ•°åŒ–è®¾ç½®"></a>7 ç”¨ä¾‹çš„å‚æ•°åŒ–è®¾ç½®</h1><ul>
<li>ç”¨ä¾‹çš„å‚æ•°åŒ–è®¾ç½®<ul>
<li>å‚æ•°åŒ–æ–¹å¼æœ‰ä¸¤ç§ï¼šparametrizeå‚æ•°åŒ–å’Œfixtureå‚æ•°åŒ–ã€‚</li>
<li>ä½¿ç”¨<code>@pytest.mark.parametrize</code>è£…é¥°å™¨å®ç°ç”¨ä¾‹çš„å‚æ•°åŒ–ã€‚</li>
<li>parametrizeè¿˜å¯ä»¥ç»“åˆå†…ç½®å‡½æ•°ï¼Œæ ‡è®°æµ‹è¯•å®ä¾‹è¿›è¡Œå‚æ•°åŒ–ã€‚</li>
</ul>
</li>
</ul>
<h2 id="7-1-parametrize"><a href="#7-1-parametrize" class="headerlink" title="7-1 parametrize"></a>7-1 parametrize</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_param.py</span><br><br><br><span class="hljs-meta">@pytest.mark.parametrize(<span class="hljs-params"><span class="hljs-string">&quot;test_input, expected&quot;</span>, [(<span class="hljs-params"><span class="hljs-string">&quot;3+3&quot;</span>, <span class="hljs-number">6</span></span>), (<span class="hljs-params"><span class="hljs-string">&quot;2+4&quot;</span>, <span class="hljs-number">6</span></span>), (<span class="hljs-params"><span class="hljs-string">&quot;6*1&quot;</span>, <span class="hljs-number">6</span></span>)]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_eval</span>(<span class="hljs-params">test_input, expected</span>):<br>    <span class="hljs-keyword">assert</span> <span class="hljs-built_in">eval</span>(test_input) == expected<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_param.py&quot;</span>])<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 3 items</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_param.py::test_eval[3+3-6] PASSED                  [ 33%]</span><br><span class="hljs-string">test_param.py::test_eval[2+4-6] PASSED                  [ 66%]</span><br><span class="hljs-string">test_param.py::test_eval[6*1-6] PASSED                  [100%]</span><br><span class="hljs-string">============================== 3 passed in 0.67s ==============================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h3 id="1-ç»“åˆå†…ç½®å‡½æ•°"><a href="#1-ç»“åˆå†…ç½®å‡½æ•°" class="headerlink" title="(1) ç»“åˆå†…ç½®å‡½æ•°"></a>(1) ç»“åˆå†…ç½®å‡½æ•°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_param_function.py</span><br><br><br><span class="hljs-meta">@pytest.mark.parametrize(<span class="hljs-params"><span class="hljs-string">&quot;test_input, expected&quot;</span>,</span></span><br><span class="hljs-params"><span class="hljs-meta">                         [(<span class="hljs-params"><span class="hljs-string">&quot;3+3&quot;</span>, <span class="hljs-number">6</span></span>), (<span class="hljs-params"><span class="hljs-string">&quot;2+4&quot;</span>, <span class="hljs-number">6</span></span>), pytest.param(<span class="hljs-params"><span class="hljs-string">&quot;6*1&quot;</span>, <span class="hljs-number">6</span>, marks=pytest.mark.xfail</span>)]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_eval</span>(<span class="hljs-params">test_input, expected</span>):<br>    <span class="hljs-keyword">assert</span> <span class="hljs-built_in">eval</span>(test_input) == expected<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_param_function.py&quot;</span>])<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 3 items</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_param_function.py::test_eval[3+3-6] PASSED         [ 33%]</span><br><span class="hljs-string">test_param_function.py::test_eval[2+4-6] PASSED         [ 66%]</span><br><span class="hljs-string">test_param_function.py::test_eval[6*1-6] XPASS          [100%]</span><br><span class="hljs-string">======================== 2 passed, 1 xpassed in 0.14s =========================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h3 id="2-å‚æ•°ç»„åˆä½¿ç”¨"><a href="#2-å‚æ•°ç»„åˆä½¿ç”¨" class="headerlink" title="(2) å‚æ•°ç»„åˆä½¿ç”¨"></a>(2) å‚æ•°ç»„åˆä½¿ç”¨</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_param_combination.py</span><br><br><br><span class="hljs-meta">@pytest.mark.parametrize(<span class="hljs-params"><span class="hljs-string">&quot;x&quot;</span>, [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>]</span>)</span><br><span class="hljs-meta">@pytest.mark.parametrize(<span class="hljs-params"><span class="hljs-string">&quot;y&quot;</span>, [<span class="hljs-number">2</span>, <span class="hljs-number">3</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_case</span>(<span class="hljs-params">x, y</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Test data: x---%s, y---%s&quot;</span> % (x, y))<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_param_combination.py&quot;</span>])<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 4 items</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_param_combination.py::test_case[2-0] PASSED        [ 25%]Test data: x---0, y---2</span><br><span class="hljs-string">test_param_combination.py::test_case[2-1] PASSED        [ 50%]Test data: x---1, y---2</span><br><span class="hljs-string">test_param_combination.py::test_case[3-0] PASSED        [ 75%]Test data: x---0, y---3</span><br><span class="hljs-string">test_param_combination.py::test_case[3-1] PASSED        [100%]Test data: x---1, y---3</span><br><span class="hljs-string">============================== 4 passed in 0.05s ==============================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h3 id="3-å‡½æ•°ä¼ å‚æ“ä½œ"><a href="#3-å‡½æ•°ä¼ å‚æ“ä½œ" class="headerlink" title="(3) å‡½æ•°ä¼ å‚æ“ä½œ"></a>(3) å‡½æ•°ä¼ å‚æ“ä½œ</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_param_in.py</span><br><br>info = [(<span class="hljs-string">&quot;admin&quot;</span>, <span class="hljs-string">&quot;12345&quot;</span>), (<span class="hljs-string">&quot;admin&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)]              <span class="hljs-comment"># æµ‹è¯•ç™»å½•æ•°æ®</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">login</span>(<span class="hljs-params">username, password</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è´¦æˆ·: %s&quot;</span> % username)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;å¯†ç : %s&quot;</span> % password)<br>    <span class="hljs-keyword">if</span> password:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><br><span class="hljs-meta">@pytest.mark.parametrize(<span class="hljs-params"><span class="hljs-string">&quot;username, password&quot;</span>, info</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_login</span>(<span class="hljs-params">username, password</span>):<br>    result = login(username, password)<br>    <span class="hljs-keyword">assert</span> result == <span class="hljs-literal">True</span>, <span class="hljs-string">&quot;æŠ¥é”™åŸå› ï¼šå¯†ç ä¸ºç©º&quot;</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_param_in.py&quot;</span>])<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 2 items</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_param_in.py::test_login[admin-12345] PASSED        [ 50%]è´¦æˆ·: admin</span><br><span class="hljs-string">å¯†ç : 12345</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_param_in.py::test_login[admin-] FAILED             [100%]è´¦æˆ·: admin</span><br><span class="hljs-string">å¯†ç : </span><br><span class="hljs-string"></span><br><span class="hljs-string">test_param_in.py:14 (test_login[admin-])</span><br><span class="hljs-string">False != True</span><br><span class="hljs-string"></span><br><span class="hljs-string">Expected :True</span><br><span class="hljs-string">Actual   :False</span><br><span class="hljs-string">&lt;Click to see difference&gt;</span><br><span class="hljs-string"></span><br><span class="hljs-string">username = &#x27;admin&#x27;, password = &#x27;&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">    @pytest.mark.parametrize(&quot;username, password&quot;, info)</span><br><span class="hljs-string">    def test_login(username, password):</span><br><span class="hljs-string">        result = login(username, password)</span><br><span class="hljs-string">&gt;       assert result == True, &quot;æŠ¥é”™åŸå› ï¼šå¯†ç ä¸ºç©º&quot;</span><br><span class="hljs-string">E       AssertionError: æŠ¥é”™åŸå› ï¼šå¯†ç ä¸ºç©º</span><br><span class="hljs-string">E       assert False == True</span><br><span class="hljs-string">E         +False</span><br><span class="hljs-string">E         -True</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_param_in.py:18: AssertionError</span><br><span class="hljs-string">========================= 1 failed, 1 passed in 0.41s =========================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h2 id="7-2-fixtureä¼ å‚"><a href="#7-2-fixtureä¼ å‚" class="headerlink" title="7-2 fixtureä¼ å‚"></a>7-2 fixtureä¼ å‚</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_fixture.py</span><br><br>info = [<span class="hljs-string">&quot;admin1&quot;</span>, <span class="hljs-string">&quot;admin2&quot;</span>]                             <span class="hljs-comment"># æµ‹è¯•è´¦å·æ•°æ®</span><br><br><br><span class="hljs-meta">@pytest.fixture(<span class="hljs-params">scope=<span class="hljs-string">&quot;module&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">login</span>(<span class="hljs-params">request</span>):<br>    user = request.param<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ç™»é™†è´¦æˆ·: %s&quot;</span> % user)<br>    <span class="hljs-keyword">return</span> user<br><br><br><span class="hljs-meta">@pytest.mark.parametrize(<span class="hljs-params"><span class="hljs-string">&quot;login&quot;</span>, info, indirect=<span class="hljs-literal">True</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_login</span>(<span class="hljs-params">login</span>):                                  <span class="hljs-comment"># indirect=Trueå£°æ˜loginæ˜¯ä¸€ä¸ªå‡½æ•°</span><br>    value = login<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æµ‹è¯•ç”¨ä¾‹ä¸­ç™»å½•çš„è¿”å›å€¼: %s&quot;</span> % value)<br>    <span class="hljs-keyword">assert</span> value != <span class="hljs-string">&quot;&quot;</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_fixture.py&quot;</span>])<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 2 items</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_fixture.py::test_login[admin1] ç™»é™†è´¦æˆ·: admin1</span><br><span class="hljs-string">PASSED                                                  [ 50%]æµ‹è¯•ç”¨ä¾‹ä¸­ç™»å½•çš„è¿”å›å€¼: admin1</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_fixture.py::test_login[admin2] ç™»é™†è´¦æˆ·: admin2</span><br><span class="hljs-string">PASSED                                                  [100%]æµ‹è¯•ç”¨ä¾‹ä¸­ç™»å½•çš„è¿”å›å€¼: admin2</span><br><span class="hljs-string">============================== 2 passed in 0.64s ==============================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h3 id="1-ä¼ ä¸¤ä¸ªå‚æ•°"><a href="#1-ä¼ ä¸¤ä¸ªå‚æ•°" class="headerlink" title="(1) ä¼ ä¸¤ä¸ªå‚æ•°"></a>(1) ä¼ ä¸¤ä¸ªå‚æ•°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_fixture_two.py</span><br><br>info = [&#123;<span class="hljs-string">&quot;username&quot;</span>: <span class="hljs-string">&quot;admin1&quot;</span>, <span class="hljs-string">&quot;password&quot;</span>: <span class="hljs-string">&quot;12345&quot;</span>&#125;,<br>        &#123;<span class="hljs-string">&quot;username&quot;</span>: <span class="hljs-string">&quot;admin2&quot;</span>, <span class="hljs-string">&quot;password&quot;</span>: <span class="hljs-string">&quot;&quot;</span>&#125;]         <span class="hljs-comment"># æµ‹è¯•ç™»å½•æ•°æ®ï¼Œä¼ å¤šä¸ªå‚æ•°ç”¨å­—å…¸å­˜å‚¨</span><br><br><br><span class="hljs-meta">@pytest.fixture(<span class="hljs-params">scope=<span class="hljs-string">&quot;module&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">login</span>(<span class="hljs-params">request</span>):<br>    user = request.param[<span class="hljs-string">&quot;username&quot;</span>]<br>    password = request.param[<span class="hljs-string">&quot;password&quot;</span>]<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ç™»å½•è´¦æˆ·: %s&quot;</span> % user)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ç™»å½•å¯†ç : %s&quot;</span> % password)<br>    <span class="hljs-keyword">if</span> password:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><br><span class="hljs-meta">@pytest.mark.parametrize(<span class="hljs-params"><span class="hljs-string">&quot;login&quot;</span>, info, indirect=<span class="hljs-literal">True</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_login</span>(<span class="hljs-params">login</span>):                                  <span class="hljs-comment"># ç™»å½•ç”¨ä¾‹</span><br>    value = login<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æµ‹è¯•ç”¨ä¾‹ä¸­ç™»å½•çš„è¿”å›å€¼: %s&quot;</span> % value)<br>    <span class="hljs-keyword">assert</span> value, <span class="hljs-string">&quot;å¤±è´¥åŸå› ï¼šå¯†ç ä¸ºç©º&quot;</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_fixture_two.py&quot;</span>])<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 2 items</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_fixture_two.py::test_login[login0]  ç™»å½•è´¦æˆ·: admin1</span><br><span class="hljs-string">ç™»å½•å¯†ç : 12345</span><br><span class="hljs-string">PASSED                                                  [ 50%]æµ‹è¯•ç”¨ä¾‹ä¸­ç™»å½•çš„è¿”å›å€¼: True</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_fixture_two.py::test_login[login1] ç™»å½•è´¦æˆ·: admin2</span><br><span class="hljs-string">ç™»å½•å¯†ç : </span><br><span class="hljs-string">FAILED                                                  [100%]æµ‹è¯•ç”¨ä¾‹ä¸­ç™»å½•çš„è¿”å›å€¼: False</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_fixture_two.py:18 (test_login[login1])</span><br><span class="hljs-string">login = False</span><br><span class="hljs-string"></span><br><span class="hljs-string">    @pytest.mark.parametrize(&quot;login&quot;, info, indirect=True)</span><br><span class="hljs-string">    def test_login(login):                              # ç™»å½•ç”¨ä¾‹</span><br><span class="hljs-string">        value = login</span><br><span class="hljs-string">        print(&quot;æµ‹è¯•ç”¨ä¾‹ä¸­ç™»å½•çš„è¿”å›å€¼: %s&quot; % value)</span><br><span class="hljs-string">&gt;       assert value, &quot;å¤±è´¥åŸå› ï¼šå¯†ç ä¸ºç©º&quot;</span><br><span class="hljs-string">E       AssertionError: å¤±è´¥åŸå› ï¼šå¯†ç ä¸ºç©º</span><br><span class="hljs-string">E       assert False</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_fixture_two.py:23: AssertionError</span><br><span class="hljs-string">========================= 1 failed, 1 passed in 0.35s =========================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h3 id="2-å¤šä¸ªfixture"><a href="#2-å¤šä¸ªfixture" class="headerlink" title="(2) å¤šä¸ªfixture"></a>(2) å¤šä¸ªfixture</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_fixture_more.py</span><br><br>test_username = [<span class="hljs-string">&quot;admin1&quot;</span>, <span class="hljs-string">&quot;admin2&quot;</span>]                    <span class="hljs-comment"># ç”¨ä¾‹ç»„åˆæ˜¯2ä¸ªå‚æ•°çš„ä¸ªæ•°ç›¸ä¹˜ï¼š2*2</span><br>test_password = [<span class="hljs-string">&quot;12345&quot;</span>, <span class="hljs-string">&quot;12346&quot;</span>]<br><br><br><span class="hljs-meta">@pytest.fixture(<span class="hljs-params">scope=<span class="hljs-string">&quot;module&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">input_username</span>(<span class="hljs-params">request</span>):<br>    username = request.param<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ç™»å½•è´¦æˆ·: %s&quot;</span> % username)<br>    <span class="hljs-keyword">return</span> username<br><br><br><span class="hljs-meta">@pytest.fixture(<span class="hljs-params">scope=<span class="hljs-string">&quot;module&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">input_password</span>(<span class="hljs-params">request</span>):<br>    password = request.param<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ç™»å½•å¯†ç : %s&quot;</span> % password)<br>    <span class="hljs-keyword">return</span> password<br><br><br><span class="hljs-meta">@pytest.mark.parametrize(<span class="hljs-params"><span class="hljs-string">&quot;input_username&quot;</span>, test_username, indirect=<span class="hljs-literal">True</span></span>)</span><br><span class="hljs-meta">@pytest.mark.parametrize(<span class="hljs-params"><span class="hljs-string">&quot;input_password&quot;</span>, test_password, indirect=<span class="hljs-literal">True</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_login</span>(<span class="hljs-params">input_username, input_password</span>):<br>    u = input_username<br>    p = input_password<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æµ‹è¯•æ•°æ®: u---%s, p---%s&quot;</span> % (u, p))<br>    <span class="hljs-keyword">assert</span> p<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_fixture_more.py&quot;</span>])<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 4 items</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_fixture_more.py::test_login[12345-admin1] ç™»å½•è´¦æˆ·: admin1</span><br><span class="hljs-string">ç™»å½•å¯†ç : 12345</span><br><span class="hljs-string">PASSED                                                  [ 25%]æµ‹è¯•æ•°æ®: u---admin1, p---12345</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_fixture_more.py::test_login[12345-admin2] ç™»å½•è´¦æˆ·: admin2</span><br><span class="hljs-string">PASSED                                                  [ 50%]æµ‹è¯•æ•°æ®: u---admin2, p---12345</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_fixture_more.py::test_login[12346-admin2] ç™»å½•å¯†ç : 12346</span><br><span class="hljs-string">PASSED                                                  [ 75%]æµ‹è¯•æ•°æ®: u---admin2, p---12346</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_fixture_more.py::test_login[12346-admin1] ç™»å½•è´¦æˆ·: admin1</span><br><span class="hljs-string">PASSED                                                  [100%]æµ‹è¯•æ•°æ®: u---admin1, p---12346</span><br><span class="hljs-string">============================== 4 passed in 0.06s ==============================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h1 id="8-å‘½ä»¤è¡Œå‚æ•°çš„é…ç½®"><a href="#8-å‘½ä»¤è¡Œå‚æ•°çš„é…ç½®" class="headerlink" title="8 å‘½ä»¤è¡Œå‚æ•°çš„é…ç½®"></a>8 å‘½ä»¤è¡Œå‚æ•°çš„é…ç½®</h1><ul>
<li>å‘½ä»¤è¡Œå‚æ•°çš„é…ç½®<ul>
<li>åœ¨<code>conftest.py</code>æ–‡ä»¶ä¸­æ·»åŠ å‘½ä»¤è¡Œé€‰é¡¹ï¼Œå‘½ä»¤è¡Œä¼ å…¥å‚æ•°<code>--cmdopt</code>ï¼Œç”¨ä¾‹éœ€ç”¨åˆ°æ—¶å³è°ƒç”¨cmdpotå‡½æ•°ã€‚</li>
<li>é…ç½®æ–‡ä»¶<code>pytest.ini</code>ä¹Ÿå¯ä»¥æ”¹å˜pytestçš„è¿è¡Œæ–¹å¼ï¼Œæ˜¯ä¸€ä¸ªå›ºå®šæ–‡ä»¶ï¼Œè¯»å–é…ç½®ä¿¡æ¯ï¼ŒæŒ‰æŒ‡å®šæ–¹å¼è¿è¡Œã€‚</li>
<li>PyTestæ¡†æ¶çš„éƒ¨åˆ†æ–‡ä»¶è¯´æ˜<ul>
<li><code>conftest.py</code>ï¼šå‚æ•°ç”¨ä¾‹çš„ä¸€äº›fixtureé…ç½®ã€‚</li>
<li><code>setup.cfg</code>ï¼šiniæ ¼å¼æ–‡ä»¶ï¼Œå½±å“<code>setup.py</code>çš„è¡Œä¸ºã€‚</li>
<li><code>pytest.ini</code>ï¼šä¸»é…ç½®æ–‡ä»¶ï¼Œæ”¹å˜PyTestçš„é»˜è®¤è¡Œä¸ºã€‚</li>
<li><code>tox.ini</code>ï¼šä¸<code>pytest.ini</code>ç±»ä¼¼ï¼Œä½¿ç”¨toxå·¥å…·æ—¶æ‰ç”¨ã€‚</li>
<li><code>__init__.py</code>ï¼šè¯†åˆ«è¯¥æ–‡ä»¶æ‰€åœ¨çš„æ–‡ä»¶å¤¹ä¸ºPythonçš„packageåŒ…ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="8-1-conftest-py"><a href="#8-1-conftest-py" class="headerlink" title="8-1 conftest.py"></a>8-1 conftest.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># conftest.py</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pytest_addoption</span>(<span class="hljs-params">parser</span>):<br>    parser.addoption(<span class="hljs-string">&quot;--cmdopt&quot;</span>,<br>                     action=<span class="hljs-string">&quot;store&quot;</span>,<br>                     default=<span class="hljs-string">&quot;type1&quot;</span>,<br>                     <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;myoption: type1 or type2&quot;</span>)<br><br><br><span class="hljs-meta">@pytest.fixture</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">cmdopt</span>(<span class="hljs-params">request</span>):<br>    <span class="hljs-keyword">return</span> request.config.getoption(<span class="hljs-string">&quot;--cmdopt&quot;</span>)<br></code></pre></td></tr></table></figure>



<h3 id="1-ä¸å¸¦å‚æ•°æ‰§è¡Œ"><a href="#1-ä¸å¸¦å‚æ•°æ‰§è¡Œ" class="headerlink" title="(1) ä¸å¸¦å‚æ•°æ‰§è¡Œ"></a>(1) ä¸å¸¦å‚æ•°æ‰§è¡Œ</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_sample.py</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_answer</span>(<span class="hljs-params">cmdopt</span>):<br>    <span class="hljs-keyword">if</span> cmdopt == <span class="hljs-string">&quot;type1&quot;</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---1---&quot;</span>)<br>    <span class="hljs-keyword">elif</span> cmdopt == <span class="hljs-string">&quot;type2&quot;</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---2---&quot;</span>)<br>    <span class="hljs-keyword">assert</span> <span class="hljs-number">0</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_sample.py&quot;</span>])<br><br><span class="hljs-comment"># pytest -s test_sample.py                              # ä¸å¸¦å‚æ•°æ‰§è¡Œï¼Œé»˜è®¤ä¼ type1</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">=========================== test session starts ===============================</span><br><span class="hljs-string">...</span><br><span class="hljs-string">collected 1 item</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_sample.py ---1---</span><br><span class="hljs-string">F</span><br><span class="hljs-string"></span><br><span class="hljs-string">================================ FAILURES =====================================</span><br><span class="hljs-string">_______________________________ test_answer ___________________________________</span><br><span class="hljs-string">cmdopt = &#x27;type1&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">    def test_answer(cmdopt):</span><br><span class="hljs-string">        if cmdopt == &quot;type1&quot;:</span><br><span class="hljs-string">            print(&quot;---1---&quot;)</span><br><span class="hljs-string">        elif cmdopt == &quot;type2&quot;:</span><br><span class="hljs-string">            print(&quot;---2---&quot;)</span><br><span class="hljs-string">&gt;       assert 0</span><br><span class="hljs-string">E       assert 0</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_sample.py:9: AssertionError</span><br><span class="hljs-string">========================== short test summary info ============================</span><br><span class="hljs-string">FAILED test_sample.py::test_answer - assert 0</span><br><span class="hljs-string">============================= 1 failed in 0.28s ===============================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h3 id="2-å¸¦ä¸Šå‚æ•°æ‰§è¡Œ"><a href="#2-å¸¦ä¸Šå‚æ•°æ‰§è¡Œ" class="headerlink" title="(2) å¸¦ä¸Šå‚æ•°æ‰§è¡Œ"></a>(2) å¸¦ä¸Šå‚æ•°æ‰§è¡Œ</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-comment"># pytest -s test_sample.py --cmdopt=type2               # å¸¦ä¸Šå‚æ•°æ‰§è¡Œ</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">=========================== test session starts ===============================</span><br><span class="hljs-string">...</span><br><span class="hljs-string">collected 1 item</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_sample.py ---2---</span><br><span class="hljs-string">F</span><br><span class="hljs-string"></span><br><span class="hljs-string">================================ FAILURES =====================================</span><br><span class="hljs-string">_______________________________ test_answer ___________________________________</span><br><span class="hljs-string">cmdopt = &#x27;type2&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">    def test_answer(cmdopt):</span><br><span class="hljs-string">        if cmdopt == &quot;type1&quot;:</span><br><span class="hljs-string">            print(&quot;---1---&quot;)</span><br><span class="hljs-string">        elif cmdopt == &quot;type2&quot;:</span><br><span class="hljs-string">            print(&quot;---2---&quot;)</span><br><span class="hljs-string">&gt;       assert 0</span><br><span class="hljs-string">E       assert 0</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_sample.py:9: AssertionError</span><br><span class="hljs-string">========================== short test summary info ============================</span><br><span class="hljs-string">FAILED test_sample.py::test_answer - assert 0</span><br><span class="hljs-string">============================= 1 failed in 0.33s ===============================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h2 id="8-2-pytest-inié…ç½®"><a href="#8-2-pytest-inié…ç½®" class="headerlink" title="8-2 pytest.inié…ç½®"></a>8-2 pytest.inié…ç½®</h2><ul>
<li>pytest.inié…ç½®<ul>
<li>ä¸€ä¸ªé¡¹ç›®æœ‰ä¸€ä¸ª<code>pytest.ini</code>æ–‡ä»¶å³å¯ï¼Œæ”¾åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹ã€‚</li>
<li>å‘½ä»¤çª—å£ä¸‹ä½¿ç”¨<code>pytest --help</code>æŒ‡ä»¤ï¼Œå¯ä»¥æŸ¥çœ‹åˆ°<code>pytest.ini</code>æ–‡ä»¶ä¸­çš„è®¾ç½®é€‰é¡¹ã€‚</li>
<li><code>pytest.ini</code>æ–‡ä»¶ä¸èƒ½å¸¦ä¸­æ–‡æ³¨é‡Šï¼Œå¦åˆ™è¿è¡Œå°†æŠ¥é”™ï¼š<code>UnicodeDecodeError: &#39;gbk&#39;...illegal multibyte</code>ã€‚</li>
<li>addoptså‚æ•°é»˜è®¤æ›´æ”¹å‘½ä»¤è¡Œé€‰é¡¹ï¼Œä¾‹å¦‚ï¼šæ‰§è¡Œå®Œç”¨ä¾‹éœ€è¦ç”ŸæˆæŠ¥å‘Šï¼Œä½¿ç”¨å‘½ä»¤<code>pytest --html=report.html</code>ã€‚</li>
<li>å°†ç”ŸæˆæŠ¥å‘Šçš„å‘½ä»¤åŠ å…¥<code>pytest.ini</code>æ–‡ä»¶ä¸­ï¼Œä¸‹æ¬¡ç›´æ¥æ‰§è¡Œ<code>pytest</code>æŒ‡ä»¤ï¼ŒPyTestå°±ä¼šé»˜è®¤å¸¦ä¸Šè¿™äº›æ–°å¢çš„å‚æ•°ã€‚</li>
</ul>
</li>
</ul>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs Ini"><span class="hljs-section">[pytest]</span>                                                <span class="hljs-comment"># pytest.iniï¼Œæ”¾åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹</span><br><br><br>markers =                                               <span class="hljs-comment"># è‡ªå®šä¹‰markæ ‡è®°çš„é…ç½®æ³¨å†Œ</span><br>    a: a tests<br>    b: b tests<br>    function: Function tests<br>    webtest: Run the webtest case<br><br><br><span class="hljs-attr">addopts</span> = --html=report.html                            <span class="hljs-comment"># æ‰§è¡Œå®Œç”¨ä¾‹ç”ŸæˆæŠ¥å‘Šï¼Œéœ€äº‹å…ˆå®‰è£…å¥½æ’ä»¶</span><br></code></pre></td></tr></table></figure>

<ul>
<li><a href="https://stitch-top.github.io/2023/03/03/ce-shi-kuang-jia/tf02-pytest-ce-shi-kuang-jia/#6-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%A0%87%E8%AE%B0mark">markæ ‡è®°</a><ul>
<li>ä½¿ç”¨markæ ‡è®°åŠŸèƒ½ï¼Œå¯¹åç»­åˆ†ç±»æµ‹è¯•ç”¨ä¾‹ååˆ†æœ‰ç”¨ï¼Œå°†è‡ªå®šä¹‰æ ‡è®°å†™å…¥<code>pytest.ini</code>æ–‡ä»¶ä¸­ï¼Œæ–¹ä¾¿ç®¡ç†ã€‚</li>
<li>å‘½ä»¤çª—å£å¯¹åº”<code>pytest.ini</code>æ–‡ä»¶æ‰€åœ¨çš„æ–‡ä»¶å¤¹ä¸‹ï¼Œè¾“å…¥<code>pytest --markers</code>å‘½ä»¤å¯ä»¥æŸ¥çœ‹åˆ°å·²å®šä¹‰çš„æ ‡è®°ã€‚</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># test_xpass.py</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_a</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---use case a---&quot;</span>)<br><br><br><span class="hljs-meta">@pytest.mark.xfail()</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_b</span>():<br>    x = <span class="hljs-string">&quot;hello&quot;</span><br>    y = <span class="hljs-string">&quot;hello world&quot;</span><br>    <span class="hljs-keyword">assert</span> x == y<br><br><br><span class="hljs-meta">@pytest.mark.xfail()</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_c</span>():<br>    x = <span class="hljs-string">&quot;hello&quot;</span><br>    y = <span class="hljs-string">&quot;hello world&quot;</span><br>    <span class="hljs-keyword">assert</span> x != y<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    pytest.main([<span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;test_xpass.py&quot;</span>])                <span class="hljs-comment"># æ‰§è¡Œå‰å…ˆå°†addopts = --html=report.htmlæ³¨é‡Šæ‰</span><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 3 items</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_xpass.py::test_a PASSED                            [ 33%]---use case a---</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_xpass.py::test_b XFAIL                             [ 66%]</span><br><span class="hljs-string">@pytest.mark.xfail()</span><br><span class="hljs-string">    def test_b():</span><br><span class="hljs-string">        x = &quot;hello&quot;</span><br><span class="hljs-string">        y = &quot;hello world&quot;</span><br><span class="hljs-string">&gt;       assert x == y</span><br><span class="hljs-string">E       AssertionError: assert &#x27;hello&#x27; == &#x27;hello world&#x27;</span><br><span class="hljs-string">E         - hello world</span><br><span class="hljs-string">E         + hello</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_xpass.py:12: AssertionError</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_xpass.py::test_c XPASS                             [100%]</span><br><span class="hljs-string">=================== 1 passed, 1 xfailed, 1 xpassed in 0.33s ===================</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>

<ul>
<li>ç¦ç”¨xpass*<ul>
<li>è®¾ç½®<code>xfail_strict = true</code>å¯ä»¥è®©æ ‡è®°ä¸º<code>@pytest.mark.xfail</code>ä½†å®é™…é€šè¿‡çš„ç”¨ä¾‹è¢«æŠ¥å‘Šä¸ºå¤±è´¥ã€‚</li>
<li>åœ¨<code>test_xpass.py</code>å®ä¾‹ä¸­ï¼Œtest_bå’Œtest_céƒ½æ ‡è®°ä¸ºå¤±è´¥ï¼Œè¿™é‡Œå¸Œæœ›bå’Œcç”¨ä¾‹ä¸ç”¨æ‰§è¡Œå°±æ˜¾ç¤ºxfailã€‚</li>
</ul>
</li>
</ul>
<h3 id="1-pytest-ini-2"><a href="#1-pytest-ini-2" class="headerlink" title="(1) pytest.ini"></a>(1) pytest.ini</h3><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Ini"><span class="hljs-section">[pytest]</span>                                                 <span class="hljs-comment"># pytest.iniï¼Œç¦ç”¨XPASS</span><br><br><br><span class="hljs-attr">xfail_strict</span> = <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure>



<h3 id="2-test-xpass-py"><a href="#2-test-xpass-py" class="headerlink" title="(2) test_xpass.py"></a>(2) test_xpass.py</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs Powershell"><span class="hljs-comment"># å†æ¬¡æ‰§è¡Œtest_xpass.pyï¼ŒæŸ¥çœ‹ç»“æœ</span><br><span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;                ï¼ï¼ï¼test_cçš„XPASSè¢«å¼ºåˆ¶æ€§æ ‡è®°ä¸ºFAILEDã€‚                   </span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 3 items</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_xpass.py::test_a PASSED                            [ 33%]---use case a---</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_xpass.py::test_b XFAIL                             [ 66%]</span><br><span class="hljs-string">@pytest.mark.xfail()</span><br><span class="hljs-string">    def test_b():</span><br><span class="hljs-string">        x = &quot;</span>hello<span class="hljs-string">&quot;</span><br><span class="hljs-string">        y = &quot;</span>hello world<span class="hljs-string">&quot;</span><br><span class="hljs-string">&gt;       assert x == y</span><br><span class="hljs-string">E       AssertionError: assert &#x27;hello&#x27; == &#x27;hello world&#x27;</span><br><span class="hljs-string">E         - hello world</span><br><span class="hljs-string">E         + hello</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_xpass.py:13: AssertionError</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_xpass.py::test_c FAILED                            [100%]</span><br><span class="hljs-string">test_xpass.py:15 (test_c)</span><br><span class="hljs-string">[XPASS(strict)] </span><br><span class="hljs-string">============== 1 failed, 1 passed, 1 xfailed, 1 warning in 0.26s ==============</span><br><span class="hljs-string">&quot;</span><span class="hljs-string">&quot;&quot;</span><br></code></pre></td></tr></table></figure>



<h1 id="9-ç”Ÿæˆhtmlæµ‹è¯•æŠ¥å‘Š"><a href="#9-ç”Ÿæˆhtmlæµ‹è¯•æŠ¥å‘Š" class="headerlink" title="9 ç”Ÿæˆhtmlæµ‹è¯•æŠ¥å‘Š"></a>9 ç”Ÿæˆhtmlæµ‹è¯•æŠ¥å‘Š</h1><ul>
<li>ç”Ÿæˆhtmlæµ‹è¯•æŠ¥å‘Š<ul>
<li>pytest-htmlï¼šPyTestç”¨äºç”Ÿæˆæµ‹è¯•ç»“æœçš„htmlæŠ¥å‘Šæ’ä»¶ï¼Œ<code>pip install pytest-html</code>è¿›è¡Œå®‰è£…ã€‚<ul>
<li>æ‰§è¡Œæ–¹æ³•ï¼š<code>pytest --html=report.html</code>ï¼Œå½“å‰ç›®å½•ä¸­ç”Ÿæˆ<code>report.html</code>æŠ¥å‘Šæ–‡ä»¶ã€‚</li>
<li>æŒ‡å®šæ‰§è¡ŒæŸä¸ª<code>.py</code>æ–‡ä»¶ç”ŸæˆæŠ¥å‘Šï¼š<code>pytest test_filename.py --html=report.html</code>ã€‚</li>
<li>ç”ŸæˆæŠ¥å‘Šåˆ°å½“å‰æ–‡ä»¶å¤¹çš„reportç›®å½•ä¸­ï¼š<code>pytest test_filename.py --html=./report/report.html</code>ã€‚</li>
<li>ä¸Šè¿°æ–¹æ³•ç”Ÿæˆçš„æŠ¥å‘Šï¼Œcssç‹¬ç«‹ï¼Œåˆ†äº«æŠ¥å‘Šæ—¶æ ·å¼å°†ä¸¢å¤±ï¼Œä¸ºæ›´å¥½å±•ç¤ºæŠ¥å‘Šï¼Œå¯å°†cssæ ·å¼åˆå¹¶åˆ°htmlä¸­ã€‚</li>
<li>è®©<code>report.html</code>æŠ¥å‘Šç‹¬ç«‹æ˜¾ç¤ºï¼Œå¯ä½¿ç”¨å‘½ä»¤ï¼š<code>pytest --html=report.html --self-contained-html</code>ã€‚</li>
<li>ç”¨ä¾‹æ‰§è¡Œå¤±è´¥é‡è·‘éœ€ä¾èµ–pytest-rerunfailuresæ’ä»¶ï¼Œå‘½ä»¤å®‰è£…ï¼š<code>pip install pytest-rerunfailures</code>ã€‚<ul>
<li>é‡è·‘næ¬¡ï¼š<code>pytest --reruns n</code>ï¼Œå¤±è´¥æ‰é‡è·‘ï¼ŒæˆåŠŸç”¨ä¾‹ä½¿ç”¨æ— æ•ˆã€‚</li>
<li>é‡è·‘næ¬¡ï¼Œæ¯æ¬¡é—´éš”mç§’ï¼š<code>pytest --reruns n --reruns-delay m</code>ã€‚</li>
</ul>
</li>
</ul>
</li>
<li>allureï¼šreportæ¡†æ¶ï¼Œæ”¯æŒPythonçš„PyTestã€Javaçš„JUnitã€TestNGç­‰æ¡†æ¶ï¼Œå¯ä»¥é›†æˆåˆ°Jenkinsä¸Šã€‚</li>
</ul>
</li>
</ul>
<h2 id="9-1-conftest-py"><a href="#9-1-conftest-py" class="headerlink" title="9-1 conftest.py"></a>9-1 conftest.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> pytest                                           <span class="hljs-comment"># conftest.pyï¼Œç”¨ä¾‹æŠ¥é”™æ—¶è¿›è¡Œæˆªå›¾çš„é…ç½®ä»£ç </span><br><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver<br><br>driver: webdriver.Firefox = <span class="hljs-literal">None</span>                        <span class="hljs-comment"># éœ€ç”¨åˆ°æµè§ˆå™¨æ’ä»¶ï¼Œæå‰é…ç½®å¥½</span><br><br><br><span class="hljs-meta">@pytest.mark.hookwrapper</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pytest_runtest_makereport</span>(<span class="hljs-params">item</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    å½“ç”¨ä¾‹æ— æ³•æ‰§è¡Œæ—¶ï¼Œå±å¹•æˆªå›¾ä¼šè‡ªåŠ¨æ˜¾ç¤ºåœ¨æŠ¥å‘Šä¸­ã€‚</span><br><span class="hljs-string">    :param item:</span><br><span class="hljs-string">    :return:</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    pytest_html = item.config.pluginmanager.getplugin(<span class="hljs-string">&quot;html&quot;</span>)<br>    outcome = <span class="hljs-keyword">yield</span><br>    report = outcome.get_result()<br>    extra = <span class="hljs-built_in">getattr</span>(report, <span class="hljs-string">&quot;extra&quot;</span>, [])<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;é¡¹ç›®ç±»å‹: &quot;</span>, <span class="hljs-built_in">type</span>(item))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æŠ¥å‘Šç±»å‹: &quot;</span>, <span class="hljs-built_in">type</span>(report))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;é¢å¤–è¯´æ˜:&quot;</span>, extra)<br><br>    <span class="hljs-keyword">if</span> report.when == <span class="hljs-string">&quot;call&quot;</span> <span class="hljs-keyword">or</span> report.when == <span class="hljs-string">&quot;setup&quot;</span>:<br>        xfail = <span class="hljs-built_in">hasattr</span>(report, <span class="hljs-string">&quot;wasfail&quot;</span>)<br>        <span class="hljs-keyword">if</span> (report.skipped <span class="hljs-keyword">and</span> xfail) <span class="hljs-keyword">or</span> (report.failed <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> xfail):<br>            file_name = report.nodeid.replace(<span class="hljs-string">&quot;::&quot;</span>, <span class="hljs-string">&quot;_&quot;</span>) + <span class="hljs-string">&quot;.png&quot;</span><br>            screen_img = _capter_screenshot()<br>            <span class="hljs-keyword">if</span> file_name:<br>                html = <span class="hljs-string">&quot;&lt;div&gt;&lt;img src=&#x27;data:image/png;base64,%s&#x27; \</span><br><span class="hljs-string">                        alt=&#x27;screenshot&#x27; style=&#x27;width:600px;height:300px;&#x27;&quot;</span> \<br>                       <span class="hljs-string">&quot;onclick=&#x27;window.open(this.src)&#x27; align=&#x27;right&#x27;/&gt;&lt;/div&gt;&quot;</span> % screen_img<br>                extra.append(pytest_html.extras.html(html))<br>        report.extra = extra<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">_capter_screenshot</span>():<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    å±å¹•æˆªå›¾ä¿å­˜ä¸ºbase64å¹¶æ˜¾ç¤ºåœ¨htmlæŠ¥å‘Šä¸­ã€‚</span><br><span class="hljs-string">    :return:</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">return</span> driver.get_screenshot_as_base64()<br><br><br><span class="hljs-meta">@pytest.fixture(<span class="hljs-params">scope=<span class="hljs-string">&quot;session&quot;</span>, autouse=<span class="hljs-literal">True</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">browser</span>():<br>    <span class="hljs-keyword">global</span> driver<br>    <span class="hljs-keyword">if</span> driver <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>        driver = webdriver.Firefox()<br>    <span class="hljs-keyword">return</span> driver<br></code></pre></td></tr></table></figure>



<h2 id="9-2-test-screenshot-py"><a href="#9-2-test-screenshot-py" class="headerlink" title="9-2 test_screenshot.py"></a>9-2 test_screenshot.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> time                                             <span class="hljs-comment"># test_screenshot.py</span><br><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_get_title</span>(<span class="hljs-params">browser</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    :æµè§ˆå™¨ç±»å‹: webdriver.firefox</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    browser.get(<span class="hljs-string">&quot;https://stitch-top.github.io/&quot;</span>)        <span class="hljs-comment"># GitHubç½‘ç«™è®¿é—®è¾ƒæ…¢</span><br>    time.sleep(<span class="hljs-number">5</span>)<br>    t = browser.title<br>    <span class="hljs-keyword">assert</span> t == <span class="hljs-string">&quot;Stitch.top&quot;</span>                            <span class="hljs-comment"># &quot;Dr.626&quot;</span><br>    browser.close()<br><br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">============================= test session starts =============================</span><br><span class="hljs-string">collecting ... collected 1 item</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_screenshot.py::test_get_title FAILED               [100%]</span><br><span class="hljs-string">é¡¹ç›®ç±»å‹:  &lt;class &#x27;_pytest.python.Function&#x27;&gt;</span><br><span class="hljs-string">æŠ¥å‘Šç±»å‹:  &lt;class &#x27;_pytest.reports.TestReport&#x27;&gt;</span><br><span class="hljs-string">é¢å¤–è¯´æ˜: []</span><br><span class="hljs-string">é¡¹ç›®ç±»å‹:  &lt;class &#x27;_pytest.python.Function&#x27;&gt;</span><br><span class="hljs-string">æŠ¥å‘Šç±»å‹:  &lt;class &#x27;_pytest.reports.TestReport&#x27;&gt;</span><br><span class="hljs-string">é¢å¤–è¯´æ˜: []</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_screenshot.py:4 (test_get_title)</span><br><span class="hljs-string">&#x27;Dr.626&#x27; != &#x27;Stitch.top&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">Expected :&#x27;Stitch.top&#x27;</span><br><span class="hljs-string">Actual   :&#x27;Dr.626&#x27;</span><br><span class="hljs-string">&lt;Click to see difference&gt;</span><br><span class="hljs-string"></span><br><span class="hljs-string">browser = &lt;selenium.webdriver.firefox.webdriver.WebDriver (session=&quot;...&quot;)&gt;</span><br><span class="hljs-string"></span><br><span class="hljs-string">    def test_get_title(browser):</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br><span class="hljs-string">        :æµè§ˆå™¨ç±»å‹: webdriver.firefox</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br><span class="hljs-string">        browser.get(&quot;https://stitch-top.github.io/&quot;)    # GitHubç½‘ç«™è®¿é—®è¾ƒæ…¢</span><br><span class="hljs-string">        time.sleep(5)</span><br><span class="hljs-string">        t = browser.title</span><br><span class="hljs-string">&gt;       assert t == &quot;Stitch.top&quot;                            # &quot;Dr.626&quot;</span><br><span class="hljs-string">E       AssertionError: assert &#x27;Dr.626&#x27; == &#x27;Stitch.top&#x27;</span><br><span class="hljs-string">E         - Stitch.top</span><br><span class="hljs-string">E         + Dr.626</span><br><span class="hljs-string"></span><br><span class="hljs-string">test_screenshot.py:12: AssertionError</span><br><span class="hljs-string">é¡¹ç›®ç±»å‹:  &lt;class &#x27;_pytest.python.Function&#x27;&gt;</span><br><span class="hljs-string">æŠ¥å‘Šç±»å‹:  &lt;class &#x27;_pytest.reports.TestReport&#x27;&gt;</span><br><span class="hljs-string">é¢å¤–è¯´æ˜: []</span><br><span class="hljs-string">============================= 1 failed in 42.29s ==============================</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>



              
            </div>
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6/" class="category-chain-item">æµ‹è¯•æ¡†æ¶</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Python/">#Python</a>
      
        <a href="/tags/Pytest/">#Pytest</a>
      
        <a href="/tags/Assertions/">#Assertions</a>
      
        <a href="/tags/Decorators/">#Decorators</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Pytest æµ‹è¯•æ¡†æ¶</div>
      <div>https://stitch-top.github.io/2023/03/03/ce-shi-kuang-jia/tf02-pytest/tf01-pytest-ce-shi-kuang-jia/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>ä½œè€…</div>
          <div>Dr.626</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>å‘å¸ƒäº</div>
          <div>2023å¹´3æœˆ3æ—¥ 23:03:27</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>è®¸å¯åè®®</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - ç½²å">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
              <a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
              <span class="hint--top hint--rounded" aria-label="NC - éå•†ä¸šæ€§ä½¿ç”¨">
                <i class="iconfont icon-nc"></i>
              </span>
              </a>
            
              <a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
              <span class="hint--top hint--rounded" aria-label="SA - ç›¸åŒæ–¹å¼å…±äº«">
                <i class="iconfont icon-sa"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/05/01/ce-shi-kuang-jia/tf03-allure/tf01-allure-ce-shi-bao-gao/" title="Allure æµ‹è¯•æŠ¥å‘Š">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Allure æµ‹è¯•æŠ¥å‘Š</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/01/08/ce-shi-kuang-jia/tf01-selenium/tf01-selenium/" title="Selenium">
                        <span class="hidden-mobile">Selenium</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  <article id="comments">
    
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://cdn.staticfile.org/valine/1.5.1/Valine.min.js', function() {
        var options = Object.assign(
          {"appId":"PDfaLoft9OAolB0AmON5AqUb-gzGzoHsz","appKey":"xq13nodBzh8hOliBusHUKDwj","path":"window.location.pathname","placeholder":"èµ äººç«ç‘°ï¼Œæ‰‹ç•™ä½™é¦™(ï½oï¿£3ï¿£)ï½","avatar":"monsterid","meta":["nick","mail","link"],"requiredFields":["nick","mail"],"pageSize":13,"lang":"zh-CN","highlight":"ture","recordIP":"ture","serverURLs":"","emojiCDN":null,"emojiMaps":null,"enableQQ":"ture"},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          var imgSelector = '#valine .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });

    // Qmsgè¯„è®ºæ¨é€æœåŠ¡ï¼šQQ2338638343 + é‚®ä»¶zero_021@aliyun.com
    var title2="msg=Stitch's Blogåˆæœ‰æ–°è¯„è®ºå•¦ï¼\n"
    var SCKEY_Qmsg="https://qmsg.zendee.cn/send/ad06ce297bd5d64b5aa08ea55560f7a2"
    var ValineButton=document.getElementsByClassName("vsubmit vbtn")[0];
    function send_valine_Qmsg(){
      var pagename=document.title;
      var wz=pagename.indexOf('|');
      var res=pagename.substring(0, wz);
      var pageurl=document.URL;
      var ptime=new Date();
      var vnick=document.getElementsByClassName("vnick vinput")[0].value;
      var vmail=document.getElementsByClassName("vmail vinput")[0].value;
      var vlink=document.getElementsByClassName("vlink vinput")[0].value;
      var veditor=document.getElementsByClassName("veditor vinput")[0].value;
      var data="æ˜µç§°ï¼š"+vnick+"\né‚®ç®±ï¼š"+vmail+"\nç½‘ç«™åœ°å€ï¼š"+vlink+"\nå½“å‰é¡µé¢ï¼š"+pagename+"\nè¯„è®ºå†…å®¹ï¼š"+veditor+"\nè·³è½¬é“¾æ¥ï¼š"+pageurl+"\nè¯„è®ºæ—¶é—´"+ptime.toLocaleString();
      var httpRequest = new XMLHttpRequest();       // ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºéœ€è¦çš„å¯¹è±¡
      httpRequest.open('POST', SCKEY_Qmsg, true);   // ç¬¬äºŒæ­¥ï¼šæ‰“å¼€è¿æ¥
      httpRequest.setRequestHeader("Content-type","application/x-www-form-urlencoded"); // è®¾ç½®è¯·æ±‚å¤´ æ³¨ï¼špostæ–¹å¼å¿…é¡»è®¾ç½®è¯·æ±‚å¤´ï¼ˆåœ¨å»ºç«‹è¿æ¥åè®¾ç½®è¯·æ±‚å¤´ï¼‰
      httpRequest.send(title2 + data);              // å‘é€è¯·æ±‚ 
    };
    
    document.body.addEventListener('click', function(e) {
      if(e.target.className.indexOf('vsubmit') === -1) {
        return;
      }
      send_valine_Qmsg();
    })

  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


  </article>


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar category-bar" style="margin-left: -1rem">
    





<div class="category-list">
  
  
    
    
    
    <div class="category row nomargin-x">
      <a class="category-item 
          list-group-item category-item-action col-10 col-md-11 col-xm-11" title="æµ‹è¯•æ¡†æ¶"
        id="heading-893b664e5ce5fe8882ce6ce630f2f650" role="tab" data-toggle="collapse" href="#collapse-893b664e5ce5fe8882ce6ce630f2f650"
        aria-expanded="true"
      >
        æµ‹è¯•æ¡†æ¶
        <span class="list-group-count">(10)</span>
        <i class="iconfont icon-arrowright"></i>
      </a>
      
      <div class="category-collapse collapse show" id="collapse-893b664e5ce5fe8882ce6ce630f2f650"
           role="tabpanel" aria-labelledby="heading-893b664e5ce5fe8882ce6ce630f2f650">
        
        
          
  <div class="category-post-list">
    
    
      
      
        <a href="/2023/01/08/ce-shi-kuang-jia/tf01-selenium/tf01-selenium/" title="Selenium"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Selenium</span>
        </a>
      
    
      
      
        <a href="/2023/03/03/ce-shi-kuang-jia/tf02-pytest/tf01-pytest-ce-shi-kuang-jia/" title="Pytest æµ‹è¯•æ¡†æ¶"
           class="list-group-item list-group-item-action
           active">
          <span class="category-post">Pytest æµ‹è¯•æ¡†æ¶</span>
        </a>
      
    
      
      
        <a href="/2023/05/01/ce-shi-kuang-jia/tf03-allure/tf01-allure-ce-shi-bao-gao/" title="Allure æµ‹è¯•æŠ¥å‘Š"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Allure æµ‹è¯•æŠ¥å‘Š</span>
        </a>
      
    
      
      
        <a href="/2023/07/23/ce-shi-kuang-jia/tf04-unittest/tf01-unittest-ce-shi-kuang-jia/" title="UnitTest æµ‹è¯•æ¡†æ¶"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">UnitTest æµ‹è¯•æ¡†æ¶</span>
        </a>
      
    
      
      
        <a href="/2024/03/02/ce-shi-kuang-jia/tf04-unittest/tf02-unittest-zi-bao-mock/" title="UnitTest å­åŒ… Mock"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">UnitTest å­åŒ… Mock</span>
        </a>
      
    
      
      
        <a href="/2023/09/09/ce-shi-kuang-jia/tf05-playwright/tf01-playwright-kuang-jia-yi/" title="PlayWright æ¡†æ¶(ä¸€)"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">PlayWright æ¡†æ¶(ä¸€)</span>
        </a>
      
    
      
      
        <a href="/2023/11/02/ce-shi-kuang-jia/tf05-playwright/tf02-playwright-kuang-jia-er/" title="PlayWright æ¡†æ¶(äºŒ)"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">PlayWright æ¡†æ¶(äºŒ)</span>
        </a>
      
    
      
      
        <a href="/2024/07/16/ce-shi-kuang-jia/tf06-robot-framework/tf01-robot-framework/" title="Robot Framework"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Robot Framework</span>
        </a>
      
    
      
      
        <a href="/2025/03/19/ce-shi-kuang-jia/tf07-locust/tf01-locust-xing-neng-kuang-jia/" title="Locust æ€§èƒ½æ¡†æ¶"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Locust æ€§èƒ½æ¡†æ¶</span>
        </a>
      
    
      
      
        <a href="/2025/04/16/ce-shi-kuang-jia/tf08-cypress/tf01-cypress-ce-shi-kuang-jia/" title="Cypress æµ‹è¯•æ¡†æ¶"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Cypress æµ‹è¯•æ¡†æ¶</span>
        </a>
      
    
  </div>

        
      </div>
    </div>
  
</div>


  </aside>


    </div>
  </div>
</div>





  



  



  



  



  






    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a><span>Copyright Â© 2021 - 2025</span></a> <i class="iconfont icon-love"></i> <a href="https://stitch-top.github.io" target="_blank" rel="nofollow noopener"><span>Dr.626</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        ğŸ“ˆ æ€»è®¿é—®é‡ 
        <span id="leancloud-site-pv"></span>
         æ¬¡
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        ğŸ“Š æ€»è®¿å®¢æ•° 
        <span id="leancloud-site-uv"></span>
         äºº
      </span>
    
    

  
</div>

  
  
  
  
  <!-- æ·»åŠ ç½‘ç«™è¿è¡Œæ—¶é—´ -->
  <div class="footer-content">
    <div>
      <span id="timeDate">è½½å…¥å¤©æ•°...</span>
      <span id="times">è½½å…¥æ—¶åˆ†ç§’...</span>
      <script>
      var now = new Date();
      function createtime(){
          var grt= new Date("01/01/2021 00:00:00");   //æ­¤å¤„ä¿®æ”¹ä½ çš„å»ºç«™æ—¶é—´æˆ–è€…ç½‘ç«™ä¸Šçº¿æ—¶é—´
          now.setTime(now.getTime()+250);
          days = (now - grt ) / 1000 / 60 / 60 / 24;
          dnum = Math.floor(days);
          hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum);
          hnum = Math.floor(hours);
          if(String(hnum).length ==1 ){
              hnum = "0" + hnum;
          }
          minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
          mnum = Math.floor(minutes);
          if(String(mnum).length ==1 ){
                    mnum = "0" + mnum;
          }
          seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
          snum = Math.round(seconds);
          if(String(snum).length ==1 ){
                    snum = "0" + snum;
          }
          document.getElementById("timeDate").innerHTML = "æœ¬ç«™å·²å®‰å…¨è¿è¡Œ&nbsp"+dnum+"&nbspå¤©";
          document.getElementById("times").innerHTML = hnum + "&nbspå°æ—¶&nbsp" + mnum + "&nbspåˆ†&nbsp" + snum + "&nbspç§’";
      }
      setInterval("createtime()", 250);
      </script>
    </div>
  </div>
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://cdn.staticfile.org/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.staticfile.org/jquery/3.7.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  

  

  

  

  

  

  
    
  




  
    
      <script  src="/js/img-lazyload.js" ></script>
    
  




  
<script>
  Fluid.utils.createScript('https://cdn.staticfile.org/tocbot/4.21.0/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script>
  (function() {
    var enableLang = CONFIG.code_language.enable && CONFIG.code_language.default;
    var enableCopy = CONFIG.copy_btn;
    if (!enableLang && !enableCopy) {
      return;
    }

    function getBgClass(ele) {
      return Fluid.utils.getBackgroundLightness(ele) >= 0 ? 'code-widget-light' : 'code-widget-dark';
    }

    var copyTmpl = '';
    copyTmpl += '<div class="code-widget">';
    copyTmpl += 'LANG';
    copyTmpl += '</div>';
    jQuery('.markdown-body pre').each(function() {
      var $pre = jQuery(this);
      if ($pre.find('code.mermaid').length > 0) {
        return;
      }
      if ($pre.find('span.line').length > 0) {
        return;
      }

      var lang = '';

      if (enableLang) {
        lang = CONFIG.code_language.default;
        if ($pre[0].children.length > 0 && $pre[0].children[0].classList.length >= 2 && $pre.children().hasClass('hljs')) {
          lang = $pre[0].children[0].classList[1];
        } else if ($pre[0].getAttribute('data-language')) {
          lang = $pre[0].getAttribute('data-language');
        } else if ($pre.parent().hasClass('sourceCode') && $pre[0].children.length > 0 && $pre[0].children[0].classList.length >= 2) {
          lang = $pre[0].children[0].classList[1];
          $pre.parent().addClass('code-wrapper');
        } else if ($pre.parent().hasClass('markdown-body') && $pre[0].classList.length === 0) {
          $pre.wrap('<div class="code-wrapper"></div>');
        }
        lang = lang.toUpperCase().replace('NONE', CONFIG.code_language.default);
      }
      $pre.append(copyTmpl.replace('LANG', lang).replace('code-widget">',
        getBgClass($pre[0]) + (enableCopy ? ' code-widget copy-btn" data-clipboard-snippet><i class="iconfont icon-copy"></i>' : ' code-widget">')));

      if (enableCopy) {
        Fluid.utils.createScript('https://cdn.staticfile.org/clipboard.js/2.0.11/clipboard.min.js', function() {
          var clipboard = new window.ClipboardJS('.copy-btn', {
            target: function(trigger) {
              var nodes = trigger.parentNode.childNodes;
              for (var i = 0; i < nodes.length; i++) {
                if (nodes[i].tagName === 'CODE') {
                  return nodes[i];
                }
              }
            }
          });
          clipboard.on('success', function(e) {
            e.clearSelection();
            e.trigger.innerHTML = e.trigger.innerHTML.replace('icon-copy', 'icon-success');
            setTimeout(function() {
              e.trigger.innerHTML = e.trigger.innerHTML.replace('icon-success', 'icon-copy');
            }, 2000);
          });
        });
      }
    });
  })();
</script>


  
<script>
  Fluid.utils.createScript('https://cdn.staticfile.org/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="/js/leancloud.js" ></script>





<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ï¼Œå°†å®ƒä¿æŒåœ¨æœ€åº•éƒ¨ -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div>
  </noscript>
</body>
</html>
