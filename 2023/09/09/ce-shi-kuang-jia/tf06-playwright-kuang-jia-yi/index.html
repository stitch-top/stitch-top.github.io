

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/logo.png">
  <link rel="icon" href="/img/logo.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Dr.626">
  <meta name="keywords" content="">
  
    <meta name="description" content="2020年微软开源的UI自动化测试工具， 支持Node.js、Python、Java等，为满足端到端测试创建，支持所有现代渲染引擎。">
<meta property="og:type" content="article">
<meta property="og:title" content="PlayWright 框架(一)">
<meta property="og:url" content="https://stitch-top.github.io/2023/09/09/ce-shi-kuang-jia/tf06-playwright-kuang-jia-yi/index.html">
<meta property="og:site_name" content="Dr.626">
<meta property="og:description" content="2020年微软开源的UI自动化测试工具， 支持Node.js、Python、Java等，为满足端到端测试创建，支持所有现代渲染引擎。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://stitch-top.github.io/img/ThemeMap/9314065155.jpg">
<meta property="article:published_time" content="2023-09-09T14:22:50.000Z">
<meta property="article:modified_time" content="2024-03-04T03:48:04.556Z">
<meta property="article:author" content="Dr.626">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="PlayWright">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://stitch-top.github.io/img/ThemeMap/9314065155.jpg">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>PlayWright 框架(一) - Dr.626</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/my.css">
<link rel="stylesheet" href="/css/scrollbar.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"stitch-top.github.io","root":"/","version":"1.9.0","typing":{"enable":true,"typeSpeed":70,"cursorChar":"|","loop":true,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":"(ง •_•)ง"},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"left","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":1},"lazyload":{"enable":true,"loading_img":"/img/load.gif","onlypost":true,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>

  
  
<meta name="generator" content="Hexo 6.2.0"></head>


<body>
  
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Dr.626</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                友链
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/back.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="PlayWright 框架(一)"></span>
          
        </div>

        
          
  <div class="mt-3">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-author" aria-hidden="true"></i>
        Dr.626
      </span>
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-09-09 22:22" pubdate>
          2023年9月9日 22:22:50
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          60k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          503 分钟
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
  
  <!-- 动态线条背景 -->
  <script type="text/javascript"
  color="0 0 255" opacity='1' zIndex="-2" count="200" src="../js/canvas-nest.js">
  </script>
  
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="padding-left: 2rem; margin-right: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">PlayWright 框架(一)</h1>
            
            <div class="markdown-body">
              
              <p>2020年微软开源的UI自动化测试工具， 支持Node.js、Python、Java等，为满足端到端测试创建，支持所有现代渲染引擎。</p>
<span id="more"></span>



<h1 id="1-浏览器操作"><a href="#1-浏览器操作" class="headerlink" title="1 浏览器操作"></a>1 浏览器操作</h1><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs Powershell">pip install playwright                                           <span class="hljs-comment"># 安装Playwright，Python版本要求3.7+</span><br>playwright install                                               <span class="hljs-comment"># 安装浏览器chromium、webkit和firefox</span><br>playwright install chromium                                      <span class="hljs-comment"># 安装指定的chromium浏览器</span><br></code></pre></td></tr></table></figure>



<h2 id="1-1-API"><a href="#1-1-API" class="headerlink" title="1-1 API"></a>1-1 API</h2><ul>
<li>API<ul>
<li>Playwright支持两种运行方式：同步和异步。<ul>
<li>同步运行指的是程序按照顺序执行，每个任务必须等待上一个任务完成后，才能进行下一个任务。</li>
<li>异步运行指的是程序可以同时执行多个任务，不需要等待上一个任务完成，就能进行下一个任务。</li>
</ul>
</li>
<li>官网地址：<a target="_blank" rel="noopener" href="https://playwright.dev/python/">https://playwright.dev/python/</a>。</li>
</ul>
</li>
</ul>
<h4 id="1-同步运行"><a href="#1-同步运行" class="headerlink" title="(1) 同步运行"></a>(1) 同步运行</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright                 <span class="hljs-comment"># sync同步(顺序)运行</span><br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>)                 <span class="hljs-comment"># 启动chromium浏览器</span><br>    <span class="hljs-comment"># browser = p.firefox.launch(headless=False)                # 启动firefox浏览器</span><br>    <span class="hljs-comment"># browser = p.webkit.launch(headless=False)                 # 启动webkit浏览器</span><br>    page = browser.new_page()                                   <span class="hljs-comment"># 打开一个标签页</span><br>    page.goto(<span class="hljs-string">&#x27;https://www.baidu.com&#x27;</span>)                          <span class="hljs-comment"># 打开百度地址</span><br>    <span class="hljs-built_in">print</span>(page.title())                                         <span class="hljs-comment"># 打印当前页面title</span><br><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h4 id="2-异步运行"><a href="#2-异步运行" class="headerlink" title="(2) 异步运行"></a>(2) 异步运行</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> asyncio<br><span class="hljs-keyword">from</span> playwright.async_api <span class="hljs-keyword">import</span> async_playwright               <span class="hljs-comment"># async异步(同时)运行</span><br><br><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> async_playwright() <span class="hljs-keyword">as</span> p:<br>        browser = <span class="hljs-keyword">await</span> p.chromium.launch(headless=<span class="hljs-literal">False</span>)       <span class="hljs-comment"># 启动chromium浏览器</span><br>        <span class="hljs-comment"># browser = await p.firefox.launch(headless=False)      # 启动firefox浏览器</span><br>        <span class="hljs-comment"># browser = await p.webkit.launch(headless=False)       # 启动webkit浏览器</span><br>        page = <span class="hljs-keyword">await</span> browser.new_page()                         <span class="hljs-comment"># 打开一个标签页</span><br>        <span class="hljs-keyword">await</span> page.goto(<span class="hljs-string">&#x27;https://www.baidu.com&#x27;</span>)                <span class="hljs-comment"># 打开百度地址</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-keyword">await</span> page.title())                               <span class="hljs-comment"># 打印当前页面title</span><br><br>        <span class="hljs-keyword">await</span> browser.close()                                   <span class="hljs-comment"># 关闭浏览器对象</span><br><br>asyncio.run(main())<br></code></pre></td></tr></table></figure>



<h2 id="1-2-上下文"><a href="#1-2-上下文" class="headerlink" title="1-2 上下文"></a>1-2 上下文</h2><ul>
<li>上下文<ul>
<li>Playwright的测试层级关系：<code>Broswer &gt; Context &gt; Page</code>。</li>
<li><code>browser = playwright.chromium.launch()</code>：启动浏览器。</li>
<li><code>context = browser.new_context()</code>：创建context对象，即启动上下文。<ul>
<li>context之间相互隔离，即为轻量级的浏览器实例，不与其他浏览器上下文共享cookie或缓存。</li>
<li>如果需要不同用户登录同一个网页，不用创建多个浏览器实例，只需要创建多个context即可。</li>
</ul>
</li>
<li><code>context.add_cookies([cookie_object1, cookie_object2])</code>：添加cookie。</li>
<li>配置选项：无痕模式启动浏览器适合自动化测试、非无痕模式启动适合爬数据。</li>
<li>launch_persistent_context参数<ul>
<li>user_data_dir：用户数据目录，此参数必须，可自定义目录，不推荐写Chrome安装目录。<ul>
<li>网站是否可以保持登录，主要看cookies有效期，有些网站关闭浏览器登录状态就失效。</li>
<li>例如银行网站，有些博客站，登录后cookies一直生效，即利用缓存的cookies保持登录。</li>
</ul>
</li>
<li>channel：指定浏览器的类型，默认chromium，支持chromium、chrome、msedge。</li>
<li>若同时打开多个浏览器，每个浏览器登录不同的账号进行操作，则要用到多线程。</li>
</ul>
</li>
<li>测试在浏览器上下文的隔离全新环境中执行，隔离模型提高了可重复性，并防止级联测试失败。<ul>
<li>Playwright使用BrowserContext实现测试隔离，相当于隐身式配置文件。</li>
<li>测试隔离有两种不同的策略，从头开始清理，以及在两者之间进行清理。</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime, timedelta<br><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>)                 <span class="hljs-comment"># 启动浏览器</span><br>    <span class="hljs-comment"># context = browser.new_context()                           # 启动上下文</span><br>    context = browser.new_context(base_url=<span class="hljs-string">&quot;https://www.baidu.com&quot;</span>)<br>    current_time = datetime.now()                               <span class="hljs-comment"># 获取当前日期时间</span><br>    expires_time = current_time + timedelta(days=<span class="hljs-number">7</span>)             <span class="hljs-comment"># 计算过期时间</span><br>    expires_time = <span class="hljs-built_in">int</span>(expires_time.timestamp())                <span class="hljs-comment"># 转换为时间戳</span><br>    context.add_cookies([                                       <span class="hljs-comment"># 添加cookie</span><br>        &#123;<br>            <span class="hljs-string">&#x27;name&#x27;</span>: <span class="hljs-string">&#x27;BIDUPSID&#x27;</span>,                                 <span class="hljs-comment"># 参数为字典列表，url可选</span><br>            <span class="hljs-string">&#x27;value&#x27;</span>: <span class="hljs-string">&#x27;BFBAD64EE3482122786F502E5D073773&#x27;</span>,<br>            <span class="hljs-string">&#x27;path&#x27;</span>: <span class="hljs-string">&#x27;/&#x27;</span>,<br>            <span class="hljs-string">&#x27;domain&#x27;</span>: <span class="hljs-string">&#x27;.baidu.com&#x27;</span>,<br>            <span class="hljs-string">&#x27;expires&#x27;</span>: expires_time,                            <span class="hljs-comment"># 这里使用的是时间戳，可选</span><br>            <span class="hljs-string">&#x27;httpOnly&#x27;</span>: <span class="hljs-literal">False</span>,                                  <span class="hljs-comment"># 是否为httpOnly，可选</span><br>            <span class="hljs-string">&#x27;secure&#x27;</span>: <span class="hljs-literal">False</span>,                                    <span class="hljs-comment"># 安全模式，可选</span><br>            <span class="hljs-string">&#x27;sameSite&#x27;</span>: <span class="hljs-string">&#x27;Lax&#x27;</span>                                   <span class="hljs-comment"># Strict|Lax|None，同站策略，可选</span><br>        &#125;,<br>        &#123;<br>            <span class="hljs-string">&#x27;name&#x27;</span>: <span class="hljs-string">&#x27;session_token&#x27;</span>,<br>            <span class="hljs-string">&#x27;value&#x27;</span>: <span class="hljs-string">&#x27;BFBAD64EE3482122786F502E5D073774&#x27;</span>,<br>            <span class="hljs-string">&#x27;path&#x27;</span>: <span class="hljs-string">&#x27;/&#x27;</span>,<br>            <span class="hljs-string">&#x27;domain&#x27;</span>: <span class="hljs-string">&#x27;baidu.com&#x27;</span>,<br>            <span class="hljs-string">&#x27;expires&#x27;</span>: expires_time,<br>            <span class="hljs-string">&#x27;httpOnly&#x27;</span>: <span class="hljs-literal">False</span>,<br>            <span class="hljs-string">&#x27;secure&#x27;</span>: <span class="hljs-literal">False</span>,<br>            <span class="hljs-string">&#x27;sameSite&#x27;</span>: <span class="hljs-string">&#x27;Lax&#x27;</span><br>        &#125;<br>    ])<br>    page = context.new_page()                                   <span class="hljs-comment"># context上新建一个页面对象</span><br>    <span class="hljs-comment"># page.goto(&#x27;https://www.baidu.com&#x27;)                        # 打开百度地址</span><br>    page.goto(<span class="hljs-string">&quot;/&quot;</span>)                                              <span class="hljs-comment"># base_url参数在新建上下文时使用</span><br>    <span class="hljs-built_in">print</span>(page.title())                                         <span class="hljs-comment"># 打印当前页面title</span><br><br>    cookies = context.cookies()                                 <span class="hljs-comment"># 检查是否成功添加cookie</span><br>    <span class="hljs-built_in">print</span>(cookies)<br><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h4 id="1-无痕模式"><a href="#1-无痕模式" class="headerlink" title="(1) 无痕模式"></a>(1) 无痕模式</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>)<br>    context = browser.new_context()                             <span class="hljs-comment"># launch默认无痕模式启动</span><br>    page = context.new_page()                                   <span class="hljs-comment"># 打开标签页</span><br><br>    page.goto(<span class="hljs-string">&#x27;https://www.baidu.com&#x27;</span>)<br>    page.wait_for_timeout(<span class="hljs-number">3000</span>)<br><br>    context.close()                                             <span class="hljs-comment"># 关闭上下文</span><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h4 id="2-非无痕模式"><a href="#2-非无痕模式" class="headerlink" title="(2) 非无痕模式"></a>(2) 非无痕模式</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br>p = sync_playwright().start()<br>browser = p.chromium.launch_persistent_context(                 <span class="hljs-comment"># 创建上下文对象</span><br>    user_data_dir=<span class="hljs-string">f&quot;...\cache&quot;</span>,                                 <span class="hljs-comment"># 自定义用户缓存地址</span><br>    accept_downloads=<span class="hljs-literal">True</span>,                                      <span class="hljs-comment"># 接收下载事件</span><br>    headless=<span class="hljs-literal">False</span>,                                             <span class="hljs-comment"># 设置无头模式</span><br>    bypass_csp=<span class="hljs-literal">True</span>,<br>    slow_mo=<span class="hljs-number">1000</span>,<br>    channel=<span class="hljs-string">&quot;chromium&quot;</span>,                                         <span class="hljs-comment"># 指定浏览器类型，默认chromium</span><br>    args=[<span class="hljs-string">&#x27;--start-maximized&#x27;</span>],                                 <span class="hljs-comment"># args结合no_viewport窗口最大化</span><br>    no_viewport=<span class="hljs-literal">True</span>,                                           <span class="hljs-comment"># 全屏覆盖</span><br>    <span class="hljs-comment"># viewport=&#123;&#x27;width&#x27;: 1920, &#x27;height&#x27;: 1080&#125;,                 # 设置屏幕分辨率，全屏移位</span><br>)<br><span class="hljs-comment"># page = browser.new_page()                                     # 该方法会打开一个空白的tab页</span><br>page = browser.pages[<span class="hljs-number">0</span>]                                         <span class="hljs-comment"># 默认打开tab标签页对象</span><br><br>page.goto(<span class="hljs-string">&#x27;https://www.baidu.com&#x27;</span>)<br>page.wait_for_timeout(<span class="hljs-number">3000</span>)<br><br>browser.close()                                                 <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h4 id="3-同浏不同标签"><a href="#3-同浏不同标签" class="headerlink" title="(3) 同浏不同标签"></a>(3) 同浏不同标签</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>, slow_mo=<span class="hljs-number">1000</span>)   <span class="hljs-comment"># 启动浏览器</span><br>    context = browser.new_context()                             <span class="hljs-comment"># 启动上下文</span><br><br>    page1 = context.new_page()                                  <span class="hljs-comment"># 打开标签页1</span><br>    page1.goto(<span class="hljs-string">&quot;https://www.baidu.com/&quot;</span>)<br>    page1.fill(<span class="hljs-string">&#x27;#kw&#x27;</span>, <span class="hljs-string">&quot;Playwright&quot;</span>)<br>    page1.wait_for_timeout(<span class="hljs-number">3000</span>)<br><br>    page2 = context.new_page()                                  <span class="hljs-comment"># 打开标签页2</span><br>    page2.goto(<span class="hljs-string">&quot;https://fanyi.baidu.com/&quot;</span>)<br>    page2.fill(<span class="hljs-string">&#x27;#baidu_translate_input&#x27;</span>, <span class="hljs-string">&quot;English&quot;</span>)<br>    page2.wait_for_timeout(<span class="hljs-number">3000</span>)<br><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h4 id="4-不同浏同标签"><a href="#4-不同浏同标签" class="headerlink" title="(4) 不同浏同标签"></a>(4) 不同浏同标签</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>, slow_mo=<span class="hljs-number">1000</span>)   <span class="hljs-comment"># 启动浏览器</span><br>    context1 = browser.new_context()                            <span class="hljs-comment"># 创建上下文1，浏览器实例1</span><br>    context2 = browser.new_context()                            <span class="hljs-comment"># 创建上下文2，浏览器实例2</span><br>    page1 = context1.new_page()                                 <span class="hljs-comment"># 打开标签页1</span><br>    page1.goto(<span class="hljs-string">&quot;https://www.baidu.com/&quot;</span>)<br><br>    page2 = context2.new_page()                                 <span class="hljs-comment"># 打开标签页1</span><br>    page2.goto(<span class="hljs-string">&quot;https://www.baidu.com/&quot;</span>)<br><br>    context1.close()<br>    context2.close()                                            <span class="hljs-comment"># 关闭上下文时，所属页面也会一起关闭</span><br>    browser.close()                                             <span class="hljs-comment"># 先关闭上下文，再退出浏览器</span><br></code></pre></td></tr></table></figure>



<h2 id="1-3-无头模式"><a href="#1-3-无头模式" class="headerlink" title="1-3 无头模式"></a>1-3 无头模式</h2><ul>
<li>无头模式<ul>
<li>默认情况下，Playwright是以headless无头模式运行浏览器的。</li>
<li><code>headless=False</code>在启动浏览器时传递标志，可查看浏览器UI。</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(slow_mo=<span class="hljs-number">1000</span>)                    <span class="hljs-comment"># 无头模式启动chromium浏览器</span><br>    page = browser.new_page()                                    <span class="hljs-comment"># 打开一个标签页</span><br>    page.goto(<span class="hljs-string">&#x27;https://www.baidu.com&#x27;</span>)                           <span class="hljs-comment"># 打开百度地址</span><br>    <span class="hljs-built_in">print</span>(page.title())                                          <span class="hljs-comment"># 打印当前页面title</span><br><br>    browser.close()                                              <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h2 id="1-4-截图使用"><a href="#1-4-截图使用" class="headerlink" title="1-4 截图使用"></a>1-4 截图使用</h2><ul>
<li>截图使用<ul>
<li>除截取当前屏幕外，还支持截取长图，也可对某个元素截图。</li>
<li>快速截图方法：<code>page.screenshot(path=&quot;screenshot.png&quot;)</code>。</li>
<li>截取单元素方法：<code>page.locator().screenshot(path=&quot;screenshot.png&quot;)</code>。</li>
<li>捕获图片数据流：<code>print(base64.b64encode(page.screenshot()).decode())</code>。</li>
<li>截取长图方法：<code>page.screenshot(path=&quot;screenshot.png&quot;, full_page=True)</code>。</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>)                 <span class="hljs-comment"># 启动chromium浏览器</span><br>    page = browser.new_page()                                   <span class="hljs-comment"># 打开一个标签页</span><br>    page.goto(<span class="hljs-string">&#x27;https://www.baidu.com&#x27;</span>)                          <span class="hljs-comment"># 打开百度地址</span><br>    <span class="hljs-built_in">print</span>(page.title())                                         <span class="hljs-comment"># 打印当前页面title</span><br><br>    page.screenshot(path=<span class="hljs-string">&quot;pictures/baidu_com.png&quot;</span>)              <span class="hljs-comment"># 快速截图</span><br>    screenshot_bytes = page.locator(<span class="hljs-string">&quot;#s_lg_img&quot;</span>).screenshot(path=<span class="hljs-string">&quot;pictures/single_element.png&quot;</span>)<br>    <span class="hljs-built_in">print</span>(base64.b64encode(screenshot_bytes).decode())          <span class="hljs-comment"># 捕获单元素图片数据流</span><br><br>    page.goto(<span class="hljs-string">&#x27;https://news.baidu.com/&#x27;</span>)                        <span class="hljs-comment"># 打开百度新闻</span><br>    <span class="hljs-built_in">print</span>(page.title())                                         <span class="hljs-comment"># 打印当前页面title</span><br>    page.screenshot(path=<span class="hljs-string">&quot;pictures/baidu_news.png&quot;</span>, full_page=<span class="hljs-literal">True</span>)<br><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h2 id="1-5-视频录制"><a href="#1-5-视频录制" class="headerlink" title="1-5 视频录制"></a>1-5 视频录制</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>, slow_mo=<span class="hljs-number">100</span>)<br>    context = browser.new_context(<br>        record_video_dir=<span class="hljs-string">&quot;videos/&quot;</span>,<br>        record_video_size=&#123;<span class="hljs-string">&quot;width&quot;</span>: <span class="hljs-number">640</span>, <span class="hljs-string">&quot;height&quot;</span>: <span class="hljs-number">480</span>&#125;         <span class="hljs-comment"># 指定视频大小，默认800x800</span><br>    )<br>    page = context.new_page()                                   <span class="hljs-comment"># 打开标签页</span><br>    page.goto(<span class="hljs-string">&quot;https://www.baidu.com/&quot;</span>)<br>    page.wait_for_timeout(<span class="hljs-number">1000</span>)<br><br>    path = page.video.path()<br>    <span class="hljs-built_in">print</span>(path)                                                 <span class="hljs-comment"># 获取保存视频路径</span><br><br>    context.close()                                             <span class="hljs-comment"># 确保调用close，视频才会保存</span><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h2 id="1-6-弹出窗口"><a href="#1-6-弹出窗口" class="headerlink" title="1-6 弹出窗口"></a>1-6 弹出窗口</h2><ul>
<li>弹出窗口<ul>
<li>页面中，通过链接打开一个弹出窗口，可以通过监听页面上的事件<code>target=&quot;_blank&quot;</code>来获取引用。</li>
<li>处理弹出窗口时，可以选择监听此特定事件，以便更精确地捕获与当前页面关联的弹出窗口信息。</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">handle_popup</span>(<span class="hljs-params">popup</span>):                                        <span class="hljs-comment"># 触发弹出窗口的操作未知时使用</span><br>    popup.wait_for_load_state()<br>    <span class="hljs-built_in">print</span>(popup.title())<br><br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>, slow_mo=<span class="hljs-number">1000</span>)   <span class="hljs-comment"># 启动chromium浏览器</span><br>    page = browser.new_page()                                   <span class="hljs-comment"># 打开一个标签页</span><br>    page.goto(<span class="hljs-string">&quot;https://www.baidu.com/&quot;</span>)<br>    <span class="hljs-built_in">print</span>(page.title())<br><br>    <span class="hljs-comment"># with page.expect_popup() as popup_info:</span><br>    <span class="hljs-comment">#     page.locator(&quot;#s-top-left &gt; a:nth-child(1)&quot;).click()</span><br>    <span class="hljs-comment"># popup = popup_info.value</span><br>    <span class="hljs-comment"># popup.wait_for_load_state()                               # 等待弹出窗口加载完毕</span><br>    <span class="hljs-comment"># print(popup.title())</span><br>    <br>    page.on(<span class="hljs-string">&quot;popup&quot;</span>, handle_popup)<br>    page.locator(<span class="hljs-string">&quot;#s-top-left &gt; a:nth-child(1)&quot;</span>).click()<br>    page.wait_for_timeout(<span class="hljs-number">1000</span>)                                 <span class="hljs-comment"># 操作未知，最好加一个等待</span><br><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h2 id="1-7-切换标签页"><a href="#1-7-切换标签页" class="headerlink" title="1-7 切换标签页"></a>1-7 切换标签页</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>, slow_mo=<span class="hljs-number">1000</span>)   <span class="hljs-comment"># 启动浏览器</span><br>    context = browser.new_context()                             <span class="hljs-comment"># 启动上下文</span><br>    page = context.new_page()                                   <span class="hljs-comment"># 打开标签页</span><br>    page.goto(<span class="hljs-string">&quot;https://www.baidu.com/&quot;</span>)<br>    <span class="hljs-built_in">print</span>(page.title())<br><br>    <span class="hljs-keyword">with</span> context.expect_page() <span class="hljs-keyword">as</span> new_page_info:<br>        page.click(<span class="hljs-string">&quot;text=新闻&quot;</span>)<br>    new_page = new_page_info.value<br>    new_page.wait_for_load_state()                              <span class="hljs-comment"># 等待页面加载到指定状态</span><br>    <span class="hljs-built_in">print</span>(new_page.title())<br><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h4 id="1-遍历page对象"><a href="#1-遍历page对象" class="headerlink" title="(1) 遍历page对象"></a>(1) 遍历page对象</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>, slow_mo=<span class="hljs-number">1000</span>)   <span class="hljs-comment"># 启动浏览器</span><br>    context = browser.new_context()                             <span class="hljs-comment"># 启动上下文</span><br>    page = context.new_page()                                   <span class="hljs-comment"># 打开标签页</span><br>    page.goto(<span class="hljs-string">&quot;https://www.baidu.com/&quot;</span>)<br><br>    <span class="hljs-keyword">for</span> link <span class="hljs-keyword">in</span> page.locator(<span class="hljs-string">&#x27;#s-top-left&gt;a&#x27;</span>).<span class="hljs-built_in">all</span>():            <span class="hljs-comment"># 点开多个标签页</span><br>        link.click()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> context.pages:                                     <span class="hljs-comment"># 遍历page对象</span><br>        <span class="hljs-built_in">print</span>(i.title())<br><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h4 id="2-title和url判断"><a href="#2-title和url判断" class="headerlink" title="(2) title和url判断"></a>(2) title和url判断</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">switch_to_page</span>(<span class="hljs-params">context, title=<span class="hljs-literal">None</span>, url=<span class="hljs-literal">None</span></span>):<br>    <span class="hljs-keyword">for</span> item_page <span class="hljs-keyword">in</span> context.pages:<br>        <span class="hljs-keyword">if</span> title:<br>            <span class="hljs-keyword">if</span> title <span class="hljs-keyword">in</span> item_page.title():<br>                item_page.bring_to_front()                      <span class="hljs-comment"># 激活当前选项卡</span><br>                <span class="hljs-comment"># print(item_page.title())                      # 打印页面标题</span><br>                <span class="hljs-keyword">return</span> item_page<br>        <span class="hljs-keyword">elif</span> url:<br>            <span class="hljs-keyword">if</span> url <span class="hljs-keyword">in</span> item_page.url:<br>                item_page.bring_to_front()                      <span class="hljs-comment"># 激活当前选项卡</span><br>                <span class="hljs-keyword">return</span> item_page<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;找不到标题或URL！&quot;</span>)<br>    <span class="hljs-keyword">return</span> context.pages[<span class="hljs-number">0</span>]<br><br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>)<br>    context = browser.new_context()                             <span class="hljs-comment"># 启动上下文</span><br>    page = context.new_page()                                   <span class="hljs-comment"># 打开标签页</span><br>    page.goto(<span class="hljs-string">&quot;https://www.baidu.com/&quot;</span>)<br><br>    <span class="hljs-keyword">for</span> link <span class="hljs-keyword">in</span> page.locator(<span class="hljs-string">&#x27;#s-top-left&gt;a&#x27;</span>).<span class="hljs-built_in">all</span>():            <span class="hljs-comment"># 点开多个标签页</span><br>        link.click()<br>        page.wait_for_timeout(<span class="hljs-number">1000</span>)<br>    page_switch = switch_to_page(context, title=<span class="hljs-string">&#x27;hao&#x27;</span>)          <span class="hljs-comment"># 切换到包含hao的标签页</span><br>    <span class="hljs-built_in">print</span>(page_switch.title())<br><br>    <span class="hljs-keyword">for</span> item_page <span class="hljs-keyword">in</span> context.pages:                             <span class="hljs-comment"># 切换并打印所有标签页的标题</span><br>        switch_to_page(context, title=item_page.title())<br>        <span class="hljs-built_in">print</span>(item_page.title())<br><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h2 id="1-8-浏览器窗口"><a href="#1-8-浏览器窗口" class="headerlink" title="1-8 浏览器窗口"></a>1-8 浏览器窗口</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>)<br>    context = browser.new_context(<br>        viewport=&#123;<span class="hljs-string">&#x27;width&#x27;</span>: <span class="hljs-number">1200</span>, <span class="hljs-string">&#x27;height&#x27;</span>: <span class="hljs-number">600</span>&#125;,                <span class="hljs-comment"># viewport参数指定窗口大小</span><br>    )<br>    page = context.new_page()<br>    page.goto(<span class="hljs-string">&quot;https://www.baidu.com/&quot;</span>)<br>    page.fill(<span class="hljs-string">&#x27;#kw&#x27;</span>, <span class="hljs-string">&#x27;Playwright教程&#x27;</span>)<br>    page.click(<span class="hljs-string">&#x27;#su&#x27;</span>)<br>    page.wait_for_timeout(<span class="hljs-number">3000</span>)<br><br>    page.go_back()                                              <span class="hljs-comment"># 后退 &lt;—</span><br>    page.wait_for_timeout(<span class="hljs-number">3000</span>)<br>    page.reload()                                               <span class="hljs-comment"># 刷新</span><br>    page.wait_for_timeout(<span class="hljs-number">3000</span>)<br>    page.go_forward()                                           <span class="hljs-comment"># 前进 —&gt;</span><br>    page.wait_for_timeout(<span class="hljs-number">3000</span>)<br><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>

<ul>
<li>窗口最大化<ul>
<li>启动浏览器时，通过参数<code>args=[&#39;--start-maximized&#39;]</code>开启最大化。</li>
<li>并设置<code>no_viewport</code>参数为True，否则默认按800*600像素创建窗口。</li>
<li>若不是通过context上下文创建的page对象，可以直接将viewport参数写到<code>new_page()</code>里。</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(<br>        headless=<span class="hljs-literal">False</span>,<br>        args=[<span class="hljs-string">&#x27;--start-maximized&#x27;</span>]                              <span class="hljs-comment"># 启动浏览器时，开启最大化</span><br>    )<br>    context = browser.new_context(no_viewport=<span class="hljs-literal">True</span>)             <span class="hljs-comment"># no_viewport禁止限制窗口大小</span><br>    page = context.new_page()<br>    page.goto(<span class="hljs-string">&quot;https://www.baidu.com/&quot;</span>)<br><br>    page.pause()                                                <span class="hljs-comment"># 调试方法，在当前页面暂停执行，等待操作</span><br></code></pre></td></tr></table></figure>



<h2 id="1-9-特定设备打开"><a href="#1-9-特定设备打开" class="headerlink" title="1-9 特定设备打开"></a>1-9 特定设备打开</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    iphone_13 = p.devices[<span class="hljs-string">&#x27;iPhone 13&#x27;</span>]                          <span class="hljs-comment"># 以iPhone 13形式打开</span><br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>)<br>    context = browser.new_context(**iphone_13)<br>    page = context.new_page()<br>    page.goto(<span class="hljs-string">&quot;https://www.baidu.com/&quot;</span>)<br>    page.wait_for_timeout(<span class="hljs-number">3000</span>)<br><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h1 id="2-页面元素定位"><a href="#2-页面元素定位" class="headerlink" title="2 页面元素定位"></a>2 页面元素定位</h1><ul>
<li>页面元素定位<ul>
<li>选择器(Selector)：用于创建定位器的字符串。<ul>
<li>CSS和XPath<ul>
<li>通过CSS选择器、XPath选择器，依据元素属性、标签名、文本内容等特征来定位元素。</li>
<li>操作元素可使用定位器(Locator)先定位再操作，也可直接定位方法后再传选择器(推荐)。</li>
</ul>
</li>
<li>文本内容：指定元素所包含的文本内容，可以找到对应的元素。</li>
<li>属性：指定元素的某个属性及其对应的值，可以唯一地定位到元素。</li>
<li>坐标：通过指定元素在页面中的x和y坐标，可以精确地定位到元素。</li>
<li>元素层级关系：通过元素的父元素、子元素、相邻元素等关系来确定元素的位置。</li>
</ul>
</li>
<li>定位器(Locator)：Playwright自动等待和重试能力的核心部分。</li>
<li>输入文字：fill()是填写表单字段的最简方法、type()键入字符。</li>
<li>鼠标点击click()、拖放drag_to()、下拉框选择select_option()。</li>
<li>iframe定位、单选与复选set_checked()、聚焦给定元素focus()。</li>
</ul>
</li>
</ul>
<h2 id="2-1-选择器"><a href="#2-1-选择器" class="headerlink" title="2-1 选择器"></a>2-1 选择器</h2><ul>
<li>选择器<ul>
<li>CSS和XPath<ul>
<li>浏览器F12开发者工具，Elements中鼠标选中元素右键可以Copy选择器或XPath内容。</li>
<li><code>page.fill(&#39;css=#kw&#39;, &#39;Playwright&#39;)</code>、<code>page.click(&#39;xpath=//*[@id=&quot;su&quot;]&#39;)</code>。</li>
<li><code>page.fill(&#39;#kw&#39;, &#39;Playwright&#39;)</code>、<code>page.click(&#39;//*[@id=&quot;su&quot;]&#39;)</code>(前缀可不写)。</li>
<li>长CSS或XPath链容易不稳定，选择器绑定到DOM，结构发生变化时选择器可能会中断。</li>
</ul>
</li>
<li>文本内容<ul>
<li>Playwright封装了两种text文本定位的方式。<ul>
<li><code>page.click(&quot;text=xxx&quot;)</code>：无引号，模糊匹配，对大小写不敏感。</li>
<li><code>page.click(&quot;text=&#39;xxx&#39;&quot;)</code>：有引号，精确匹配，对大小写敏感。</li>
</ul>
</li>
<li>除了支持定位a标签，还可以定位button按钮、input标签的button按钮。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="1-CSS和XPath"><a href="#1-CSS和XPath" class="headerlink" title="(1) CSS和XPath"></a>(1) CSS和XPath</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>, slow_mo=<span class="hljs-number">1000</span>)   <span class="hljs-comment"># 启动浏览器</span><br>    page = browser.new_page()<br>    page.goto(<span class="hljs-string">&#x27;https://www.baidu.com&#x27;</span>)                          <span class="hljs-comment"># 打开百度地址</span><br>    <span class="hljs-built_in">print</span>(page.title())                                         <span class="hljs-comment"># 打印当前页面title</span><br>    page.wait_for_timeout(<span class="hljs-number">3000</span>)<br><br>    page.fill(<span class="hljs-string">&#x27;//*[@id=&quot;kw&quot;]&#x27;</span>, <span class="hljs-string">&#x27;Playwright&#x27;</span>)                    <span class="hljs-comment"># XPath</span><br>    page.click(<span class="hljs-string">&#x27;#su&#x27;</span>)                                           <span class="hljs-comment"># CSS</span><br><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h4 id="2-文本定位a标签"><a href="#2-文本定位a标签" class="headerlink" title="(2) 文本定位a标签"></a>(2) 文本定位a标签</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>, slow_mo=<span class="hljs-number">1000</span>)   <span class="hljs-comment"># 启动浏览器</span><br>    page = browser.new_page()<br>    page.goto(<span class="hljs-string">&#x27;https://www.baidu.com&#x27;</span>)                          <span class="hljs-comment"># 打开百度地址</span><br>    <span class="hljs-built_in">print</span>(page.title())                                         <span class="hljs-comment"># 打印当前页面title</span><br><br>    page.click(<span class="hljs-string">&#x27;text=新闻&#x27;</span>)<br>    page.wait_for_timeout(<span class="hljs-number">3000</span>)                                 <span class="hljs-comment"># 等待3秒</span><br><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h4 id="3-文本定位button"><a href="#3-文本定位button" class="headerlink" title="(3) 文本定位button"></a>(3) 文本定位button</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>, slow_mo=<span class="hljs-number">1000</span>)   <span class="hljs-comment"># 启动浏览器</span><br>    page = browser.new_page()<br>    page.goto(<span class="hljs-string">&#x27;https://www.baidu.com&#x27;</span>)                          <span class="hljs-comment"># 打开百度地址</span><br>    <span class="hljs-built_in">print</span>(page.title())                                         <span class="hljs-comment"># 打印当前页面title</span><br><br>    page.fill(<span class="hljs-string">&quot;#kw&quot;</span>, <span class="hljs-string">&quot;Playwright&quot;</span>)<br>    page.click(<span class="hljs-string">&#x27;text=百度一下&#x27;</span>)<br>    page.wait_for_timeout(<span class="hljs-number">3000</span>)                                 <span class="hljs-comment"># 等待3秒</span><br><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h4 id="4-获取内容与文本"><a href="#4-获取内容与文本" class="headerlink" title="(4) 获取内容与文本"></a>(4) 获取内容与文本</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>, slow_mo=<span class="hljs-number">100</span>)<br>    context = browser.new_context()                             <span class="hljs-comment"># 创建上下文</span><br>    page = context.new_page()                                   <span class="hljs-comment"># 打开标签页</span><br>    page.goto(<span class="hljs-string">&quot;https://www.baidu.com/&quot;</span>)<br><br>    <span class="hljs-built_in">print</span>(page.content())                                       <span class="hljs-comment"># 获取整个页面的html内容</span><br>    page.wait_for_load_state(<span class="hljs-string">&quot;networkidle&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;-----------------分割线-----------------&quot;</span>)<br><br>    a = page.locator(<span class="hljs-string">&#x27;#s-top-left&gt;a&#x27;</span>).first<br>    <span class="hljs-built_in">print</span>(a.get_attribute(<span class="hljs-string">&#x27;href&#x27;</span>))                              <span class="hljs-comment"># 获取元素属性</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;-----------------分割线-----------------&quot;</span>)<br><br>    b = page.locator(<span class="hljs-string">&#x27;//*[@id=&quot;s-top-left&quot;]&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(b.inner_html())                                       <span class="hljs-comment"># 获取元素下的html内容</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;-----------------分割线-----------------&quot;</span>)<br>    <span class="hljs-built_in">print</span>(b.inner_text())                                       <span class="hljs-comment"># 获取元素的文本内容</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;-----------------分割线-----------------&quot;</span>)<br>    <span class="hljs-built_in">print</span>(b.all_inner_texts())                                  <span class="hljs-comment"># 列表显示获取到的页面内容</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;-----------------分割线-----------------&quot;</span>)<br>    <span class="hljs-built_in">print</span>(b.all_text_contents())                                <span class="hljs-comment"># 列表显示获取到的元素下所有内容</span><br><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h4 id="5-获取输入框的值"><a href="#5-获取输入框的值" class="headerlink" title="(5) 获取输入框的值"></a>(5) 获取输入框的值</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>, slow_mo=<span class="hljs-number">100</span>)<br>    context = browser.new_context()                             <span class="hljs-comment"># 创建上下文</span><br>    page = context.new_page()                                   <span class="hljs-comment"># 打开标签页</span><br>    page.goto(<span class="hljs-string">&quot;https://www.baidu.com/&quot;</span>)<br>    page.wait_for_load_state(<span class="hljs-string">&quot;networkidle&quot;</span>)<br><br>    input1 = page.locator(<span class="hljs-string">&#x27;#kw&#x27;</span>)<br>    input1.fill(<span class="hljs-string">&#x27;Playwright&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(input1.input_value())                                 <span class="hljs-comment"># 获取输入框的值</span><br><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h4 id="6-选择器组合定位"><a href="#6-选择器组合定位" class="headerlink" title="(6) 选择器组合定位"></a>(6) 选择器组合定位</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>, slow_mo=<span class="hljs-number">1000</span>)   <span class="hljs-comment"># 启动浏览器</span><br>    page = browser.new_page()<br>    page.goto(<span class="hljs-string">&#x27;https://passport.baidu.com/v2/?login&#x27;</span>)           <span class="hljs-comment"># 打开百度登录页面</span><br>    <span class="hljs-built_in">print</span>(page.title())                                         <span class="hljs-comment"># 打印当前页面title</span><br><br>    page.wait_for_selector(<span class="hljs-string">&#x27;text=用户名登录&#x27;</span>).click()<br>    page.fill(<span class="hljs-string">&#x27;form &gt;&gt; [name=&quot;userName&quot;]&#x27;</span>, <span class="hljs-string">&#x27;Test&#x27;</span>)              <span class="hljs-comment"># 不同的选择器组合使用，用&gt;&gt;连接</span><br>    <span class="hljs-comment"># page.locator(&quot;form&quot;).locator(&#x27;[name=&quot;userName&quot;]&#x27;).fill(&quot;Test&quot;)</span><br>    page.fill(<span class="hljs-string">&#x27;form &gt;&gt; [name=&quot;password&quot;]&#x27;</span>, <span class="hljs-string">&quot;A.123456&quot;</span>)<br>    <span class="hljs-comment"># page.locator(&quot;form&quot;).locator(&#x27;[name=&quot;password&quot;]&#x27;).fill(&quot;A.123456&quot;)</span><br>    <span class="hljs-comment"># page.click(&#x27;//*[@id=&quot;TANGRAM__PSP_3__submit&quot;]&#x27;)</span><br>    page.click(<span class="hljs-string">&quot;text=&#x27;登录&#x27;&quot;</span>)<br>    page.wait_for_timeout(<span class="hljs-number">3000</span>)                                 <span class="hljs-comment"># 等待3秒</span><br><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h2 id="2-2-定位器"><a href="#2-2-定位器" class="headerlink" title="2-2 定位器"></a>2-2 定位器</h2><ul>
<li>定位器<ul>
<li>过滤定位器：<code>locator.filter()</code>可以对locator定位到的元素进行筛选过滤。<ul>
<li><code>count()</code>：统计元素的个数。</li>
<li><code>first</code>：定位多个时，匹配第一个。</li>
<li><code>last</code>：定位多个时，匹配最后一个。</li>
<li><code>nth()</code>：定位多个时，根据索引定位元素。</li>
</ul>
</li>
<li>Locator定位机制与元素句柄ElementHandle<ul>
<li><code>locator()</code>是定位当前页面元素，不会自动等待，若结合click等方法，会自动等待处于可操作状态。</li>
<li>JavaScript中ElementHandle即页内DOM元素，ElementHandles使用page.query_selector()方法创建。</li>
<li>Locator和ElementHandle之间的区别在于后者指向特定元素，而Locator捕获元素，检索元素的逻辑。</li>
<li>不鼓励使用ElementHandle，而是使用Locator对象和网络优先断言。<ul>
<li>Selenium采用的是HTTP协议，获取的元素句柄是固定的，不能实时去获取页面上的元素。</li>
<li>Playwright采用Websocket协议，可实时获取页面元素，DOM结构变化时也能重新获取到。</li>
</ul>
</li>
</ul>
</li>
<li><code>page.get_by_role()</code><ul>
<li>优先考虑通过显式和隐式可访问性属性进行定位具有可访问性特征的元素。<ul>
<li>显式可访问性属性，指开发人员明确地为元素设置的属性，具有描述元素及其功能的可访问性信息。</li>
<li>隐式可访问性属性，根据元素的其他属性和内容推断可访问性信息，而非特定设置为可访问性属性。</li>
</ul>
</li>
<li>可以考虑将鼠标悬停在定位器指向的元素上，再点击定位器所指向的元素，底层DOM元素将被定位两次。</li>
<li>创建定位器的方法也可用于Locator类和FrameLocator类，支持将其链接起来并迭代地缩小定位器的范围。<ul>
<li>Locator类定位页面上的元素，<code>page.locator()</code>、 <code>ElementHandle.locator()</code>、<code>locator.nth()</code>。</li>
<li>FrameLocator类定位页面上的框架(iframe)，方法有<code>page.frame_locator()</code>、 <code>locator.frame()</code>。</li>
</ul>
</li>
<li>考虑DOM结构，也可以通过隐含角色定位元素。<ul>
<li>角色定位器包括按钮、复选框、标题、链接、列表、表格等。</li>
<li>且定位遵循ARIA角色、ARIA属性和可访问名称的W3C规范。</li>
</ul>
</li>
</ul>
</li>
<li><code>page.get_by_text()</code>：文本内容定位，非交互式元素如div、span、p等。</li>
<li><code>page.get_by_title()</code>：通过标题title的属性定位元素。</li>
<li><code>page.get_by_label()</code>：通过关联标签的文本定位元素。</li>
<li><code>page.get_by_test_id()</code>：依据data-testid属性定位元素。</li>
<li><code>page.get_by_alt_text()</code>：依据替代文本来进行图像定位，例如img、area元素。</li>
<li><code>page.get_by_placeholder()</code>：定位无标签但具有占位符文本的表单元素时使用。</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>, slow_mo=<span class="hljs-number">100</span>)<br>    page = browser.new_page()                                   <span class="hljs-comment"># 打开标签页</span><br>    page.goto(<span class="hljs-string">&quot;https://www.baidu.com/&quot;</span>)<br><br>    lacate = page.locator(<span class="hljs-string">&#x27;#s-top-left&gt;a&#x27;</span>)<br>    lacate.first.click()                                        <span class="hljs-comment"># 点击第一个</span><br>    lacate.last.click()                                         <span class="hljs-comment"># 点击最后一个</span><br>    lacate.nth(<span class="hljs-number">2</span>).click()                                       <span class="hljs-comment"># 索引第三个元素</span><br>    <span class="hljs-built_in">print</span>(lacate.count())                                       <span class="hljs-comment"># 统计元素的个数</span><br>    page.wait_for_timeout(<span class="hljs-number">3000</span>)<br><br>    loc1 = page.locator(<span class="hljs-string">&quot;id=kw&quot;</span>)<br>    <span class="hljs-built_in">print</span>(loc1)<br>    <span class="hljs-built_in">print</span>(loc1.count())                                         <span class="hljs-comment"># 1表示元素存在</span><br>    loc1 = page.query_selector(<span class="hljs-string">&#x27;#kw&#x27;</span>)                           <span class="hljs-comment"># ElementHandles</span><br>    <span class="hljs-built_in">print</span>(loc1)<br>    loc1 = page.query_selector_all(<span class="hljs-string">&#x27;#kw&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(loc1)                                                 <span class="hljs-comment"># 复数定位方式返回list</span><br><br>    loc2 = page.locator(<span class="hljs-string">&#x27;id=test&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(loc2)<br>    <span class="hljs-built_in">print</span>(loc2.count())                                         <span class="hljs-comment"># 0表示元素不存在</span><br>    loc2 = page.query_selector(<span class="hljs-string">&#x27;#test&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(loc2)<br>    loc2 = page.query_selector_all(<span class="hljs-string">&#x27;#test&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(loc2)<br><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h4 id="1-过滤链式定位"><a href="#1-过滤链式定位" class="headerlink" title="(1) 过滤链式定位"></a>(1) 过滤链式定位</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright, expect<br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> pw:<br>    browser = pw.chromium.launch(headless=<span class="hljs-literal">False</span>, slow_mo=<span class="hljs-number">1000</span>)<br>    page = browser.new_page()<br>    page.goto(<span class="hljs-string">&quot;https://www.baidu.com/&quot;</span>)<br><br>    page.locator(<span class="hljs-string">&#x27;//*[@id=&quot;s-top-left&quot;]/a[1]&#x27;</span>).<span class="hljs-built_in">filter</span>(has_text=<span class="hljs-string">&quot;新闻&quot;</span>).click()<br>    <span class="hljs-comment"># 根据div元素定位到多个a标签，继续缩小范围，按文本过滤</span><br>    page.locator(<span class="hljs-string">&#x27;#s-top-left&gt;a&#x27;</span>).<span class="hljs-built_in">filter</span>(has_text=<span class="hljs-string">&quot;新闻&quot;</span>).click()<br>    page.locator(<span class="hljs-string">&#x27;#s-top-left&gt;a&#x27;</span>, has_text=<span class="hljs-string">&quot;新闻&quot;</span>).click()<br>    page.wait_for_timeout(<span class="hljs-number">1000</span>)<br><br>    page.get_by_role(<span class="hljs-string">&quot;listitem&quot;</span>).<span class="hljs-built_in">filter</span>(has_text=re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;1&#x27;</span>)).click()<br>    expect(<br>        page.get_by_role(<span class="hljs-string">&quot;listitem&quot;</span>).<span class="hljs-built_in">filter</span>(has_text=<span class="hljs-string">&quot;1&quot;</span>)<br>    ).to_have_count(<span class="hljs-number">1</span>)                                          <span class="hljs-comment"># 断言是否能定位到元素</span><br>    page.get_by_role(<span class="hljs-string">&quot;listitem&quot;</span>).<span class="hljs-built_in">filter</span>(has_text=<span class="hljs-string">&quot;1&quot;</span>).click()   <span class="hljs-comment"># 对于ul-li元素</span><br>    page.wait_for_timeout(<span class="hljs-number">1000</span>)                                 <span class="hljs-comment"># 可用listitem角色定位方式</span><br><br>    locate = page.get_by_role(<span class="hljs-string">&quot;listitem&quot;</span>).<span class="hljs-built_in">filter</span>(has_text=<span class="hljs-string">&quot;1&quot;</span>)<br>    locate.click()                                              <span class="hljs-comment"># 链式定位</span><br>    page.wait_for_timeout(<span class="hljs-number">1000</span>)<br><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h4 id="2-get-by-role"><a href="#2-get-by-role" class="headerlink" title="(2) get_by_role()"></a>(2) get_by_role()</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs Html"><span class="hljs-comment">&lt;!-- get_by_role.html --&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>get_by_role<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">myFunction</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">var</span> x;</span><br><span class="language-javascript">            <span class="hljs-keyword">var</span> person = <span class="hljs-title function_">prompt</span>(<span class="hljs-string">&quot;请输入你的名字：&quot;</span>, <span class="hljs-string">&quot;&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (person != <span class="hljs-literal">null</span> &amp;&amp; person != <span class="hljs-string">&quot;&quot;</span>) &#123;</span><br><span class="language-javascript">                x = <span class="hljs-string">&quot;你好，&quot;</span> + person + <span class="hljs-string">&quot;！今天感觉如何？&quot;</span>;</span><br><span class="language-javascript">                <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;demo&quot;</span>).<span class="hljs-property">innerHTML</span> = x;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;text-align: center;&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>点击按钮查看输入的对话框。<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;myFunction()&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width: 195px; height: 40px;&quot;</span>&gt;</span>点我<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;demo&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- page.get_by_role(&quot;button&quot;, name=&quot;点我&quot;).click() --&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- # 两次定位之间发生了DOM的重新渲染，定位器将使用最新匹配元素，可避免使用过时的元素 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- locator = page.get_by_role(&quot;button&quot;, name=&quot;点我&quot;) --&gt;</span><br>    <span class="hljs-comment">&lt;!-- # hover悬停在定位器指向的元素上，click点击定位器所指向的元素 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- locator.hover() --&gt;</span><br>    <span class="hljs-comment">&lt;!-- locator.click() --&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- locator = page.locator(&quot;body&quot;).get_by_role(&quot;button&quot;, name=&quot;点我&quot;) --&gt;</span><br>    <span class="hljs-comment">&lt;!-- locator.click() --&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>登录<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> /&gt;</span>用户<br>        <span class="hljs-comment">&lt;!-- &lt;input type=&quot;checkbox&quot; /&gt;游客 --&gt;</span><span class="hljs-comment">&lt;!-- 若多个input写一起，则只返回第一个 --&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> /&gt;</span>游客<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>提交<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- # 验证页面是否正确page.check(&#x27;input[name=&quot;游客&quot;]&#x27;)显示&quot;登录&quot;标题的断言语句 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- expect(page.get_by_role(&quot;heading&quot;, name=&quot;登录&quot;)).to_be_visible() --&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- # 模拟选择订阅选项（只返回匹配的第一个元素） --&gt;</span><br>    <span class="hljs-comment">&lt;!-- page.get_by_role(&quot;checkbox&quot;, name=&quot;游客&quot;).check() --&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- # 模拟点击提交按钮，结合正则表达式定位角色为button且名称包含&quot;提交&quot;的元素，然后点击该按钮 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- page.get_by_role(&quot;button&quot;, name=re.compile(&quot;提交&quot;, re.IGNORECASE)).click() --&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>



<h4 id="3-get-by-text"><a href="#3-get-by-text" class="headerlink" title="(3) get_by_text()"></a>(3) get_by_text()</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs Html"><span class="hljs-comment">&lt;!-- get_by_text.html --&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>get_by_text<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;text-align: center;&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>欢迎访问，张三！<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>This is a <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;color: blue;&quot;</span>&gt;</span>blue<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span> text.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- # 通过字符串匹配 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- expect(page.get_by_text(&quot;欢迎访问，张三！&quot;)).to_be_visible() --&gt;</span><br>    <br>    <span class="hljs-comment">&lt;!-- # 精确匹配 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- expect(page.get_by_text(&quot;欢迎访问，张三！&quot;, exact=True)).to_be_visible() --&gt;</span><br>    <br>    <span class="hljs-comment">&lt;!-- # 正则表达式匹配 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- expect(page.get_by_text(re.compile(&quot;欢迎访问，张三！&quot;, re.IGNORECASE))).to_be_visible() --&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>



<h4 id="4-get-by-title"><a href="#4-get-by-title" class="headerlink" title="(4) get_by_title()"></a>(4) get_by_title()</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs Html"><span class="hljs-comment">&lt;!-- get_by_title.html --&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>get_by_title<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;text-align: center;&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>欢迎访问，张三！<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;话题数&quot;</span>&gt;</span>27个话题<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- # 找到具有匹配title属性的元素 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- expect(page.get_by_title(&quot;话题数&quot;)).to_have_text(&quot;27个话题&quot;) --&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>



<h4 id="5-get-by-label"><a href="#5-get-by-label" class="headerlink" title="(5) get_by_label()"></a>(5) get_by_label()</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs Html"><span class="hljs-comment">&lt;!-- get_by_label.html --&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>get_by_label<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;text-align: center;&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>登录<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>用户 <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;username&quot;</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>密码 <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>    <br>    <span class="hljs-comment">&lt;!-- # 通过标签文本定位后填写输入 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- page.get_by_label(&quot;用户&quot;).fill(&quot;zhangs&quot;) --&gt;</span><br>    <span class="hljs-comment">&lt;!-- page.get_by_label(&quot;密码&quot;).fill(&quot;secret&quot;) --&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>



<h4 id="6-get-by-test-id"><a href="#6-get-by-test-id" class="headerlink" title="(6) get_by_test_id()"></a>(6) get_by_test_id()</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs Html"><span class="hljs-comment">&lt;!-- get_by_test_id.html --&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>get_by_test_id<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><br><span class="language-css">    <span class="hljs-selector-tag">table</span> &#123;</span><br><span class="language-css">        <span class="hljs-attribute">display</span>: flex; <span class="hljs-attribute">justify-content</span>: center;</span><br><span class="language-css">        <span class="hljs-attribute">align-items</span>: center; <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;</span><br><span class="language-css">    &#125;</span><br><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;text-align: center;&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">data-testid</span>=<span class="hljs-string">&quot;test_id&quot;</span>&gt;</span>行程表<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>    <br>    <span class="hljs-comment">&lt;!-- # 通过测试ID找到该元素 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- page.get_by_test_id(&quot;test_id&quot;).click() --&gt;</span><br>    <br>    <span class="hljs-tag">&lt;<span class="hljs-name">table</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>时间<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span><span class="hljs-symbol">&amp;emsp;</span>行程<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>04：00<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span><span class="hljs-symbol">&amp;emsp;</span>爬山看日出<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>17：30<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span><span class="hljs-symbol">&amp;emsp;</span>海滩边烧烤<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>



<h4 id="7-get-by-alt-text"><a href="#7-get-by-alt-text" class="headerlink" title="(7) get_by_alt_text()"></a>(7) get_by_alt_text()</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs Html"><span class="hljs-comment">&lt;!-- get_by_alt_text.html --&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>get_by_alt_text<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;text-align: center;&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>图片<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;http://mtw.so/5NabrQ&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;baidu_logo&quot;</span>&gt;</span><br>    <br>    <span class="hljs-comment">&lt;!-- # 通过文本选项找到图像后单击 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- page.get_by_alt_text(&quot;baidu_logo&quot;).click() --&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>



<h4 id="8-get-by-placeholder"><a href="#8-get-by-placeholder" class="headerlink" title="(8) get_by_placeholder()"></a>(8) get_by_placeholder()</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs Html"><span class="hljs-comment">&lt;!-- get_by_placeholder.html --&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>get_by_placeholder<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;text-align: center;&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>邮箱<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;email&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;name@example.com&quot;</span> <span class="hljs-attr">required</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- # 通过占位符文本定位后填充输入 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- page.get_by_placeholder(&quot;name@example.com&quot;).fill(&quot;playwright@microsoft.com&quot;) --&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>



<h2 id="2-3-输入文字"><a href="#2-3-输入文字" class="headerlink" title="2-3 输入文字"></a>2-3 输入文字</h2><ul>
<li>输入文字<ul>
<li><code>locator.fill()</code>是填写表单字段的最简单方法，适用于<code>&lt;input&gt;</code>、<code>&lt;textarea&gt;</code>、<code>[contenteditable]</code>。</li>
<li>大多时候，<code>locator.fill()</code>会正常工作，如果页面上有特殊的键盘处理，只需要使用<code>locator.type()</code>。</li>
</ul>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs Html"><span class="hljs-comment">&lt;!-- input_text.html --&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>input_text<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;text-align: center;&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>输入文本<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;dateInput&quot;</span>&gt;</span>日<span class="hljs-symbol">&amp;emsp;</span><span class="hljs-symbol">&amp;emsp;</span>期<span class="hljs-symbol">&amp;emsp;</span><span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;date&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dateInput&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;dateInput&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width: 180px;&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;timeInput&quot;</span>&gt;</span>时<span class="hljs-symbol">&amp;emsp;</span><span class="hljs-symbol">&amp;emsp;</span>间<span class="hljs-symbol">&amp;emsp;</span><span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;time&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;timeInput&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;timeInput&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width: 180px;&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;datetimeInput&quot;</span>&gt;</span>日期时间<span class="hljs-symbol">&amp;emsp;</span><span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;datetime-local&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;datetimeInput&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;datetimeInput&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width: 180px;&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>固定文本<span class="hljs-symbol">&amp;emsp;</span><span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;textbox&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width: 180px;&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;textareaElement&quot;</span>&gt;</span>伸缩文本<span class="hljs-symbol">&amp;emsp;</span><span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;textareaElement&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;textareaElement&quot;</span> <span class="hljs-attr">rows</span>=<span class="hljs-string">&quot;3&quot;</span> <span class="hljs-attr">cols</span>=<span class="hljs-string">&quot;26&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;contenteditableElement&quot;</span>&gt;</span>可编辑元素<span class="hljs-symbol">&amp;emsp;</span><span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;contenteditableElement&quot;</span> <span class="hljs-attr">contenteditable</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>



<h4 id="1-同步输入"><a href="#1-同步输入" class="headerlink" title="(1) 同步输入"></a>(1) 同步输入</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>, slow_mo=<span class="hljs-number">1000</span>)   <span class="hljs-comment"># 启动chromium浏览器</span><br>    page = browser.new_page()                                   <span class="hljs-comment"># 打开一个标签页</span><br>    page.goto(<span class="hljs-string">r&#x27;.../input_text.html&#x27;</span>)                           <span class="hljs-comment"># input_text.html文件路径</span><br>    <span class="hljs-built_in">print</span>(page.title())                                         <span class="hljs-comment"># 打印当前页面title</span><br><br>    page.fill(<span class="hljs-string">&quot;#dateInput&quot;</span>, <span class="hljs-string">&quot;2023-02-03&quot;</span>)<br>    page.fill(<span class="hljs-string">&quot;#timeInput&quot;</span>, <span class="hljs-string">&quot;21:21&quot;</span>)<br>    page.fill(<span class="hljs-string">&quot;#datetimeInput&quot;</span>, <span class="hljs-string">&quot;2023-02-03T21:21&quot;</span>)<br>    page.fill(<span class="hljs-string">&quot;input[type=&#x27;textbox&#x27;]&quot;</span>, <span class="hljs-string">&quot;固定文本输入内容&quot;</span>)<br>    page.fill(<span class="hljs-string">&quot;#textareaElement&quot;</span>, <span class="hljs-string">&quot;伸缩文本输入内容&quot;</span>)<br>    page.<span class="hljs-built_in">type</span>(<span class="hljs-string">&quot;#contenteditableElement&quot;</span>, <span class="hljs-string">&quot;可编辑元素输入内容&quot;</span>)<br>    page.wait_for_timeout(<span class="hljs-number">3000</span>)<br><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h4 id="2-异步输入"><a href="#2-异步输入" class="headerlink" title="(2) 异步输入"></a>(2) 异步输入</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> asyncio<br><span class="hljs-keyword">from</span> playwright.async_api <span class="hljs-keyword">import</span> async_playwright<br><br><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> async_playwright() <span class="hljs-keyword">as</span> p:<br>        browser = <span class="hljs-keyword">await</span> p.chromium.launch(headless=<span class="hljs-literal">False</span>)<br>        page = <span class="hljs-keyword">await</span> browser.new_page()                         <span class="hljs-comment"># 打开一个标签页</span><br>        <span class="hljs-keyword">await</span> page.goto(<span class="hljs-string">r&#x27;.../input_text.html&#x27;</span>)                 <span class="hljs-comment"># input_text.html文件路径</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-keyword">await</span> page.title())                               <span class="hljs-comment"># 打印当前页面title</span><br>        <span class="hljs-keyword">await</span> page.wait_for_timeout(<span class="hljs-number">3000</span>)<br><br>        <span class="hljs-keyword">await</span> page.fill(<span class="hljs-string">&quot;#dateInput&quot;</span>, <span class="hljs-string">&quot;2023-02-03&quot;</span>)<br>        <span class="hljs-keyword">await</span> page.fill(<span class="hljs-string">&quot;#timeInput&quot;</span>, <span class="hljs-string">&quot;21:21&quot;</span>)<br>        <span class="hljs-keyword">await</span> page.fill(<span class="hljs-string">&quot;#datetimeInput&quot;</span>, <span class="hljs-string">&quot;2023-02-03T21:21&quot;</span>)<br>        <span class="hljs-keyword">await</span> page.fill(<span class="hljs-string">&quot;input[type=&#x27;textbox&#x27;]&quot;</span>, <span class="hljs-string">&quot;固定文本输入内容&quot;</span>)<br>        <span class="hljs-keyword">await</span> page.fill(<span class="hljs-string">&quot;#textareaElement&quot;</span>, <span class="hljs-string">&quot;伸缩文本输入内容&quot;</span>)<br>        <span class="hljs-keyword">await</span> page.<span class="hljs-built_in">type</span>(<span class="hljs-string">&quot;#contenteditableElement&quot;</span>, <span class="hljs-string">&quot;可编辑元素输入内容&quot;</span>)<br>        <span class="hljs-keyword">await</span> page.wait_for_timeout(<span class="hljs-number">3000</span>)<br><br>        <span class="hljs-keyword">await</span> browser.close()                                   <span class="hljs-comment"># 关闭浏览器对象</span><br><br>asyncio.run(main())<br></code></pre></td></tr></table></figure>



<h2 id="2-4-鼠标点击"><a href="#2-4-鼠标点击" class="headerlink" title="2-4 鼠标点击*"></a>2-4 鼠标点击*</h2><ul>
<li>鼠标点击<ul>
<li><code>locator.click()</code>(单击)、<code>locator.dbclick()</code>(双击)、<code>locator.click(button=&quot;right&quot;)</code>(右击)。</li>
<li><code>locator.click(modifiers=[&quot;Shift&quot;])</code>(Shift+鼠标左键单击操作)、<code>locator.hover()</code>(鼠标悬停)。</li>
<li><code>locator.click(position=&#123; &quot;x&quot;: 0, &quot;y&quot;: 0&#125;)</code>(模拟在指定坐标位置处，进行鼠标左键点击的操作)。</li>
<li>相比Selenium，不用自定义轮询等待，不用判断元素是否隐藏，元素在视图中也不需要手动设置滚动。</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright                 <span class="hljs-comment"># sync同步运行</span><br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>)                 <span class="hljs-comment"># 启动chromium浏览器</span><br>    page = browser.new_page()                                   <span class="hljs-comment"># 打开一个标签页</span><br>    page.goto(<span class="hljs-string">&#x27;https://www.baidu.com&#x27;</span>)                          <span class="hljs-comment"># 打开百度地址</span><br>    <span class="hljs-built_in">print</span>(page.title())                                         <span class="hljs-comment"># 打印当前页面title</span><br>    page.get_by_text(<span class="hljs-string">&quot;换一换&quot;</span>).click()<br>    page.wait_for_timeout(<span class="hljs-number">1000</span>)                                 <span class="hljs-comment"># 单击</span><br>    page.get_by_text(<span class="hljs-string">&quot;换一换&quot;</span>).dblclick()<br>    page.wait_for_timeout(<span class="hljs-number">1000</span>)                                 <span class="hljs-comment"># 双击</span><br>    page.get_by_text(<span class="hljs-string">&quot;换一换&quot;</span>).click(button=<span class="hljs-string">&quot;right&quot;</span>)<br>    page.wait_for_timeout(<span class="hljs-number">1000</span>)                                 <span class="hljs-comment"># 右击</span><br><br>    page.locator(<span class="hljs-string">&#x27;//*[@id=&quot;s-top-left&quot;]/div/a&#x27;</span>).hover()         <span class="hljs-comment"># 鼠标悬停在“更多”上</span><br>    page.wait_for_timeout(<span class="hljs-number">1000</span>)<br>    element = page.wait_for_selector(<span class="hljs-string">&#x27;//*[@id=&quot;s-usersetting-top&quot;]&#x27;</span>)<br>    bounding_box = element.bounding_box()                       <span class="hljs-comment"># 获取元素的边界框信息</span><br>    x = bounding_box[<span class="hljs-string">&#x27;x&#x27;</span>] + bounding_box[<span class="hljs-string">&#x27;width&#x27;</span>] // <span class="hljs-number">2</span>          <span class="hljs-comment"># 计算鼠标点击的x和y坐标</span><br>    y = bounding_box[<span class="hljs-string">&#x27;y&#x27;</span>] + bounding_box[<span class="hljs-string">&#x27;height&#x27;</span>] // <span class="hljs-number">2</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;x坐标：&quot;</span>, x, <span class="hljs-string">&quot;\ny坐标：&quot;</span>, y)<br>    <span class="hljs-comment"># element.click(position=&#123;&quot;x&quot;: x, &quot;y&quot;: y&#125;)                  # 鼠标点击元素的指定位置，报错</span><br>    page.wait_for_timeout(<span class="hljs-number">1000</span>)<br>    page.click(<span class="hljs-string">&#x27;text=更多&#x27;</span>, modifiers=[<span class="hljs-string">&quot;Shift&quot;</span>])<br>    page.wait_for_timeout(<span class="hljs-number">3000</span>)                                 <span class="hljs-comment"># Shift+鼠标左键单击</span><br><br>    <span class="hljs-comment"># 【滚动到元素位置】以下操作没进行页面切换，需用户手动切换才能看到效果(点击百度更多跳到新标签页了)</span><br>    page.goto(<span class="hljs-string">&quot;https://www.runoob.com/&quot;</span>)<br>    page.get_by_text(<span class="hljs-string">&#x27;【学习 W3C】&#x27;</span>).click()<br>    page.wait_for_timeout(<span class="hljs-number">5000</span>)                                 <span class="hljs-comment"># click()点击时自动滚动</span><br>    page.goto(<span class="hljs-string">&quot;https://www.runoob.com/&quot;</span>)<br>    page.get_by_text(<span class="hljs-string">&#x27;【学习 Docker】&#x27;</span>).scroll_into_view_if_needed()<br>    page.wait_for_timeout(<span class="hljs-number">5000</span>)                                 <span class="hljs-comment"># 滚动元素到屏幕可视窗口</span><br>    page.goto(<span class="hljs-string">&quot;https://www.runoob.com/&quot;</span>)<br>    page.get_by_text(<span class="hljs-string">&#x27;【学习 JavaScript】&#x27;</span>).hover()<br>    page.wait_for_timeout(<span class="hljs-number">5000</span>)                                 <span class="hljs-comment"># hover()方法将鼠标放到元素上</span><br><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h2 id="2-5-拖放操作"><a href="#2-5-拖放操作" class="headerlink" title="2-5 拖放操作"></a>2-5 拖放操作</h2><ul>
<li>拖放操作<ul>
<li>使用<code>locator.drag_to()</code>执行拖放操作，需要进行如下步骤。<ul>
<li>将鼠标悬停在要拖动的元素上，按住鼠标左键不放。</li>
<li>将鼠标移动到将接收放置的元素上，松开鼠标左键。</li>
</ul>
</li>
<li>如果想要精确地控制拖放操作，需使用如下较低级别的方法。<ul>
<li><code>page.locator(selector).hover()</code>：悬停在页面元素上。</li>
<li><code>page.mouse.down()</code>按下鼠标，<code>button=&quot;middle&quot;</code>按住鼠标的中间位置，<code>page.mouse.up()</code>释放鼠标。</li>
<li><code>page.mouse.move()</code>把鼠标放到指定的x和y坐标位置(即绝对坐标位置，selenium使用相对偏移位置)。</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>, slow_mo=<span class="hljs-number">1000</span>)   <span class="hljs-comment"># 启动chromium浏览器</span><br>    page = browser.new_page()                                   <span class="hljs-comment"># 打开一个标签页</span><br>    page.goto(<span class="hljs-string">&#x27;https://www.baidu.com/&#x27;</span>)                         <span class="hljs-comment"># 打开百度首页</span><br>    <span class="hljs-built_in">print</span>(page.title())                                         <span class="hljs-comment"># 打印当前页面title</span><br><br>    <span class="hljs-comment"># page.locator(&quot;#u1 &gt; div.ai-entry-right.ai-entry-right-nologin &gt; img&quot;).drag_to(</span><br>    <span class="hljs-comment">#     page.locator(&quot;#kw&quot;)</span><br>    <span class="hljs-comment"># )</span><br>    page.locator(<span class="hljs-string">&#x27;//*[@id=&quot;s-hotsearch-wrapper&quot;]/div/a[1]/div/i[1]&#x27;</span>).hover()<br>    page.mouse.down()                                           <span class="hljs-comment"># 按下鼠标</span><br>    <span class="hljs-comment"># page.mouse.down(button=&quot;middle&quot;)</span><br>    page.locator(<span class="hljs-string">&quot;#kw&quot;</span>).hover()<br>    page.mouse.up()                                             <span class="hljs-comment"># 释放鼠标</span><br>    page.wait_for_timeout(<span class="hljs-number">3000</span>)<br><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h2 id="2-6-iframe定位"><a href="#2-6-iframe定位" class="headerlink" title="2-6 iframe定位"></a>2-6 iframe定位</h2><ul>
<li>iframe定位<ul>
<li>iframe即一个html嵌套了另一个html，最简单的识别方法就是看定位元素外层有没iframe标签名。</li>
<li>frame与iframe都用于表示页面框架，iframe特指嵌入式框架，而frame可以表示主框架或子框架。<ul>
<li><code>page.main_frame</code>：获取page对象本身的frame对象。</li>
<li><code>frame.child_frames</code>：获取frame下的子frame对象。</li>
<li><code>page.frames</code>：获取page对象全部iframes，包含page本身的frame对象。</li>
</ul>
</li>
<li><code>page.frame_locator(selector)</code>：仅查找页面中，第一个匹配的frame对象。<ul>
<li><code>frame_locator().first</code>：定位多个时，匹配第一个。</li>
<li><code>frame_locator().last</code>：定位多个时，返回最后一个。</li>
<li><code>frame_locator().nth(index)</code>：定位多个时进行索引。</li>
</ul>
</li>
<li><code>page.locator(selector).frame_locator(selector)</code>：允许在指定frame内查找元素，可操作多个frame。</li>
<li><code>page.frame(name, url)</code>：通过page对象直接定位iframe对象，传入name参数或传入url参数，说明如下。<ul>
<li>name属性不能模糊匹配，只能精确匹配字符串。</li>
<li>iframe没有name属性时，可以使用id属性来定位。</li>
<li>url属性值，即页面上看到的src属性，支持模糊匹配。</li>
<li>iframe上的动态id非固定，可使用css的正则匹配元素属性，也可使用xpath的contains包含元素属性。<ul>
<li><code>$(&#39;[name^=&quot;value&quot;]&#39;)</code>：匹配name以value开头的元素。</li>
<li><code>$(&#39;[name$=&quot;value&quot;]&#39;)</code>：匹配name以value结尾的元素。</li>
<li><code>$(&#39;[class*=&quot;value&quot;]&#39;)</code>：匹配class属性包含value的元素。</li>
</ul>
</li>
<li><code>page.frame()</code>：返回的对象能直接使用<code>fill()</code>和<code>click</code>方法。</li>
<li><code>page.frame_locator(selector)</code>：返回的对象只能用<code>locator()</code>方法定位元素，然后<code>click()</code>等操作。</li>
</ul>
</li>
<li><code>page.query_selector(selector).content_frame()</code>：通过query_selector定位元素，再切换到iframe对象上。</li>
<li>多层iframe需一层一层定位，若需要在iframe上执行js代码，必须使用<code>page.frame()</code>方法定位到iframe对象。</li>
<li>才有<code>iframe.evaluate(js)</code>方法执行js，而<code>page.frame_locator()</code>方法只能定位操作元素，没有执行js的方法。</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dump_frame_tree</span>(<span class="hljs-params">frame, indent</span>):                             <span class="hljs-comment"># 打印浏览器中的帧树结构</span><br>    <span class="hljs-built_in">print</span>(indent + frame.name + <span class="hljs-string">&#x27;@&#x27;</span> + frame.url)                <span class="hljs-comment"># 打印当前帧的名称和URL</span><br>    <span class="hljs-keyword">for</span> child <span class="hljs-keyword">in</span> frame.child_frames:                            <span class="hljs-comment"># indent用来确定缩进级别</span><br>        dump_frame_tree(child, indent + <span class="hljs-string">&quot;    &quot;</span>)<br><br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>, slow_mo=<span class="hljs-number">1000</span>)   <span class="hljs-comment"># 启动chromium浏览器</span><br>    page = browser.new_page()                                   <span class="hljs-comment"># 打开一个标签页</span><br>    page.goto(<span class="hljs-string">&quot;https://account.cnblogs.com/signin&quot;</span>)<br><br>    dump_frame_tree(page.main_frame, <span class="hljs-string">&quot;&quot;</span>)                        <span class="hljs-comment"># 看层级结构，这里有三层</span><br>    <span class="hljs-built_in">print</span>(page.main_frame)                                      <span class="hljs-comment"># 获取page对象本身的frame对象</span><br>    <span class="hljs-built_in">print</span>(page.frames)                                          <span class="hljs-comment"># 获取page对象全部的frames</span><br>    <span class="hljs-built_in">print</span>(page.main_frame.child_frames)                         <span class="hljs-comment"># 获取page对象的子frame对象</span><br><br>    page.goto(<span class="hljs-string">&quot;https://mail.163.com/&quot;</span>)<br>    <span class="hljs-built_in">print</span>(page.frames)<br>    <span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> page.frames:<br>        <span class="hljs-built_in">print</span>(f)                                                <span class="hljs-comment"># 获取全部的iframes</span><br>        <span class="hljs-built_in">print</span>(f.name)<br>        <span class="hljs-built_in">print</span>(f.url)<br>    page.wait_for_timeout(<span class="hljs-number">3000</span>)<br><br>    <span class="hljs-comment"># iframe = page.frame_locator(&quot;iframe[id^=x-URS-iframe]&quot;)</span><br>    iframe = page.frame_locator(<span class="hljs-string">&#x27;//iframe[contains(@id, &quot;x-URS-iframe&quot;)]&#x27;</span>)<br>    iframe.locator(<span class="hljs-string">&#x27;[name=&quot;email&quot;]&#x27;</span>).fill(<span class="hljs-string">&#x27;Tester&#x27;</span>)             <span class="hljs-comment"># xpath模糊匹配</span><br>    iframe.locator(<span class="hljs-string">&#x27;[name=&quot;password&quot;]&#x27;</span>).fill(<span class="hljs-string">&quot;123456&quot;</span>)<br>    iframe.locator(<span class="hljs-string">&#x27;#dologin&#x27;</span>).click()<br>    page.wait_for_timeout(<span class="hljs-number">3000</span>)<br><br>    <span class="hljs-built_in">print</span>(iframe.first)                                         <span class="hljs-comment"># 匹配第一个</span><br>    <span class="hljs-built_in">print</span>(iframe.last)                                          <span class="hljs-comment"># 返回最后一个</span><br>    <span class="hljs-built_in">print</span>(iframe.nth(<span class="hljs-number">1</span>))                                        <span class="hljs-comment"># 索引第二个</span><br><br>    page.goto(<span class="hljs-string">&quot;https://mail.qq.com/&quot;</span>)<br>    frame = page.frame(name=<span class="hljs-string">&quot;ptlogin_iframe&quot;</span>)                   <span class="hljs-comment"># 返回的对象能直接fill()或click()</span><br>    frame.click(<span class="hljs-string">&#x27;#switcher_plogin&#x27;</span>)<br>    frame.fill(<span class="hljs-string">&#x27;#u&#x27;</span>, <span class="hljs-string">&#x27;Tester&#x27;</span>)<br>    frame.fill(<span class="hljs-string">&#x27;#p&#x27;</span>, <span class="hljs-string">&#x27;12345&#x27;</span>)<br>    frame.click(<span class="hljs-string">&#x27;#login_button&#x27;</span>)<br>    page.wait_for_timeout(<span class="hljs-number">3000</span>)<br><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h2 id="2-7-下拉框选择"><a href="#2-7-下拉框选择" class="headerlink" title="2-7 下拉框选择"></a>2-7 下拉框选择</h2><ul>
<li>下拉框选择<ul>
<li>使用<code>locator.select_option()</code>选择元素中的一个选项或者多个选项，可以指定value或label来选择。</li>
<li>先定位select元素再定位选项(根据选项名称、index索引、label标签定位)、通过page对象直接调用。</li>
</ul>
</li>
</ul>
<h4 id="1-select-option-py"><a href="#1-select-option-py" class="headerlink" title="(1) select_option.py"></a>(1) select_option.py</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>, slow_mo=<span class="hljs-number">1000</span>)   <span class="hljs-comment"># 启动chromium浏览器</span><br>    page = browser.new_page()                                   <span class="hljs-comment"># 打开一个标签页</span><br>    page.goto(<span class="hljs-string">r&quot;.../select_option.html&quot;</span>)                        <span class="hljs-comment"># select_option.html文件路径</span><br>    <span class="hljs-built_in">print</span>(page.title())<br><br>    page.locator(<span class="hljs-string">&quot;#sid&quot;</span>).select_option(<span class="hljs-string">&#x27;百度&#x27;</span>)<br>    page.wait_for_timeout(<span class="hljs-number">3000</span>)                                 <span class="hljs-comment"># 根据选项名称定位</span><br>    page.locator(<span class="hljs-string">&quot;#sid&quot;</span>).select_option(label=<span class="hljs-string">&#x27;搜狗&#x27;</span>)<br>    page.wait_for_timeout(<span class="hljs-number">1000</span>)                                 <span class="hljs-comment"># 根据label标签定位</span><br>    page.select_option(<span class="hljs-string">&quot;select#city&quot;</span>, <span class="hljs-string">&quot;厦门&quot;</span>)<br>    page.wait_for_timeout(<span class="hljs-number">1000</span>)                                 <span class="hljs-comment"># 通过page对象直接调用</span><br>    page.locator(<span class="hljs-string">&quot;#color&quot;</span>).select_option(value=[<span class="hljs-string">&#x27;3&#x27;</span>, <span class="hljs-string">&#x27;5&#x27;</span>, <span class="hljs-string">&#x27;7&#x27;</span>])<br>    page.wait_for_timeout(<span class="hljs-number">3000</span>)                                 <span class="hljs-comment"># 根据value标签定位</span><br><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h4 id="2-select-option-html"><a href="#2-select-option-html" class="headerlink" title="(2) select_option.html"></a>(2) select_option.html</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br></pre></td><td class="code"><pre><code class="hljs Html"><span class="hljs-comment">&lt;!-- select_option.html --&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>select_option<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 搜索引擎：select单选</span></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">oc</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-title function_">alert</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-property">f1</span>.<span class="hljs-property">t1</span>.<span class="hljs-title function_">value</span>());</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-comment">// 水果拼盘、选择城市：multiple可多选</span></span><br><span class="language-javascript">        (<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            selectMultip = &#123;</span><br><span class="language-javascript">                <span class="hljs-attr">register</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">id</span>) &#123;</span><br><span class="language-javascript">                    <span class="hljs-comment">// 思路：为下拉选创建一个隐藏的子选项</span></span><br><span class="language-javascript">                    <span class="hljs-comment">// 每次单选之后将单选的值追加到隐藏的子选项中，并将子选项选中显示</span></span><br><span class="language-javascript">                    <span class="hljs-comment">// 全局查找所有标记multip的select</span></span><br><span class="language-javascript">                    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&quot;[multip]&quot;</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;</span><br><span class="language-javascript">                        <span class="hljs-title function_">render</span>(e);</span><br><span class="language-javascript">                    &#125;)</span><br><span class="language-javascript">                &#125;,</span><br><span class="language-javascript">                <span class="hljs-attr">reload</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">id, data, setData</span>) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">var</span> htm = <span class="hljs-string">&quot;&quot;</span>;</span><br><span class="language-javascript">                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; data.<span class="hljs-property">length</span>; i++) &#123;</span><br><span class="language-javascript">                        htm += <span class="hljs-string">&#x27;&lt;option value=&quot;&#x27;</span> + data[i].<span class="hljs-property">value</span> + <span class="hljs-string">&#x27;&quot;&gt;&#x27;</span> + data[i].<span class="hljs-property">text</span> + <span class="hljs-string">&#x27;&lt;/option&gt;&#x27;</span></span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript">                    <span class="hljs-keyword">var</span> e = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(id);</span><br><span class="language-javascript">                    e.<span class="hljs-property">innerHTML</span> = htm;</span><br><span class="language-javascript">                    <span class="hljs-title function_">render</span>(e);</span><br><span class="language-javascript">                    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setVal</span>(id, setData);</span><br><span class="language-javascript">                &#125;,</span><br><span class="language-javascript">                <span class="hljs-attr">setVal</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">id, str</span>) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">var</span> type = <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(str);</span><br><span class="language-javascript">                    <span class="hljs-keyword">switch</span> (type) &#123;</span><br><span class="language-javascript">                        <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;[object String]&quot;</span>:</span><br><span class="language-javascript">                            <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(id).<span class="hljs-property">val</span> = str;</span><br><span class="language-javascript">                            <span class="hljs-keyword">break</span>;</span><br><span class="language-javascript">                        <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;[object Array]&quot;</span>:</span><br><span class="language-javascript">                            <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(id).<span class="hljs-property">val</span> = str.<span class="hljs-title function_">toString</span>();</span><br><span class="language-javascript">                            <span class="hljs-keyword">break</span>;</span><br><span class="language-javascript">                        <span class="hljs-attr">default</span>:</span><br><span class="language-javascript">                            <span class="hljs-keyword">break</span>;</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript">                &#125;,</span><br><span class="language-javascript">                <span class="hljs-attr">getVal</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">id</span>) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(id).<span class="hljs-property">val</span>;</span><br><span class="language-javascript">                &#125;,</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-keyword">function</span> <span class="hljs-title function_">render</span>(<span class="hljs-params">e</span>) &#123;</span><br><span class="language-javascript">                e.<span class="hljs-property">param</span> = &#123;</span><br><span class="language-javascript">                    <span class="hljs-attr">arr</span>: [],</span><br><span class="language-javascript">                    <span class="hljs-attr">valarr</span>: [],</span><br><span class="language-javascript">                    <span class="hljs-attr">opts</span>: []</span><br><span class="language-javascript">                &#125;;</span><br><span class="language-javascript">                <span class="hljs-keyword">var</span> choosevalue = <span class="hljs-string">&quot;&quot;</span>,</span><br><span class="language-javascript">                    op;</span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; e.<span class="hljs-property">length</span>; i++) &#123;</span><br><span class="language-javascript">                    op = e.<span class="hljs-title function_">item</span>(i);</span><br><span class="language-javascript">                    e.<span class="hljs-property">param</span>.<span class="hljs-property">opts</span>.<span class="hljs-title function_">push</span>(op);</span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (op.<span class="hljs-title function_">hasAttribute</span>(<span class="hljs-string">&quot;choose&quot;</span>)) &#123;</span><br><span class="language-javascript">                        <span class="hljs-keyword">if</span> (choosevalue == <span class="hljs-string">&quot;&quot;</span>) &#123;</span><br><span class="language-javascript">                            choosevalue = op.<span class="hljs-property">value</span></span><br><span class="language-javascript">                        &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                            choosevalue += <span class="hljs-string">&quot;,&quot;</span> + op.<span class="hljs-property">value</span>;</span><br><span class="language-javascript">                        &#125;</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">                <span class="hljs-comment">// 创建一个隐藏的option标签用来存储多选的值，其中的值为一个数组</span></span><br><span class="language-javascript">                <span class="hljs-keyword">var</span> option = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&quot;option&quot;</span>);</span><br><span class="language-javascript">                option.<span class="hljs-property">hidden</span> = <span class="hljs-literal">true</span>;</span><br><span class="language-javascript">                e.<span class="hljs-title function_">appendChild</span>(option);</span><br><span class="language-javascript">                e.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">&quot;input&quot;</span>, selchange);</span><br><span class="language-javascript">                e.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;input&quot;</span>, selchange);</span><br><span class="language-javascript">                <span class="hljs-comment">// 重新定义标签基础属性的get和set方法，实现取值和赋值的功能</span></span><br><span class="language-javascript">                <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(e, <span class="hljs-string">&quot;val&quot;</span>, &#123;</span><br><span class="language-javascript">                        <span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">                            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;[hidden]&quot;</span>).<span class="hljs-property">value</span>;</span><br><span class="language-javascript">                        &#125;,</span><br><span class="language-javascript">                        <span class="hljs-attr">set</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) &#123;</span><br><span class="language-javascript">                            e.<span class="hljs-property">param</span>.<span class="hljs-property">valarr</span> = [];</span><br><span class="language-javascript">                            <span class="hljs-keyword">var</span> valrealarr = value == <span class="hljs-string">&quot;&quot;</span> ? [] : value.<span class="hljs-title function_">split</span>(<span class="hljs-string">&quot;,&quot;</span>);</span><br><span class="language-javascript">                            e.<span class="hljs-property">param</span>.<span class="hljs-property">arr</span> = [];</span><br><span class="language-javascript">                            e.<span class="hljs-property">param</span>.<span class="hljs-property">opts</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">o</span>) &#123;</span><br><span class="language-javascript">                                o.<span class="hljs-property">style</span> = <span class="hljs-string">&quot;&quot;</span>;</span><br><span class="language-javascript">                            &#125;);</span><br><span class="language-javascript">                            <span class="hljs-keyword">if</span> (valrealarr.<span class="hljs-title function_">toString</span>()) &#123;</span><br><span class="language-javascript">                                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; valrealarr.<span class="hljs-property">length</span>; i++) &#123;</span><br><span class="language-javascript">                                    e.<span class="hljs-property">param</span>.<span class="hljs-property">opts</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">o</span>) &#123;</span><br><span class="language-javascript">                                        <span class="hljs-keyword">if</span> (o.<span class="hljs-property">value</span> == valrealarr[i]) &#123;</span><br><span class="language-javascript">                                            o.<span class="hljs-property">style</span> = <span class="hljs-string">&quot;color: blue;&quot;</span>;</span><br><span class="language-javascript">                                            e.<span class="hljs-property">param</span>.<span class="hljs-property">arr</span>.<span class="hljs-title function_">push</span>(o.<span class="hljs-property">text</span>);</span><br><span class="language-javascript">                                            e.<span class="hljs-property">param</span>.<span class="hljs-property">valarr</span>.<span class="hljs-title function_">push</span>(o.<span class="hljs-property">value</span>)</span><br><span class="language-javascript">                                        &#125;</span><br><span class="language-javascript">                                    &#125;);</span><br><span class="language-javascript">                                &#125;</span><br><span class="language-javascript">                                <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>[e.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>].<span class="hljs-property">text</span> = e.<span class="hljs-property">param</span>.<span class="hljs-property">arr</span>.<span class="hljs-title function_">toString</span>();</span><br><span class="language-javascript">                                <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>[e.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>].<span class="hljs-property">value</span> = e.<span class="hljs-property">param</span>.<span class="hljs-property">valarr</span>.<span class="hljs-title function_">toString</span>();</span><br><span class="language-javascript">                                <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>[e.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>].<span class="hljs-property">selected</span> = <span class="hljs-literal">true</span>;</span><br><span class="language-javascript">                            &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                                <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>[<span class="hljs-number">0</span>].<span class="hljs-property">selected</span> = <span class="hljs-literal">true</span>;</span><br><span class="language-javascript">                            &#125;</span><br><span class="language-javascript">                        &#125;,</span><br><span class="language-javascript">                        <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span></span><br><span class="language-javascript">                    &#125;)</span><br><span class="language-javascript">                    <span class="hljs-comment">// 添加属性choose，此属性添加到option中用来指定默认值</span></span><br><span class="language-javascript">                e.<span class="hljs-property">val</span> = choosevalue;</span><br><span class="language-javascript">                <span class="hljs-comment">// 添加属性tip，此属性添加到select标签上</span></span><br><span class="language-javascript">                <span class="hljs-keyword">if</span> (e.<span class="hljs-title function_">hasAttribute</span>(<span class="hljs-string">&quot;tip&quot;</span>) &amp;&amp; !e.<span class="hljs-property">tiped</span>) &#123;</span><br><span class="language-javascript">                    e.<span class="hljs-property">tiped</span> = <span class="hljs-literal">true</span>;</span><br><span class="language-javascript">                    e.<span class="hljs-title function_">insertAdjacentHTML</span>(<span class="hljs-string">&#x27;afterend&#x27;</span>, <span class="hljs-string">&#x27;&lt;i style=&quot;color: red; \</span></span><br><span class="hljs-string"><span class="language-javascript">                                          font-size: 12px&quot;&gt;*可多选*\&lt;/i&gt;&#x27;</span>);</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-keyword">function</span> <span class="hljs-title function_">selchange</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">var</span> text = <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">selectedIndex</span>].<span class="hljs-property">text</span>;</span><br><span class="language-javascript">                <span class="hljs-keyword">var</span> value = <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">selectedIndex</span>].<span class="hljs-property">value</span>;</span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">selectedIndex</span>].<span class="hljs-property">style</span> = <span class="hljs-string">&quot;color: blue;&quot;</span>;</span><br><span class="language-javascript">                <span class="hljs-keyword">var</span> ind = <span class="hljs-variable language_">this</span>.<span class="hljs-property">param</span>.<span class="hljs-property">arr</span>.<span class="hljs-title function_">indexOf</span>(text);</span><br><span class="language-javascript">                <span class="hljs-keyword">if</span> (ind &gt; -<span class="hljs-number">1</span>) &#123;</span><br><span class="language-javascript">                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">param</span>.<span class="hljs-property">arr</span>.<span class="hljs-title function_">splice</span>(ind, <span class="hljs-number">1</span>);</span><br><span class="language-javascript">                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">param</span>.<span class="hljs-property">valarr</span>.<span class="hljs-title function_">splice</span>(ind, <span class="hljs-number">1</span>);</span><br><span class="language-javascript">                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">param</span>.<span class="hljs-property">opts</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">o</span>) &#123;</span><br><span class="language-javascript">                        <span class="hljs-keyword">if</span> (o.<span class="hljs-property">value</span> == value) &#123;</span><br><span class="language-javascript">                            o.<span class="hljs-property">style</span> = <span class="hljs-string">&quot;&quot;</span>;</span><br><span class="language-javascript">                        &#125;</span><br><span class="language-javascript">                    &#125;);</span><br><span class="language-javascript">                &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">param</span>.<span class="hljs-property">arr</span>.<span class="hljs-title function_">push</span>(text);</span><br><span class="language-javascript">                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">param</span>.<span class="hljs-property">valarr</span>.<span class="hljs-title function_">push</span>(value);</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>].<span class="hljs-property">text</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">param</span>.<span class="hljs-property">arr</span>.<span class="hljs-title function_">toString</span>();</span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>].<span class="hljs-property">value</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">param</span>.<span class="hljs-property">valarr</span>.<span class="hljs-title function_">toString</span>();</span><br><span class="language-javascript">                <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">param</span>.<span class="hljs-property">arr</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) &#123;</span><br><span class="language-javascript">                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>].<span class="hljs-property">selected</span> = <span class="hljs-literal">true</span>;</span><br><span class="language-javascript">                &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>[<span class="hljs-number">0</span>].<span class="hljs-property">selected</span> = <span class="hljs-literal">true</span>;</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;)();</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">form</span>&gt;</span><br>        搜索引擎：<br>        <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;sid&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width: 300px; height: 30px;&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span>请选择<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;o1&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;id1&quot;</span>&gt;</span>谷歌<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;o2&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;id2&quot;</span>&gt;</span>必应<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;o3&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;id3&quot;</span>&gt;</span>搜狗<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;o4&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;id4&quot;</span>&gt;</span>百度<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;o4&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;id5&quot;</span>&gt;</span>火狐<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">form</span>&gt;</span><br>        水果拼盘：<br>        <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">multip</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;fruits&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width: 300px; height: 30px;&quot;</span> <span class="hljs-attr">tip</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span>请选择<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;1&quot;</span>&gt;</span>桃子<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;2&quot;</span>&gt;</span>苹果<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;3&quot;</span>&gt;</span>香蕉<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;4&quot;</span>&gt;</span>樱桃<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;5&quot;</span>&gt;</span>草莓<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;6&quot;</span>&gt;</span>杨桃<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;7&quot;</span>&gt;</span>蜜柚<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><br>            selectMultip.register();<br>        <span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">form</span>&gt;</span><br>        选择城市：<br>        <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">multip</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;city&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width: 300px; height: 30px;&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span>请选择<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;gz&quot;</span>&gt;</span>广州<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;wh&quot;</span>&gt;</span>武汉<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;bj&quot;</span>&gt;</span>北京<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;xm&quot;</span>&gt;</span>厦门<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;hz&quot;</span>&gt;</span>杭州<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;sz&quot;</span>&gt;</span>深圳<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;sz&quot;</span>&gt;</span>苏州<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;nj&quot;</span>&gt;</span>南京<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;cq&quot;</span>&gt;</span>重庆<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">form</span>&gt;</span><br>        颜色选择：<br>        <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">multiple</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;color&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width: 300px; height: 132px;&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;1&quot;</span>&gt;</span>红色<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;2&quot;</span>&gt;</span>橙色<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;3&quot;</span>&gt;</span>黄色<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;4&quot;</span>&gt;</span>绿色<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;5&quot;</span>&gt;</span>青色<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;6&quot;</span>&gt;</span>蓝色<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;7&quot;</span>&gt;</span>紫色<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>



<h2 id="2-8-单选与复选"><a href="#2-8-单选与复选" class="headerlink" title="2-8 单选与复选"></a>2-8 单选与复选</h2><ul>
<li>单选与复选<ul>
<li><code>locator.set_checked()</code>选中和取消选中单复选框的最简单方法。</li>
<li><code>locator.check()</code>选中，<code>locator.uncheck()</code>不选。</li>
<li><code>locator.click()</code>点击，<code>locator.is_checked()</code>断言是否被选中。</li>
<li>上述方法都适用于<code>input[type=checkbox]</code>和<code>input[type=radio]</code>。</li>
</ul>
</li>
</ul>
<h4 id="1-set-checked-py"><a href="#1-set-checked-py" class="headerlink" title="(1) set_checked.py"></a>(1) set_checked.py</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>, slow_mo=<span class="hljs-number">1000</span>)   <span class="hljs-comment"># 启动chromium浏览器</span><br>    page = browser.new_page()                                   <span class="hljs-comment"># 打开一个标签页</span><br>    page.goto(<span class="hljs-string">r&quot;.../set_checked.html&quot;</span>)                          <span class="hljs-comment"># set_checked.html文件路径</span><br>    <span class="hljs-built_in">print</span>(page.title())<br><br>    page.get_by_label(<span class="hljs-string">&quot;葡萄&quot;</span>).click()<br>    page.wait_for_timeout(<span class="hljs-number">3000</span>)                                 <span class="hljs-comment"># 点击</span><br>    page.get_by_label(<span class="hljs-string">&quot;橘子&quot;</span>).check()<br>    page.wait_for_timeout(<span class="hljs-number">3000</span>)                                 <span class="hljs-comment"># 选中</span><br>    <span class="hljs-keyword">assert</span> page.get_by_label(<span class="hljs-string">&quot;汽车&quot;</span>).is_checked() <span class="hljs-keyword">is</span> <span class="hljs-literal">False</span><br>    page.wait_for_timeout(<span class="hljs-number">3000</span>)                                 <span class="hljs-comment"># 断言是否被勾选</span><br>    page.locator(<span class="hljs-string">&quot;#qc&quot;</span>).set_checked(<span class="hljs-literal">True</span>)                       <span class="hljs-comment"># 单选</span><br>    page.locator(<span class="hljs-string">&quot;#gw&quot;</span>).check()                                 <span class="hljs-comment"># 选中</span><br>    page.wait_for_timeout(<span class="hljs-number">3000</span>)<br>    page.locator(<span class="hljs-string">&quot;#gw&quot;</span>).uncheck()                               <span class="hljs-comment"># 不选</span><br>    page.wait_for_timeout(<span class="hljs-number">3000</span>)<br>    box = page.locator(<span class="hljs-string">&#x27;[type=&quot;checkbox&quot;]&#x27;</span>)<br>    <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> box.<span class="hljs-built_in">all</span>():<br>        item.check()                                            <span class="hljs-comment"># 定位全部CheckBox批量选中</span><br>    page.wait_for_timeout(<span class="hljs-number">3000</span>)<br><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h4 id="2-set-checked-html"><a href="#2-set-checked-html" class="headerlink" title="(2) set_checked.html"></a>(2) set_checked.html</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs Html"><span class="hljs-comment">&lt;!-- set_checked.html --&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>set_checked<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">fieldset</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width: 355px; height: 45px;&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">legend</span>&gt;</span>单选按钮Radio<span class="hljs-tag">&lt;/<span class="hljs-name">legend</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;fruit&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;pg&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;pg&quot;</span>&gt;</span>苹果<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;fruit&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;jz&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;jz&quot;</span>&gt;</span>橘子<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;fruit&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;xj&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;xj&quot;</span>&gt;</span>香蕉<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;fruit&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;pt&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;li&quot;</span> <span class="hljs-attr">checked</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span>葡萄<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;fruit&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;xg&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;xg&quot;</span> <span class="hljs-attr">checked</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span>西瓜<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">fieldset</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">fieldset</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width: 355px; height: 130px;&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">legend</span>&gt;</span>多选按钮Checkbox<span class="hljs-tag">&lt;/<span class="hljs-name">legend</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;汽车&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;qc&quot;</span>&gt;</span>汽车<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;购物&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;gw&quot;</span>&gt;</span>购物<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;购物&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;ms&quot;</span>&gt;</span>美食<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;旅游&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;ly&quot;</span> <span class="hljs-attr">readonly</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span>旅游<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;音乐&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;yy&quot;</span> <span class="hljs-attr">readonly</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span>音乐<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">fieldset</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>



<h2 id="2-9-聚焦给定元素"><a href="#2-9-聚焦给定元素" class="headerlink" title="2-9 聚焦给定元素"></a>2-9 聚焦给定元素</h2><ul>
<li>聚焦给定元素<ul>
<li>focus()主要用于模拟用户与网页元素的交互。</li>
<li>确保正确的元素处于活动状态，以便执行相应操作。</li>
<li>通常用于交互性测试、表单输入，或者键盘事件上。</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>, slow_mo=<span class="hljs-number">1000</span>)   <span class="hljs-comment"># 启动chromium浏览器</span><br>    page = browser.new_page()                                   <span class="hljs-comment"># 打开一个标签页</span><br>    page.goto(<span class="hljs-string">&quot;https://www.baidu.com/&quot;</span>)<br>    <span class="hljs-built_in">print</span>(page.title())<br><br>    input_element = page.locator(<span class="hljs-string">&quot;#kw&quot;</span>)<br>    input_element.focus()                                       <span class="hljs-comment"># 将焦点设置到输入框上</span><br>    input_element.<span class="hljs-built_in">type</span>(<span class="hljs-string">&#x27;Playwright&#x27;</span>)                            <span class="hljs-comment"># 模拟键盘输入</span><br>    page.wait_for_timeout(<span class="hljs-number">3000</span>)<br><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h1 id="3-等待和定时器"><a href="#3-等待和定时器" class="headerlink" title="3 等待和定时器"></a>3 等待和定时器</h1><ul>
<li>等待和定时器<ul>
<li>等待<ul>
<li><code>locator.wait_for()</code>：在延迟加载的页面中等待元素可见，可等待页面加载完成后再执行操作。</li>
<li><code>chromium.launch(headless=False, slow_mo=50)</code>：可能会增加执行时间。<ul>
<li>将减慢浏览器的执行速度，slow_mo的单位为毫秒，作用范围是全局的。</li>
<li>从启动浏览器到操作元素每个动作都会有等待间隔，方便查看操作情况。</li>
</ul>
</li>
<li><code>locator.click()</code>和<code>locator.fill()</code>：自动等待元素可见，可简化代码，但可能导致超时异常。</li>
<li><code>page.wait_for_timeout(5000)</code>：等待一定时间后再执行操作，设置时间过长可能影响执行效率。</li>
</ul>
</li>
<li>定时器：使用Python的asyncio库来创建异步定时任务。</li>
<li>timeout等待超时，默认30秒，传递0将超时时间设为无限大，指不会主动超时，会一直等待直到条件满足。<ul>
<li><code>page.set_fault_navigation_timeout</code>、<code>browser_context.set_fault_timeout()</code>。</li>
<li><code>page.set_fault_timeout()</code>、<code>browser_context.set_fault_navigation_timeout()</code>。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="3-1-等待元素"><a href="#3-1-等待元素" class="headerlink" title="3-1 等待元素"></a>3-1 等待元素</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>, slow_mo=<span class="hljs-number">1000</span>)   <span class="hljs-comment"># 启动chromium浏览器</span><br>    page = browser.new_page()                                   <span class="hljs-comment"># 打开一个标签页</span><br>    page.goto(<span class="hljs-string">&#x27;https://www.baidu.com&#x27;</span>)                          <span class="hljs-comment"># 打开百度地址</span><br><br>    page.locator(<br>        <span class="hljs-string">&#x27;//*[@id=&quot;s-hotsearch-wrapper&quot;]/div/a[1]/div&#x27;</span><br>    ).wait_for()                                                <span class="hljs-comment"># 等待元素</span><br>    page.locator(<br>        <span class="hljs-string">&#x27;//*[@id=&quot;s-hotsearch-wrapper&quot;]/div/a[1]/div&#x27;</span><br>    ).click()                                                   <span class="hljs-comment"># 自动等待元素，再点击</span><br>    page.wait_for_timeout(<span class="hljs-number">1000</span>)                                 <span class="hljs-comment"># 点击后等待1秒</span><br><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h2 id="3-2-自定义等待"><a href="#3-2-自定义等待" class="headerlink" title="3-2 自定义等待"></a>3-2 自定义等待</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>, slow_mo=<span class="hljs-number">1000</span>)   <span class="hljs-comment"># 启动chromium浏览器</span><br>    page = browser.new_page()                                   <span class="hljs-comment"># 打开一个标签页</span><br>    page.goto(<span class="hljs-string">&#x27;https://www.baidu.com&#x27;</span>)                          <span class="hljs-comment"># 打开百度地址</span><br><br>    page.fill(<span class="hljs-string">&#x27;#kw&#x27;</span>, <span class="hljs-string">&#x27;Playwright&#x27;</span>)<br>    page.click(<span class="hljs-string">&#x27;#su&#x27;</span>)<br>    page.wait_for_load_state(<span class="hljs-string">&quot;networkidle&quot;</span>)                     <span class="hljs-comment"># 自定义等待</span><br><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h2 id="3-3-定时器操作"><a href="#3-3-定时器操作" class="headerlink" title="3-3 定时器操作"></a>3-3 定时器操作</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> asyncio<br><span class="hljs-keyword">from</span> playwright.async_api <span class="hljs-keyword">import</span> async_playwright<br><br><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():                                               <span class="hljs-comment"># 指定时间间隔内访问指定的网页</span><br>    <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> async_playwright() <span class="hljs-keyword">as</span> p:<br>        browser = <span class="hljs-keyword">await</span> p.chromium.launch(headless=<span class="hljs-literal">False</span>)<br>        page = <span class="hljs-keyword">await</span> browser.new_page()<br>        url = <span class="hljs-string">&#x27;https://www.baidu.com/&#x27;</span>                          <span class="hljs-comment"># 要访问的网页URL</span><br><br>        interval_seconds = <span class="hljs-number">10</span>                                   <span class="hljs-comment"># 设置定时器的间隔时间（以秒为单位）</span><br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>                <span class="hljs-keyword">await</span> page.goto(url)                            <span class="hljs-comment"># 执行自定义操作，例如访问网页</span><br>                <span class="hljs-keyword">await</span> asyncio.sleep(interval_seconds)           <span class="hljs-comment"># 设置定时器的间隔时间</span><br><br>        <span class="hljs-keyword">except</span> KeyboardInterrupt:<br>            <span class="hljs-keyword">pass</span><br><br>        <span class="hljs-keyword">finally</span>:<br>            <span class="hljs-keyword">await</span> browser.close()                               <span class="hljs-comment"># 关闭浏览器对象</span><br><br>asyncio.run(main())                                             <span class="hljs-comment"># 运行主函数</span><br></code></pre></td></tr></table></figure>



<h2 id="3-4-timeout等待超时"><a href="#3-4-timeout等待超时" class="headerlink" title="3-4 timeout等待超时"></a>3-4 timeout等待超时</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>, slow_mo=<span class="hljs-number">1000</span>)   <span class="hljs-comment"># 启动chromium浏览器</span><br>    page = browser.new_page()                                   <span class="hljs-comment"># 打开一个标签页</span><br>    page.goto(<span class="hljs-string">&#x27;https://www.baidu.com&#x27;</span>)                          <span class="hljs-comment"># 打开百度地址</span><br><br>    page.fill(<span class="hljs-string">&#x27;#kw&#x27;</span>, <span class="hljs-string">&#x27;Playwright&#x27;</span>)<br>    page.click(<span class="hljs-string">&#x27;#su&#x27;</span>)<br>    page.set_default_timeout(<span class="hljs-number">0</span>)                                 <span class="hljs-comment"># 不会主动超时</span><br><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h1 id="4-弹窗或对话框"><a href="#4-弹窗或对话框" class="headerlink" title="4 弹窗或对话框"></a>4 弹窗或对话框</h1><ul>
<li>弹窗或对话框<ul>
<li>Playwright支持监听dialog事件，JavaScript对话框包括alert、beforeunload、confirm、prompt。<ul>
<li>侦听器必须使用<code>dialog.accept()</code>或<code>dialog.dismiss()</code>操作对话框。</li>
<li>否则页面将冻结等待对话框，并且无法进行单击、搜索等下一步操作。</li>
</ul>
</li>
<li>部分场景应用时，可能弹出一些麦克风或摄像头的权限框，通过监听alert没法捕获到。<ul>
<li>可以给浏览器配置默认允许麦克风和摄像头等权限，不让弹窗出来。</li>
<li>使用context的<code>grant_permissions()</code>方法添加麦克风或摄像头权限。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="4-1-alert-box-py"><a href="#4-1-alert-box-py" class="headerlink" title="4-1 alert_box.py"></a>4-1 alert_box.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">handle_dialog</span>(<span class="hljs-params">dialog</span>):                                      <span class="hljs-comment"># 监听后的处理</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Type: &quot;</span> + dialog.<span class="hljs-built_in">type</span>)                               <span class="hljs-comment"># 返回对话框的类型</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Mess: &quot;</span> + dialog.message)                            <span class="hljs-comment"># 获取对话框中显示的消息</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Return: &quot;</span> + dialog.default_value)                    <span class="hljs-comment"># 返回默认提示值，否则返回空字符串</span><br>    dialog.dismiss()                                            <span class="hljs-comment"># 关闭对话框</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">playwright</span>):<br>    chromium = playwright.chromium<br>    browser = chromium.launch(headless=<span class="hljs-literal">False</span>, slow_mo=<span class="hljs-number">3000</span>)<br>    page = browser.new_page()<br>    page.goto(<span class="hljs-string">r&quot;.../alert_box.html&quot;</span>)                            <span class="hljs-comment"># alert_box.html文件路径</span><br><br>    page.on(<span class="hljs-string">&quot;dialog&quot;</span>, handle_dialog)<br>    page.locator(<span class="hljs-string">&quot;body &gt; button:nth-child(5)&quot;</span>).click()<br>    page.evaluate(<span class="hljs-string">&quot;alert(&#x27;Test&#x27;)&quot;</span>)                              <span class="hljs-comment"># 没监听时，它自动会关闭</span><br>    page.wait_for_timeout(<span class="hljs-number">1000</span>)<br><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br><br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> playwright:<br>    run(playwright)<br></code></pre></td></tr></table></figure>



<h2 id="4-2-alert-box-html"><a href="#4-2-alert-box-html" class="headerlink" title="4-2 alert_box.html"></a>4-2 alert_box.html</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs Html"><span class="hljs-comment">&lt;!-- alert_box.html --&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>alert_box<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;text-align: center;&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>点击按钮查看对话框<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;myFunction()&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width: 195px; height: 40px;&quot;</span>&gt;</span>点我<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;demo&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;showAlert()&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width: 195px; height: 40px;&quot;</span>&gt;</span>Alert<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;showPrompt()&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width: 195px; height: 40px;&quot;</span>&gt;</span>Prompt<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;showConfirm()&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width: 195px; height: 40px;&quot;</span>&gt;</span>Confirm<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">myFunction</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">var</span> x;</span><br><span class="language-javascript">            <span class="hljs-keyword">var</span> person = <span class="hljs-title function_">prompt</span>(<span class="hljs-string">&quot;请输入你的名字：&quot;</span>, <span class="hljs-string">&quot;&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (person != <span class="hljs-literal">null</span> &amp;&amp; person != <span class="hljs-string">&quot;&quot;</span>) &#123;</span><br><span class="language-javascript">                x = <span class="hljs-string">&quot;你好，&quot;</span> + person + <span class="hljs-string">&quot;！今天感觉如何？&quot;</span>;</span><br><span class="language-javascript">                <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;demo&quot;</span>).<span class="hljs-property">innerHTML</span> = x;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 显示Alert弹窗</span></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">showAlert</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;这是一个Alert弹窗！&quot;</span>);</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 显示Prompt弹窗</span></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">showPrompt</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">prompt</span>(<span class="hljs-string">&quot;请输入您的姓名:&quot;</span>, <span class="hljs-string">&quot;默认值&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (result !== <span class="hljs-literal">null</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;您输入的姓名是: &quot;</span> + result);</span><br><span class="language-javascript">            &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;您取消了输入。&quot;</span>);</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 显示Confirm弹窗</span></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">showConfirm</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">confirm</span>(<span class="hljs-string">&quot;您确定要执行此操作吗？&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (result) &#123;</span><br><span class="language-javascript">                <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;您点击了确认按钮。&quot;</span>);</span><br><span class="language-javascript">            &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;您点击了取消按钮。&quot;</span>);</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>



<h2 id="4-3-浏览器添加权限"><a href="#4-3-浏览器添加权限" class="headerlink" title="4-3 浏览器添加权限"></a>4-3 浏览器添加权限</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>)                 <span class="hljs-comment"># 启动浏览器</span><br>    context = browser.new_context()                             <span class="hljs-comment"># 启动上下文</span><br>    <br>    context.grant_permissions([<span class="hljs-string">&#x27;camera&#x27;</span>, <span class="hljs-string">&#x27;microphone&#x27;</span>])         <span class="hljs-comment"># 设置允许开启权限</span><br>    page = context.new_page()                                   <span class="hljs-comment"># 打开标签页</span><br>    page.goto(<span class="hljs-string">&quot;https://www.baidu.com/&quot;</span>)<br><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h1 id="5-模拟键盘操作"><a href="#5-模拟键盘操作" class="headerlink" title="5 模拟键盘操作"></a>5 模拟键盘操作</h1><ul>
<li>模拟键盘操作<ul>
<li><code>locator.press()</code>方法：可以聚焦所选元素，并产生单个击键。</li>
<li>接受在键盘事件的keyboardEvent.key属性中发出的逻辑键名称。<ul>
<li>Backquote、Minus、Equal、Backslash、Backspace、Tab、Delete、Escape、ArrowDown、End、Enter。</li>
<li>Home、Insert、PageDown、PageUp、ArrowRight、ArrowUp、F1-F12、Digit 0-9、Key A-Z、Key a-z。</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>)                 <span class="hljs-comment"># 启动浏览器</span><br>    context = browser.new_context()                             <span class="hljs-comment"># 启动上下文</span><br>    page = context.new_page()                                   <span class="hljs-comment"># 打开标签页</span><br>    page.goto(<span class="hljs-string">&quot;https://www.baidu.com/&quot;</span>)<br><br>    page.locator(<span class="hljs-string">&#x27;//*[@id=&quot;kw&quot;]&#x27;</span>).press(<span class="hljs-string">&quot;$&quot;</span>)                    <span class="hljs-comment"># 按键$</span><br>    page.wait_for_timeout(<span class="hljs-number">1000</span>)<br>    page.locator(<span class="hljs-string">&#x27;//*[@id=&quot;kw&quot;]&#x27;</span>).press(<span class="hljs-string">&quot;Shift+A&quot;</span>)              <span class="hljs-comment"># 按键A</span><br>    page.wait_for_timeout(<span class="hljs-number">1000</span>)<br>    page.locator(<span class="hljs-string">&#x27;//*[@id=&quot;kw&quot;]&#x27;</span>).press(<span class="hljs-string">&quot;Shift+a&quot;</span>)              <span class="hljs-comment"># 按键a</span><br>    page.wait_for_timeout(<span class="hljs-number">1000</span>)<br>    page.locator(<span class="hljs-string">&#x27;//*[@id=&quot;kw&quot;]&#x27;</span>).press(<span class="hljs-string">&quot;Shift+ArrowLeft&quot;</span>)      <span class="hljs-comment"># 光标左选一位</span><br>    page.wait_for_timeout(<span class="hljs-number">1000</span>)<br>    page.locator(<span class="hljs-string">&#x27;//*[@id=&quot;kw&quot;]&#x27;</span>).press(<span class="hljs-string">&quot;Control+V&quot;</span>)            <span class="hljs-comment"># 粘贴剪切板的内容</span><br>    page.wait_for_timeout(<span class="hljs-number">1000</span>)<br>    page.locator(<span class="hljs-string">&#x27;//*[@id=&quot;su&quot;]&#x27;</span>).press(<span class="hljs-string">&quot;Enter&quot;</span>)                <span class="hljs-comment"># 回车</span><br>    page.wait_for_timeout(<span class="hljs-number">1000</span>)<br><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h1 id="6-文件上传和下载"><a href="#6-文件上传和下载" class="headerlink" title="6 文件上传和下载"></a>6 文件上传和下载</h1><ul>
<li>文件上传和下载<ul>
<li>文件上传<ul>
<li>文件上传是input输入框，并且类型是<code>type=&quot;file&quot;</code>情况时，使用<code>locator.set_input_files()</code>。</li>
<li>如果不是input输入框且必须点开文件框的情况下，使用<code>page.expect_file_chooser()</code>进行监听。</li>
<li>点击选择文件按钮时，自动触发操作，则使用<code>page.on(&quot;filechooser&quot;, )</code>监听filechooser事件。</li>
</ul>
</li>
<li>文件下载：当浏览器上下文关闭时，所有属于浏览器上下文的下载文件都会被删除。</li>
</ul>
</li>
</ul>
<h2 id="6-1-文件上传"><a href="#6-1-文件上传" class="headerlink" title="6-1 文件上传"></a>6-1 文件上传</h2><ul>
<li>文件上传<ul>
<li><code>locator.set_input_files()</code>：用于设置文件输入框的文件路径。</li>
<li>模拟向文件输入框中填充文件路径，以实现文件上传的自动化操作。</li>
<li>该方法接受一个文件路径参数，指定一个或多个文件路径进行上传。</li>
<li>操作方法<ul>
<li><code>file_chooser.page</code>：返回此文件选择器所属的页面。</li>
<li><code>file_chooser.element</code>：返回与此文件选择器关联的输入元素。</li>
<li><code>file_chooser.is_multiple()</code>：判断此文件选择器是否接受多个文件。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="1-upload-file-py"><a href="#1-upload-file-py" class="headerlink" title="(1) upload_file.py"></a>(1) upload_file.py</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>)                 <span class="hljs-comment"># 启动chromium浏览器</span><br>    page = browser.new_page()                                   <span class="hljs-comment"># 打开一个标签页</span><br>    page.goto(<span class="hljs-string">r&#x27;.../upload_file.html&#x27;</span>)                          <span class="hljs-comment"># upload_file.html文件路径</span><br>    <span class="hljs-built_in">print</span>(page.title())<br><br>    page.locator(<br>        <span class="hljs-string">&#x27;body &gt; fieldset &gt; form:nth-child(2) &gt; input[type=file]&#x27;</span><br>    ).set_input_files(<span class="hljs-string">&#x27;aaa.py&#x27;</span>)                                 <span class="hljs-comment"># 上传一个文件</span><br>    page.wait_for_timeout(<span class="hljs-number">1000</span>)<br>    page.locator(<br>        <span class="hljs-string">&#x27;body &gt; fieldset &gt; form:nth-child(3) &gt; input[type=file]&#x27;</span><br>    ).set_input_files([<span class="hljs-string">&#x27;xxx.py&#x27;</span>, <span class="hljs-string">&#x27;yyy.py&#x27;</span>, <span class="hljs-string">&#x27;zzz.py&#x27;</span>])<br>    page.wait_for_timeout(<span class="hljs-number">1000</span>)                                 <span class="hljs-comment"># 上传三个文件</span><br>    page.locator(<br>        <span class="hljs-string">&#x27;body &gt; fieldset &gt; form:nth-child(2) &gt; input[type=file]&#x27;</span><br>    ).set_input_files([])                                       <span class="hljs-comment"># 空数组清除所选文件</span><br>    page.wait_for_timeout(<span class="hljs-number">1000</span>)<br><br>    <span class="hljs-keyword">with</span> page.expect_file_chooser() <span class="hljs-keyword">as</span> fc_info:                 <span class="hljs-comment"># 监听到弹出框</span><br>        page.locator(<span class="hljs-string">&quot;body &gt; fieldset &gt; form:nth-child(2) &gt; input[type=file]&quot;</span>).click()<br>    page.pause()<br>    file_chooser = fc_info.value<br><br>    <span class="hljs-built_in">print</span>(file_chooser.page)                                    <span class="hljs-comment"># 返回此文件选择器所属的页面</span><br>    <span class="hljs-built_in">print</span>(file_chooser.element)                                 <span class="hljs-comment"># 返回与此文件选择器关联的输入元素</span><br>    <span class="hljs-built_in">print</span>(file_chooser.is_multiple())                           <span class="hljs-comment"># 判断此文件选择器是否接受多个文件</span><br><br>    file_chooser.set_files(<span class="hljs-string">r&#x27;bbb.py&#x27;</span>)                           <span class="hljs-comment"># 弹出文件框手动点击继续操作</span><br>    page.wait_for_timeout(<span class="hljs-number">1000</span>)<br><br>    page.on(<span class="hljs-string">&quot;filechooser&quot;</span>, <span class="hljs-keyword">lambda</span> file_chooser: file_chooser.set_files(<br>        <span class="hljs-string">r&#x27;ccc.py&#x27;</span><br>    ))                                                          <span class="hljs-comment"># 事件监听filechooser</span><br>    page.locator(<span class="hljs-string">&quot;body &gt; fieldset &gt; form:nth-child(2) &gt; input[type=file]&quot;</span>).click()<br>    page.wait_for_timeout(<span class="hljs-number">1000</span>)<br><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h4 id="2-upload-file-html"><a href="#2-upload-file-html" class="headerlink" title="(2) upload_file.html"></a>(2) upload_file.html</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs Html"><span class="hljs-comment">&lt;!-- upload_file.html --&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;zh-cn&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>upload_file<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;text-align: center;&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">fieldset</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">legend</span>&gt;</span>上传文件<span class="hljs-tag">&lt;/<span class="hljs-name">legend</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">form</span>&gt;</span>单个文件<br>            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;file&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;one_file&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">form</span>&gt;</span>多个文件<br>            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;file&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;more_file&quot;</span> <span class="hljs-attr">multiple</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">fieldset</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>



<h2 id="6-2-文件下载"><a href="#6-2-文件下载" class="headerlink" title="6-2 文件下载"></a>6-2 文件下载</h2><ul>
<li>文件下载<ul>
<li><code>download.cancel()</code>：取消下载。</li>
<li><code>download.delete()</code>：删除下载文件，如有必要，将等待下载完成。</li>
<li><code>download.failure()</code>：返回下载错误，如有必要，将等待下载完成。</li>
<li><code>download.path()</code>：下载成功将返回文件的路径，如有必要，将等待下载完成。</li>
<li><code>download.suggested_filename</code>：获取建议文件名，下载的文件名是随机GUID。</li>
</ul>
</li>
</ul>
<h4 id="1-download-file-py"><a href="#1-download-file-py" class="headerlink" title="(1) download_file.py"></a>(1) download_file.py</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">playwright</span>):<br>    browser = playwright.chromium.launch(headless=<span class="hljs-literal">False</span>, slow_mo=<span class="hljs-number">3000</span>)<br>    page = browser.new_page()<br>    page.goto(<span class="hljs-string">r&#x27;.../download_file.html&#x27;</span>)                        <span class="hljs-comment"># download_file.html文件路径</span><br><br>    <span class="hljs-keyword">with</span> page.expect_download() <span class="hljs-keyword">as</span> download_info:<br>        page.get_by_text(<span class="hljs-string">&quot;Pycharm下载&quot;</span>).click()<br>    download = download_info.value<br>    <span class="hljs-built_in">print</span>(download.url)                                         <span class="hljs-comment"># 获取下载的url地址</span><br>    <span class="hljs-built_in">print</span>(download.page)                                        <span class="hljs-comment"># 获取下载所属的页面</span><br>    <span class="hljs-built_in">print</span>(download.path())                                      <span class="hljs-comment"># 生成一个随机uuid值保存</span><br>    download.save_as(download.suggested_filename)               <span class="hljs-comment"># 最终用save_as保存到本地</span><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br><br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> playwright:<br>    run(playwright)<br></code></pre></td></tr></table></figure>



<h4 id="2-download-file-html"><a href="#2-download-file-html" class="headerlink" title="(2) download_file.html"></a>(2) download_file.html</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs Html"><span class="hljs-comment">&lt;!-- download_file.html --&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;zh-cn&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>download_file<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;text-align: center;&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;https://download.jetbrains.com.cn/python/pycharm-professional-2023.2.1.exe&quot;</span>&gt;</span><br>        Pycharm下载<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>



<h1 id="7-错误处理和调试"><a href="#7-错误处理和调试" class="headerlink" title="7 错误处理和调试"></a>7 错误处理和调试</h1><ul>
<li>错误处理和调试<ul>
<li>异常处理：一种常见的错误处理机制，使用try-except代码块捕获和处理可能出现的异常。</li>
<li>控制台调试定位<ul>
<li>使用<code>page.pause()</code>进入断点状态，浏览器F12开发者工具打开Console页面调试定位。</li>
<li>还可以使用Playwright Inspector工具，来开启录制，页面操作生成对应的元素和步骤。</li>
<li>Playwright Inspector可使用命令行启动，如：<code>playwright codegen http://xxx.com/</code>。</li>
<li>Playwright Inspector的Pick locator可在浏览器上选需定位的元素，生成对应的locator。</li>
<li>录制相关命令<ul>
<li><code>playwright codegen --viewport-size=800,600 http://xxx.com/</code>。</li>
<li><code>playwright codegen --lang=&quot;it-IT&quot; http://xxx.com/</code>：模拟语言。</li>
<li><code>playwright codegen --color-scheme=dark http://xxx.com/</code>：模拟配色。</li>
<li><code>playwright codegen --timezone=&quot;Europe/Rome&quot; http://xxx.com/</code>：模拟时区。</li>
<li><code>playwright codegen --geolocation=&quot;41.890221,12.492348&quot; http://xxx.com/</code>：模拟地理位置。</li>
<li><code>playwright codegen --device=&quot;iPhone 11&quot;</code>：模拟移动设备iPhone11，device值必须双引号且区分大小写。</li>
<li><code>playwright open --load-storage=auth.json</code>：打开Playwright上下文并加载存储数据文件以保留会话状态。</li>
<li><code>playwright codegen --load-storage=auth.json</code>：在生成代码时加载存储数据，以保持与之前会话的连续性。</li>
<li><code>playwright codegen --save-storage=auth.json http://xxx.com/</code>：用于生成代码时将存储数据保存到文件中。</li>
</ul>
</li>
<li>console页面语法<ul>
<li><code>playwright.selector(element)</code>：为给定元素生成选择器。</li>
<li><code>playwright.$$(selector)</code>：类似于<code>playwright.$</code>，但是会返回全部的匹配元素。</li>
<li><code>playwright.$(selector)</code>：使用实际的Playwright查询引擎查询Playwright选择器。</li>
<li><code>playwright.locator(selector)</code>：使用实际的Playwright查询引擎查询Playwright元素。</li>
<li><code>playwright.inspect(selector)</code>：元素面板中显示元素(需相应浏览器的DevTools支持)。</li>
</ul>
</li>
</ul>
</li>
<li>高亮定位与调试：为清楚当前定位方式在页面上找到哪些元素，可以使用highlight()高亮定位元素。</li>
</ul>
</li>
</ul>
<h2 id="7-1-异常处理"><a href="#7-1-异常处理" class="headerlink" title="7-1 异常处理"></a>7-1 异常处理</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>, slow_mo=<span class="hljs-number">1000</span>)<br>    page = browser.new_page()<br>    page.goto(<span class="hljs-string">&quot;https://www.baidu.com/&quot;</span>)<br><br>    <span class="hljs-keyword">try</span>:<br>        element = page.locator(<span class="hljs-string">&#x27;#myElement&#x27;</span>)                    <span class="hljs-comment"># 尝试查找ID为myElement的元素</span><br>        <span class="hljs-keyword">if</span> element:<br>            element.click()                                     <span class="hljs-comment"># 找到则点击</span><br>        <span class="hljs-keyword">else</span>:                                                   <span class="hljs-comment"># 否则抛出异常</span><br>            <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&quot;没找到对应元素&quot;</span>)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:                                      <span class="hljs-comment"># 抛出异常后打印异常信息</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;产生了一个错误: <span class="hljs-subst">&#123;<span class="hljs-built_in">str</span>(e)&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">finally</span>:<br>        browser.close()                                         <span class="hljs-comment"># 最后无论是否异常，都关闭浏览器</span><br></code></pre></td></tr></table></figure>



<h2 id="7-2-控制台调试定位"><a href="#7-2-控制台调试定位" class="headerlink" title="7-2 控制台调试定位"></a>7-2 控制台调试定位</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>, slow_mo=<span class="hljs-number">1000</span>)   <span class="hljs-comment"># 启动chromium浏览器</span><br>    page = browser.new_page()                                   <span class="hljs-comment"># 打开一个标签页</span><br>    page.goto(<span class="hljs-string">&quot;https://mail.163.com/&quot;</span>)<br>    <span class="hljs-built_in">print</span>(page.frames)<br><br>    iframe = page.frame_locator(<span class="hljs-string">&#x27;//iframe[contains(@id, &quot;x-URS-iframe&quot;)]&#x27;</span>)<br>    iframe.locator(<span class="hljs-string">&#x27;[name=&quot;email&quot;]&#x27;</span>).fill(<span class="hljs-string">&#x27;Tester&#x27;</span>)             <span class="hljs-comment"># xpath模糊匹配</span><br>    iframe.locator(<span class="hljs-string">&#x27;[name=&quot;password&quot;]&#x27;</span>).fill(<span class="hljs-string">&quot;123456&quot;</span>)<br>    page.pause()<br>    iframe.locator(<span class="hljs-string">&quot;#dologin&quot;</span>).click()<br>    page.wait_for_timeout(<span class="hljs-number">3000</span>)<br><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h2 id="7-3-高亮定位与调试"><a href="#7-3-高亮定位与调试" class="headerlink" title="7-3 高亮定位与调试"></a>7-3 高亮定位与调试</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>, slow_mo=<span class="hljs-number">2000</span>)<br>    context = browser.new_context()                             <span class="hljs-comment"># 创建上下文</span><br>    page = context.new_page()                                   <span class="hljs-comment"># 打开标签页</span><br><br>    page.goto(<span class="hljs-string">&#x27;https://www.baidu.com&#x27;</span>)<br>    page.get_by_text(<span class="hljs-string">&quot;新闻&quot;</span>).highlight()<br>    page.wait_for_timeout(<span class="hljs-number">20000</span>)                                <span class="hljs-comment"># 高亮定位</span><br><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



<h1 id="8-console事件监听"><a href="#8-console事件监听" class="headerlink" title="8 console事件监听"></a>8 console事件监听</h1><ul>
<li>console事件监听<ul>
<li><code>page.on(&quot;console&quot;, handler)</code>：监听特定页面的Console事件，传入处理函数handler。</li>
<li><code>cdpSession.on(&quot;Console.messageAdded&quot;, handler)</code>：监听CDP会话上的Console事件。</li>
<li>后者可在不同页面间共享同一个Chrome DevTools Protocol(CDP)会话，并监听该会话下的Console事件。</li>
<li>监听Console事件后，可执行以下操作。<ul>
<li><code>page.on(&quot;console&quot;, handler)</code>或<code>cdpSession.on(&quot;Console.messageAdded&quot;, handler)</code>添加相应的事件监听器。</li>
<li><code>page.remove_listener(&quot;event&quot;, print_request_finished)</code>可用来删除已添加的特定页面Console事件监听器。</li>
<li>目前没有删除CDP会话的特定事件监听器方法，使用创建新的CDP会话事件监听器来替代旧的，以达删除目的。</li>
</ul>
</li>
<li>若某个事件需要处理一次，可使用<code>page.once(&quot;console&quot;, handler)</code>添加一次性事件，该方法是针对page页面对象的。</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">console_msg</span>(<span class="hljs-params">msg</span>):<br>    values = []<br>    <span class="hljs-keyword">for</span> arg <span class="hljs-keyword">in</span> msg.args:<br>        <span class="hljs-built_in">print</span>(msg)<br>        values.append(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;arg.json_value()&#125;</span>&#x27;</span>)<br><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;console.log&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> fp:<br>        fp.write(<span class="hljs-string">&#x27;&#x27;</span>.join(values) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br><br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> p:<br>    browser = p.chromium.launch(headless=<span class="hljs-literal">False</span>, slow_mo=<span class="hljs-number">100</span>)<br>    context = browser.new_context()                             <span class="hljs-comment"># 创建上下文</span><br>    page = context.new_page()                                   <span class="hljs-comment"># 打开标签页</span><br>    <span class="hljs-keyword">with</span> page.expect_request(<span class="hljs-string">&quot;**/*logo*.png&quot;</span>) <span class="hljs-keyword">as</span> first:         <span class="hljs-comment"># 等待具有指定url的请求</span><br>        page.goto(<span class="hljs-string">&quot;https://www.hao123.com/&quot;</span>)<br>    <span class="hljs-built_in">print</span>(first.value.url)<br><br>    <span class="hljs-keyword">with</span> page.expect_popup() <span class="hljs-keyword">as</span> popup:                          <span class="hljs-comment"># 等待弹出窗口</span><br>        page.locator(<span class="hljs-string">&#x27;//*[@id=&quot;footer&quot;]/div/div[1]/a[3]&#x27;</span>).click()<br>        page.wait_for_timeout(<span class="hljs-number">1000</span>)                             <span class="hljs-comment"># 弹出全站地图窗口页</span><br>    popup.value.goto(<span class="hljs-string">&quot;https://www.hao123.com/&quot;</span>)                 <span class="hljs-comment"># 窗口页打开hao123页面</span><br>    page.wait_for_timeout(<span class="hljs-number">1000</span>)                                 <span class="hljs-comment"># 在指定的时间间隔后继续执行后续代码</span><br><br>    page.on(<span class="hljs-string">&quot;console&quot;</span>, console_msg)                             <span class="hljs-comment"># 监听console内容</span><br>    page.goto(<span class="hljs-string">&quot;https://www.baidu.com/&quot;</span>)<br>    page.wait_for_load_state(<span class="hljs-string">&quot;networkidle&quot;</span>)                     <span class="hljs-comment"># 等待页面在网络空闲状态时停止加载</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">print_request_sent</span>(<span class="hljs-params">request</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Request sent: &quot;</span> + request.url)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">print_request_finished</span>(<span class="hljs-params">request</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Request finished: &quot;</span> + request.url)<br><br>    page.on(<span class="hljs-string">&quot;request&quot;</span>, print_request_sent)<br>    page.on(<span class="hljs-string">&quot;requestfinished&quot;</span>, print_request_finished)<br>    page.goto(<span class="hljs-string">&quot;https://www.sogou.com/&quot;</span>)<br>    page.wait_for_timeout(<span class="hljs-number">1000</span>)<br><br>    page.remove_listener(<span class="hljs-string">&quot;requestfinished&quot;</span>, print_request_finished)<br>    page.goto(<span class="hljs-string">&quot;https://www.sogou.com/&quot;</span>)<br>    page.wait_for_timeout(<span class="hljs-number">1000</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">handle_dialog</span>(<span class="hljs-params">dialog</span>):<br>        dialog.accept(<span class="hljs-string">&quot;2021&quot;</span>)<br>    page.goto(<span class="hljs-string">&quot;https://www.runoob.com/try/try.php?filename=ionic_ionicpopup&quot;</span>)<br>    iframe = page.frame_locator(<span class="hljs-string">&#x27;//*[@id=&quot;iframeResult&quot;]&#x27;</span>)<br>    iframe.get_by_role(<span class="hljs-string">&quot;button&quot;</span>, name=<span class="hljs-string">&quot;弹窗显示&quot;</span>).click()<br>    <span class="hljs-comment"># page.once(&quot;dialog&quot;, lambda dialog: dialog.accept(&quot;2021&quot;))</span><br>    page.once(<span class="hljs-string">&quot;dialog&quot;</span>, handle_dialog)                          <span class="hljs-comment"># 注册对话框处理程序</span><br>    page.evaluate(<span class="hljs-string">&quot;prompt(&#x27;Enter a number:&#x27;)&quot;</span>)                  <span class="hljs-comment"># 触发提示框</span><br>    page.wait_for_timeout(<span class="hljs-number">3000</span>)<br><br>    browser.close()                                             <span class="hljs-comment"># 关闭浏览器对象</span><br></code></pre></td></tr></table></figure>



              
            </div>
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6/" class="category-chain-item">测试框架</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Python/">#Python</a>
      
        <a href="/tags/PlayWright/">#PlayWright</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>PlayWright 框架(一)</div>
      <div>https://stitch-top.github.io/2023/09/09/ce-shi-kuang-jia/tf06-playwright-kuang-jia-yi/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Dr.626</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2023年9月9日 22:22:50</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>许可协议</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - 署名">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
              <a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
              <span class="hint--top hint--rounded" aria-label="NC - 非商业性使用">
                <i class="iconfont icon-nc"></i>
              </span>
              </a>
            
              <a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
              <span class="hint--top hint--rounded" aria-label="SA - 相同方式共享">
                <i class="iconfont icon-sa"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/11/02/ce-shi-kuang-jia/tf07-playwright-kuang-jia-er/" title="PlayWright 框架(二)">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">PlayWright 框架(二)</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/07/23/ce-shi-kuang-jia/tf04-unittest-ce-shi-kuang-jia/" title="UnitTest 测试框架">
                        <span class="hidden-mobile">UnitTest 测试框架</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  <article id="comments">
    
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://cdn.staticfile.org/valine/1.5.1/Valine.min.js', function() {
        var options = Object.assign(
          {"appId":"bsRkWxXK7zLX6NWYygwknNXv-gzGzoHsz","appKey":"qqiNDCxGTOGVmiM1xAbd5pzk","path":"window.location.pathname","placeholder":"赠人玫瑰，手留余香(～o￣3￣)～","avatar":"retro","meta":["nick","mail","link"],"requiredFields":[],"pageSize":10,"lang":"zh-CN","highlight":"ture","recordIP":"ture","serverURLs":"","emojiCDN":null,"emojiMaps":null,"enableQQ":"ture"},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          var imgSelector = '#valine .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


  </article>


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar category-bar" style="margin-left: -1rem">
    





<div class="category-list">
  
  
    
    
    
    <div class="category row nomargin-x">
      <a class="category-item 
          list-group-item category-item-action col-10 col-md-11 col-xm-11" title="测试框架"
        id="heading-893b664e5ce5fe8882ce6ce630f2f650" role="tab" data-toggle="collapse" href="#collapse-893b664e5ce5fe8882ce6ce630f2f650"
        aria-expanded="true"
      >
        测试框架
        <span class="list-group-count">(7)</span>
        <i class="iconfont icon-arrowright"></i>
      </a>
      
      <div class="category-collapse collapse show" id="collapse-893b664e5ce5fe8882ce6ce630f2f650"
           role="tabpanel" aria-labelledby="heading-893b664e5ce5fe8882ce6ce630f2f650">
        
        
          
  <div class="category-post-list">
    
    
      
      
        <a href="/2023/01/08/ce-shi-kuang-jia/tf01-selenium/" title="Selenium"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Selenium</span>
        </a>
      
    
      
      
        <a href="/2023/03/03/ce-shi-kuang-jia/tf02-pytest-ce-shi-kuang-jia/" title="Pytest 测试框架"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Pytest 测试框架</span>
        </a>
      
    
      
      
        <a href="/2023/05/01/ce-shi-kuang-jia/tf03-allure-ce-shi-bao-gao/" title="Allure 测试报告"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Allure 测试报告</span>
        </a>
      
    
      
      
        <a href="/2023/07/23/ce-shi-kuang-jia/tf04-unittest-ce-shi-kuang-jia/" title="UnitTest 测试框架"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">UnitTest 测试框架</span>
        </a>
      
    
      
      
        <a href="/2024/03/02/ce-shi-kuang-jia/tf05-unittest-zi-bao-mock/" title="UnitTest 子包 Mock"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">UnitTest 子包 Mock</span>
        </a>
      
    
      
      
        <a href="/2023/09/09/ce-shi-kuang-jia/tf06-playwright-kuang-jia-yi/" title="PlayWright 框架(一)"
           class="list-group-item list-group-item-action
           active">
          <span class="category-post">PlayWright 框架(一)</span>
        </a>
      
    
      
      
        <a href="/2023/11/02/ce-shi-kuang-jia/tf07-playwright-kuang-jia-er/" title="PlayWright 框架(二)"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">PlayWright 框架(二)</span>
        </a>
      
    
  </div>

        
      </div>
    </div>
  
</div>


  </aside>


    </div>
  </div>
</div>





  



  



  



  



  






    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a><span>Copyright © 2021 - 2024</span></a> <i class="iconfont icon-love"></i> <a href="https://stitch-top.github.io" target="_blank" rel="nofollow noopener"><span>Dr.626</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    
  
</div>

  
  
  
  
  <!-- 添加网站运行时间 -->
  <div class="footer-content">
    <div>
      <span id="timeDate">载入天数...</span>
      <span id="times">载入时分秒...</span>
      <script>
      var now = new Date();
      function createtime(){
          var grt= new Date("01/01/2021 00:00:00");   //此处修改你的建站时间或者网站上线时间
          now.setTime(now.getTime()+250);
          days = (now - grt ) / 1000 / 60 / 60 / 24;
          dnum = Math.floor(days);
          hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum);
          hnum = Math.floor(hours);
          if(String(hnum).length ==1 ){
              hnum = "0" + hnum;
          }
          minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
          mnum = Math.floor(minutes);
          if(String(mnum).length ==1 ){
                    mnum = "0" + mnum;
          }
          seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
          snum = Math.round(seconds);
          if(String(snum).length ==1 ){
                    snum = "0" + snum;
          }
          document.getElementById("timeDate").innerHTML = "本站已安全运行&nbsp"+dnum+"&nbsp天";
          document.getElementById("times").innerHTML = hnum + "&nbsp小时&nbsp" + mnum + "&nbsp分&nbsp" + snum + "&nbsp秒";
      }
      setInterval("createtime()", 250);
      </script>
    </div>
  </div>
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://cdn.staticfile.org/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.staticfile.org/jquery/3.7.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  

  

  

  

  

  

  




  
    
      <script  src="/js/img-lazyload.js" ></script>
    
  




  
<script>
  Fluid.utils.createScript('https://cdn.staticfile.org/tocbot/4.21.0/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script>
  (function() {
    var enableLang = CONFIG.code_language.enable && CONFIG.code_language.default;
    var enableCopy = CONFIG.copy_btn;
    if (!enableLang && !enableCopy) {
      return;
    }

    function getBgClass(ele) {
      return Fluid.utils.getBackgroundLightness(ele) >= 0 ? 'code-widget-light' : 'code-widget-dark';
    }

    var copyTmpl = '';
    copyTmpl += '<div class="code-widget">';
    copyTmpl += 'LANG';
    copyTmpl += '</div>';
    jQuery('.markdown-body pre').each(function() {
      var $pre = jQuery(this);
      if ($pre.find('code.mermaid').length > 0) {
        return;
      }
      if ($pre.find('span.line').length > 0) {
        return;
      }

      var lang = '';

      if (enableLang) {
        lang = CONFIG.code_language.default;
        if ($pre[0].children.length > 0 && $pre[0].children[0].classList.length >= 2 && $pre.children().hasClass('hljs')) {
          lang = $pre[0].children[0].classList[1];
        } else if ($pre[0].getAttribute('data-language')) {
          lang = $pre[0].getAttribute('data-language');
        } else if ($pre.parent().hasClass('sourceCode') && $pre[0].children.length > 0 && $pre[0].children[0].classList.length >= 2) {
          lang = $pre[0].children[0].classList[1];
          $pre.parent().addClass('code-wrapper');
        } else if ($pre.parent().hasClass('markdown-body') && $pre[0].classList.length === 0) {
          $pre.wrap('<div class="code-wrapper"></div>');
        }
        lang = lang.toUpperCase().replace('NONE', CONFIG.code_language.default);
      }
      $pre.append(copyTmpl.replace('LANG', lang).replace('code-widget">',
        getBgClass($pre[0]) + (enableCopy ? ' code-widget copy-btn" data-clipboard-snippet><i class="iconfont icon-copy"></i>' : ' code-widget">')));

      if (enableCopy) {
        Fluid.utils.createScript('https://cdn.staticfile.org/clipboard.js/2.0.11/clipboard.min.js', function() {
          var clipboard = new window.ClipboardJS('.copy-btn', {
            target: function(trigger) {
              var nodes = trigger.parentNode.childNodes;
              for (var i = 0; i < nodes.length; i++) {
                if (nodes[i].tagName === 'CODE') {
                  return nodes[i];
                }
              }
            }
          });
          clipboard.on('success', function(e) {
            e.clearSelection();
            e.trigger.innerHTML = e.trigger.innerHTML.replace('icon-copy', 'icon-success');
            setTimeout(function() {
              e.trigger.innerHTML = e.trigger.innerHTML.replace('icon-success', 'icon-copy');
            }, 2000);
          });
        });
      }
    });
  })();
</script>


  
<script>
  Fluid.utils.createScript('https://cdn.staticfile.org/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://cdn.staticfile.org/busuanzi/2.3.0/busuanzi.pure.mini.js" ></script>




  
<script src="/js/snow.js"></script>



<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/assets/tororo.model.json"},"display":{"position":"right","width":180,"height":230},"mobile":{"show":false,"scale":0.3},"rect":{"opacityDefault":0.7,"opacityHover":1},"log":false});</script></body>
</html>
